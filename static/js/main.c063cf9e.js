(()=>{"use strict";var e={906:(e,t,s)=>{var n=s(1250),a=s(6030),r=s(2902),i=s(3713),o=s(2791),l=s(1087),c=s(8682),d=s(6955),u=s(2940),h=s(7689),p=s(2076),m=s(4292),x=s(7022),g=s(9546),f=s(4792),v=s(184);const j=()=>{const[e,t]=(0,o.useState)("\u042f\u043d\u0434\u0435\u043a\u0441"),[s,n]=(0,o.useState)(""),a=(0,o.useCallback)((e=>{n(e.target.value)}),[]),r=(0,f.$0)((e=>{"Enter"===e.key&&i()})),i=(0,f.$0)((()=>{let t;switch(e){case"\u042f\u043d\u0434\u0435\u043a\u0441":t="https://www.yandex.ru/search/?text=".concat(s,"&site=forum.mista.ru");break;case"Google":t="https://www.google.ru/search?q=".concat(s,"+site:forum.mista.ru")}window.open(t),n("")}));return(0,v.jsxs)(p.Z,{size:"sm",children:[(0,v.jsxs)(g.Z,{id:"search-engine",title:"",size:"sm",variant:"light",onSelect:t,children:[(0,v.jsx)(x.Z.Item,{eventKey:"\u042f\u043d\u0434\u0435\u043a\u0441",children:"\u042f\u043d\u0434\u0435\u043a\u0441"}),(0,v.jsx)(x.Z.Item,{eventKey:"Google",children:"Google"})]}),(0,v.jsx)(m.Z,{type:"text",placeholder:"".concat(e,": \u043f\u043e\u0438\u0441\u043a"),className:"search-input input",onKeyDown:r,onChange:a,value:s}),(0,v.jsx)(p.Z.Text,{className:"search-button",onClick:i,children:(0,v.jsx)("i",{className:"fa fa-search input",style:{zIndex:1e3}})})]})};var y=s(8463),b=s(6490),N=s.n(b),w=s(7892),I=s.n(w);const k=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!e)return t;if("number"===typeof e)return e;const s=parseInt(e,10);return isNaN(s)?t:s},C=(e,t)=>e.reduce(((e,s)=>{const n=t(s);return e[n]||(e[n]=[]),e[n].push(s),e}),{}),S=e=>-1===e||void 0===e?-1:Math.min(Math.ceil(e/100),10)||1,T=e=>e?e.map((e=>"string"===typeof e?e:"br"===e.type?"<br>":"Connect(LinkToPost)"===e.type.displayName||"Connect(t)"===e.type.displayName?e.props.number:(console.log(e),e))):[""];const _=e=>{return 2147483648e3===e?"":(t=e,I()(t).isSame(new Date,"day")?I()(e).format("HH:mm"):I()(e).format("DD.MM.YY"));var t},Z=(e,t)=>{if(!t)return"";let s=new URLSearchParams;for(let a in t){const e=t[a];void 0!==e&&s.append(a,e)}let n=s.toString();return n.length>0?e+n:""},L=async(e,t,s)=>{let n="".concat(A,"/").concat(e).concat(Z("?",t));const a=await N()(n);let r,i=await a.json();if("string"===typeof i)try{r=JSON.parse(i)}catch(o){r=(e=>{try{return JSON.parse(e)}catch(o){}try{return e=e.replace(/\\</g,"<").replace(/\\>/g,">").replace(/\\&/g,"&").replace(/\\'/g,"'").replace(/\\"/g,"").replace(/ "/g,' \\"').replace(/""/g,'\\""').replace(/\t/g,"\\t").replace(/"(\.| |\?)/g,'\\"$1'),JSON.parse(e)}catch(o){return console.error(o.message),console.log(e),{}}})(i)}else r=i;return r},M=async(e,t,s)=>{let n="".concat(A,"/").concat(e).concat(Z("?",t));s||(s={mode:"cors",credentials:"same-origin"});const a=await fetch(n,s);return await a.json()};async function P(){return function(e){const{session:t}=e;return{userId:Number(null===t||void 0===t?void 0:t.user_id),userName:null===t||void 0===t?void 0:t.user_name,userHash:null===t||void 0===t?void 0:t.user_hash,lastError:null===t||void 0===t?void 0:t.last_error}}(await L(K))}function O(e){return{id:e.id,forum:e.forum,code:e.shortn,name:e.fulln}}const D=async()=>{const e=(await L(J)).map(O);return{items:e,tree:C(e,(e=>e.forum))}};async function F(e){return function(e){let t=[];return e.voting&&(t=e.voting.map((e=>({text:e.select,count:e.result})))),{id:parseInt(e.id),title:e.text,forum:e.forum,sectionId:e.section,created:1e3*parseInt(e.created),authorId:e.user_id,author:e.user_name,updated:1e3*parseInt(e.updated),lastUser:e.updated_name,count:parseInt(e.answers_count),down:e.down,closed:e.closed,deleted:e.deleted,isVoting:e.is_voting,voting:t}}(await M(Y,{id:e}))}function R(e){return{id:parseInt(e.id),n:parseInt(e.n),user:e.user,userId:parseInt(e.userId),text:e.text,time:1e3*parseInt(e.utime),vote:e.vote}}async function E(e){return(await M(H,e)).map(R)}async function z(e,t){const s=0===t?t+1:t;return(await M(H,{id:e,from:t,to:s})).map(R).find((e=>e.n===t))}function V(e){return{id:e.id,forum:e.forum,section:e.sect1,sectionCode:e.sect2,author:e.user0,lastUser:e.user,created:1e3*e.created,updated:1e3*e.utime,count:e.answ,text:e.text,closed:1===e.closed,down:1===e.down,pinned:2147483648===e.utime,isVoting:1===e.is_voting}}async function U(e){const t=function(e){const t=k(e.page,1),s=k(e.itemsPerPage,20)*t;return{topics:String(s),section_short_name:e.section,forum:e.forum,user_id:e.userId,mytopics:e.myTopics}}(e),s=k(null===e||void 0===e?void 0:e.itemsPerPage,20);return(await M(W,t)).map(V).slice(-s)}const A=localStorage.getItem("domain")||"https://dev.mista.ru",W=localStorage.getItem("urlTopicsList")||"api/topic.php",Y=localStorage.getItem("urlTopicInfo")||"ajax_gettopic.php",H=localStorage.getItem("urlTopicMessages")||"api/message.php",B=localStorage.getItem("urlLogin")||"users.php?action=do_enter",q=localStorage.getItem("urlLogout")||"users.php?action=exit",K=localStorage.getItem("urlCookies")||"ajax_cookie.php",J=localStorage.getItem("urlSections")||"ajax_getsectionslist.php",X=localStorage.getItem("urlNewMessage")||"topic.php?id=:id&page=1",$=localStorage.getItem("urlNewTopic")||"index.php",G=(localStorage.getItem("urlAddBookmark"),localStorage.getItem("urlSearch"),()=>(0,y.a)({queryKey:["sections"],queryFn:D,placeholderData:{items:[],tree:{}},refetchOnWindowFocus:!1}));var Q=s(3063);let ee=function(e){return e.Sections="sections",e.TopicsList="topics-list",e.TopicMessages="topic-messages",e.TopicMessageData="topic-message-data",e.UpdateTopicMessages="update-topic-messages",e}({});var te=s(7781);const se=()=>(0,a.I0)(),ne=a.v9,ae=e=>{const t=se();return(0,o.useMemo)((()=>(0,te.DE)(e,t)),[e,t])},re=(e,t)=>{let{searchParams:s}=e;const n=ne((e=>e.options.items.topicsPerPage));return(0,y.a)((0,Q.Z)({queryKey:[ee.TopicsList,...s],queryFn:()=>{const e=Object.fromEntries(s);return U((0,Q.Z)({itemsPerPage:n},e))},placeholderData:e=>e,refetchOnWindowFocus:!1},t))};var ie=s(6382);const oe=(0,ie.hg)("login/check",(async()=>await P())),le=(0,ie.hg)("login/login",(async(e,t)=>{let{dispatch:s}=t;return await(async e=>{await fetch("".concat(A,"/").concat(B),{method:"POST",body:Z("",{user_name:e.username,user_password:e.password}),mode:"no-cors",credentials:"include",headers:{Accept:"text/html,application/xhtml+xml,application/xml","Content-Type":"application/x-www-form-urlencoded"},redirect:"follow"})})(e),P()})),ce=(0,ie.hg)("login/logout",(async()=>await(async()=>{const e="".concat(A,"/").concat(q);await fetch(e,{mode:"no-cors",credentials:"include"})})())),de=e=>{let{login:t}=e;return!t||"loading"!==t.status},ue=(0,ie.oM)({name:"login",initialState:{status:"init",logged:!1},reducers:{},extraReducers:e=>{e.addCase(le.pending,(e=>{e.status="loading",delete e.error})).addCase(le.fulfilled,((e,t)=>{let{payload:s}=t;e.status="success",e.userId=s.userId,e.userName=s.userName,e.userHash=s.userHash,e.logged=!0,delete e.error})).addCase(le.rejected,((e,t)=>{let{error:s}=t;e.status="error",e.error=null===s||void 0===s?void 0:s.message})).addCase(ce.pending,(e=>{e.status="loading",delete e.error})).addCase(ce.fulfilled,(e=>{e.status="success",e.logged=!1,delete e.userId,delete e.userName,delete e.userHash,delete e.error})).addCase(ce.rejected,((e,t)=>{let{error:s}=t;e.status="error",e.error=null===s||void 0===s?void 0:s.message}))}}),{actions:he,reducer:pe}=ue,me=(0,ie.hg)("newTopic/post",(async e=>{let t={message_text:e.text,topic_text:e.subject,target_section:String(e.section),target_forum:e.forum.toLowerCase(),action:"new",rnd:Math.round(1e10*Math.random()),voting:e.isVoting?1:0};if(e.votingItems)for(let s=0;s<e.votingItems.length;s++)t["section".concat(s+1)]=e.votingItems[s];await(async e=>{await fetch("".concat(A,"/").concat($),{method:"POST",body:Z("",e),mode:"no-cors",credentials:"include",headers:{"Content-Type":"application/x-www-form-urlencoded"}})})(t)})),xe=e=>{e.status="init",e.text="",e.subject="",e.forum="",e.isVoting=!1},ge=(0,ie.oM)({name:"newTopic",initialState:{status:"init",section:null,text:"",subject:"",forum:"1C",isVoting:!1},reducers:{clear:xe,changeSubject:(e,t)=>{let{payload:s}=t;e.subject=s},changeText:(e,t)=>{let{payload:s}=t;e.text=s},changeSection:(e,t)=>{let{payload:s}=t;e.section=s,e.forum=null===s||void 0===s?void 0:s.forum.toLowerCase()},showVoting:(e,t)=>{let{payload:s}=t;e.isVoting=s},setError:(e,t)=>{let{payload:s}=t;e.error=s}},extraReducers:e=>{e.addCase(me.pending,(e=>{e.status="loading",delete e.error})).addCase(me.fulfilled,(e=>{xe(e),delete e.error})).addCase(me.rejected,((e,t)=>{let{error:s}=t;e.status="error",e.error=null===s||void 0===s?void 0:s.message}))}}),{actions:fe,reducer:ve}=ge,je={voteColors:["#FF1616","#1A861A","#0023FF","#FF6B18","#9B3A6E","#567655","#233345","#CC0000","#00CCCC","#0000CC"],items:{theme:"lightgray",topicsPerPage:"20",autoRefreshTopicsList:"false",autoRefreshTopicsListInterval:"60",autoRefreshTopic:"true",autoRefreshTopicInterval:"60",showTooltips:"true",tooltipDelay:"500",showTooltipOnPostLink:"true",showYoutubeVideoTitle:"true",replaceCatalogMista:"true",fixBrokenLinks:"true"}},ye=(0,ie.oM)({name:"options",initialState:je,reducers:{save:(e,t)=>{let{payload:s}=t;for(let n in s){const t=String(s[n]);e.items[n]=t}}}}),{actions:be,reducer:Ne}=ye,we=(0,ie.oM)({name:"tooltips",initialState:{items:[]},reducers:{show:(e,t)=>{let{payload:s}=t;const n=JSON.stringify(s.keys),a=e.items.findIndex((e=>e.hash===n));let r=0;e.items.length&&(r=e.items[e.items.length-1].zIndex+1),-1===a?e.items.push({keys:s.keys,coords:s.coords,hash:n,zIndex:r}):e.items[e.items.length-1].zIndex=r},close:(e,t)=>{let{payload:s}=t;const n=JSON.stringify(s);e.items=e.items.filter((e=>e.hash!==n))},closeAll:e=>{e.items=[]}}}),{actions:Ie,reducer:ke}=we,Ce=async e=>{let t,{topicId:s,page:n,item0:a}=e;try{t=await F(s)}catch(c){console.error(c),t={id:s,title:"",count:-1}}let[r,i]=((e,t)=>{if("last20"===t)return-1===e?[0,1010]:[Math.max(0,e-19),e];const s=k(t,1)-1;return[100*s,100*s+99]})(t.count,n);0===r&&a&&(r=1);let o=await E({id:s,from:r,to:i}),l=a;return l=0===r?o.shift():await z(s,0),0===t.count&&o.length>0&&(t.count=o[o.length-1].n),"last20"===n&&o.length>20&&(o=o.slice(-20)),{info:t,item0:l,list:o}},Se=(0,ie.hg)("newMessage/post",(async e=>{let t={message_text:e.text,action:"new",topic_id:e.topicId,rnd:Math.round(1e10*Math.random())};e.voting_select&&(t.voting_select=e.voting_select),await(async e=>{const t=X.replace(":id",e.topic_id),s={method:"POST",body:Z("",e),mode:"no-cors",credentials:"include",headers:{Accept:"text/html,application/xhtml+xml,application/xml","Content-Type":"application/x-www-form-urlencoded"},redirect:"follow"};return await fetch("".concat(A,"/").concat(t),s)})(t)})),Te=(0,ie.oM)({name:"newMessage",initialState:{status:"init",text:""},reducers:{changeText:(e,t)=>{let{payload:s}=t;e.text=s}},extraReducers:e=>{e.addCase(Se.pending,(e=>{e.status="loading",delete e.error})).addCase(Se.fulfilled,(e=>{e.text="",delete e.error})).addCase(Se.rejected,((e,t)=>{let{error:s}=t;e.status="error",e.error=null===s||void 0===s?void 0:s.message}))}}),{actions:_e,reducer:Ze}=Te,Le=(e,t)=>{let{topicId:s}=e;const[n]=(0,l.lr)(),a=n.get("page"),r=(0,i.NL)();return(0,y.a)((0,Q.Z)({queryKey:[ee.TopicMessages,s,a],queryFn:()=>{const e=Pe(r,s);return Ce({topicId:s,page:a,item0:null===e||void 0===e?void 0:e.item0})},placeholderData:e=>e,refetchOnWindowFocus:!1},t))},Me=(e,t)=>{let{topicId:s}=e;const[n]=(0,l.lr)(),a=n.get("page"),r=(0,i.NL)();return(0,y.a)((0,Q.Z)({queryKey:[ee.UpdateTopicMessages,s],queryFn:async()=>{const e=Pe(r,s);if(!e)return!0;const t=await E({id:s,from:e.info.count+1,to:1050});return 0===t.length||r.setQueryData([ee.TopicMessages,s,a],(e=>({info:(0,Q.Z)((0,Q.Z)({},e.info),{},{count:t.at(-1).n}),item0:e.item0,list:[...e.list,...t]}))),!0},initialData:!0,refetchOnMount:!1},t))},Pe=(e,t)=>{const s=e.getQueriesData({queryKey:[ee.TopicMessages,t]});if(0!==s.length)return s[0][1]},Oe=()=>{const e=(0,h.TH)(),[t]=(0,l.lr)(),s=t.get("forum"),{refetch:n}=re({searchParams:t},{enabled:!1});return(0,v.jsxs)(c.Z,{bg:"dark",variant:"dark",expand:"md",fixed:"top",children:[(0,v.jsx)(c.Z.Brand,{as:l.rU,to:"/",onClick:s=>{"/"===e.pathname&&0===t.size&&(s.preventDefault(),n())},children:"React.Mista"}),(0,v.jsx)(c.Z.Toggle,{"aria-controls":"basic-navbar-nav"}),(0,v.jsxs)(c.Z.Collapse,{children:[(0,v.jsxs)(d.Z,{className:"me-auto",children:[[{name:"1C",link:"/index.php?forum=1C"},{name:"IT",link:"/index.php?forum=IT"},{name:"JOB",link:"/index.php?forum=JOB"},{name:"LIFE",link:"/index.php?forum=LIFE"},{name:"\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438",link:"/options.php"}].map(((e,t)=>(0,v.jsx)(d.Z.Item,{children:(0,v.jsx)(d.Z.Link,{to:e.link,active:e.name===s,as:l.rU,children:e.name})},"i"+t))),[{name:"Wiki",link:"https://wiki.mista.ru"},{name:"\u041a\u043d\u0438\u0433\u0430 \u0437\u043d\u0430\u043d\u0438\u0439",link:"https://kb.mista.ru"}].map(((e,t)=>(0,v.jsx)(d.Z.Item,{children:(0,v.jsx)(d.Z.Link,{href:e.link,children:e.name})},"e"+t)))]}),(0,v.jsx)(u.Z,{className:"d-flex",children:(0,v.jsx)(j,{})})]})]})};var De=s(7262),Fe=s(2540);const Re={key:"options",storage:s(5752).Z},Ee=(0,te.UY)({options:(0,Fe.OJ)(Re,Ne),login:pe,tooltips:ke,newTopic:ve,newMessage:Ze}),ze=(0,ie.xC)({reducer:Ee,middleware:e=>e({serializableCheck:{ignoredActions:[Fe._P,Fe.I2,Fe.E7,Fe.ex,Fe.e,Fe.Nz]}}),devTools:!1}),Ve=(0,Fe.p5)(ze),Ue=o.forwardRef(((e,t)=>{let{children:s,onClick:n}=e;return(0,v.jsx)("span",{ref:t,style:{cursor:"pointer"},className:"link",onClick:e=>{e.preventDefault(),n(e)},children:s})})),Ae=e=>{let{userId:t,userName:s}=e;const n=ae(he);return(0,v.jsx)("div",{style:{float:"left"},children:(0,v.jsxs)(x.Z,{id:"dropdown-custom-menu",onSelect:(e,t)=>{"exit"===e&&(e=>{e.preventDefault(),n.doLogout()})(t)},children:[(0,v.jsx)("span",{children:"\u041f\u0440\u0438\u0432\u0435\u0442, "}),(0,v.jsxs)(x.Z.Toggle,{as:Ue,children:[s," \u25bc"]}),(0,v.jsxs)(x.Z.Menu,{children:[(0,v.jsx)(x.Z.Item,{eventKey:"profile",href:"".concat(A,"/users.php?id=").concat(t),children:"\u041f\u0440\u043e\u0444\u0438\u043b\u044c"}),(0,v.jsx)(x.Z.Item,{eventKey:"myTopics",href:"#/index.php?user_id=".concat(t),children:"\u041c\u043e\u0438 \u0442\u0435\u043c\u044b"}),(0,v.jsx)(x.Z.Divider,{}),(0,v.jsx)(x.Z.Item,{eventKey:"options",href:"#/options.php",children:"\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438"}),(0,v.jsx)(x.Z.Divider,{}),(0,v.jsx)(x.Z.Item,{eventKey:"exit",children:"\u0412\u044b\u0445\u043e\u0434"})]})]})})};var We=s(3360);const Ye=()=>{const e=se(),[t,s]=(0,o.useState)(""),[n,a]=(0,o.useState)("");return(0,v.jsxs)("div",{children:[(0,v.jsxs)("form",{name:"enterform",className:"flex-row",style:{flexWrap:"wrap"},children:[(0,v.jsx)(m.Z,{id:"username",type:"text",placeholder:"\u0418\u043c\u044f",value:t,onChange:e=>s(e.target.value),size:"sm",className:"input",style:{marginRight:"5px",flex:"0 1 300px"}}),(0,v.jsx)(m.Z,{id:"password",type:"password",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",maxLength:20,autoComplete:"off",value:n,onChange:e=>a(e.target.value),size:"sm",className:"input",style:{marginRight:"5px",flex:"0 1 300px"}}),(0,v.jsx)(We.Z,{size:"sm",variant:"light",className:"button",onClick:s=>{s.preventDefault(),e(((e,t)=>(s,n)=>{if(de(n()))return s(le({username:e,password:t}))})(t,n))},children:"\u0412\u043e\u0439\u0442\u0438"})]}),(0,v.jsxs)("p",{style:{margin:"0px"},children:["\u0412\u043e\u0439\u0442\u0438 \u043c\u043e\u0436\u043d\u043e \u043d\u0430 \u0441\u0430\u0439\u0442\u0435"," ",(0,v.jsx)("a",{href:"https://forum.mista.ru/",children:"forum.mista.ru"})]}),(0,v.jsx)("a",{rel:"nofollow",href:"https://forum.mista.ru/user_registration.php",children:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"}),(0,v.jsx)("span",{style:{margin:"5px"},children:"|"}),(0,v.jsx)("a",{rel:"nofollow",href:"https://forum.mista.ru/remember_password.php",children:"\u0417\u0430\u0431\u044b\u043b\u0438 \u043f\u0430\u0440\u043e\u043b\u044c?"})]})},He=e=>{let{text:t}=e;return t?(0,v.jsx)("div",{className:"error",dangerouslySetInnerHTML:{__html:t}}):null},Be=()=>{const e=se(),t=ne((e=>e.login.logged)),s=ne((e=>e.login.userId)),n=ne((e=>e.login.userName)),a=ne((e=>e.login.error));let r;return(0,o.useEffect)((()=>{e(((e,t)=>{if(de(t()))return e(oe())}))}),[e]),r=!0===t?(0,v.jsx)(Ae,{userId:s,userName:n}):!1===t?(0,v.jsx)(Ye,{}):null,(0,v.jsxs)(v.Fragment,{children:[r,a&&(0,v.jsx)(He,{text:a})]})},qe=e=>{let{id:t,defaultValue:s,selected:n,style:a,size:r,onChange:i}=e;const{data:o}=G();return(0,v.jsxs)(u.Z.Select,{"aria-label":"\u0421\u0435\u043a\u0446\u0438\u044f",onChange:e=>{if(!i)return;const t=e.currentTarget.value,s=o.items.find((e=>e.code===t));i(e,s)},value:n,style:a,className:"input",size:r,id:t,children:[(0,v.jsx)("option",{value:"",children:s}),Object.keys(o.tree).map((e=>(0,v.jsx)("optgroup",{label:e,children:o.tree[e].map((e=>(0,v.jsx)("option",{value:e.code,children:e.name},e.id)))},e)))]})},Ke=()=>{var e;const[t,s]=(0,l.lr)();return(0,v.jsxs)("div",{className:"flex-row",children:[(0,v.jsx)("div",{className:"header-left",children:(0,v.jsx)(Be,{})}),(0,v.jsx)("div",{className:"header-right",children:(0,v.jsx)(qe,{id:"sect",defaultValue:"--\u0412\u0441\u0435 \u0441\u0435\u043a\u0446\u0438\u0438--",selected:null!==(e=t.get("section"))&&void 0!==e?e:"",onChange:(e,t)=>{s((e=>{const s=new URLSearchParams(e);return t?s.set("section",t.code):s.delete("section"),s}))},size:"sm"})})]})},Je=e=>{let{isLoading:t,onUpdateClick:s}=e;return(0,v.jsxs)("div",{className:"table-header",children:[(0,v.jsx)("div",{style:{letterSpacing:"-1px"},children:"\u0420\u0430\u0437\u0434\u0435\u043b"}),(0,v.jsx)("div",{}),(0,v.jsx)("div",{children:"\u0422\u0435\u043c\u0430"}),(0,v.jsx)("div",{children:"Re"}),(0,v.jsx)("div",{children:"\u0410\u0432\u0442\u043e\u0440"}),(0,v.jsx)("div",{children:(0,v.jsx)("span",{style:{cursor:"pointer"},title:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a",onClick:s,children:t?"\u041e\u0431\u043d\u043e\u0432\u043b\u044f\u0435\u0442\u0441\u044f":"\u041e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u043e"})})]})},Xe=e=>{let{item:t}=e;return(0,v.jsx)("div",{className:"cell-author",children:(0,v.jsxs)("div",{className:"cell-author--inner",children:[(0,v.jsx)("i",{"aria-hidden":"true",className:"fa fa-user-circle",style:{marginRight:"3px"}}),t.author]})})},$e=e=>{let{item:t,onClick:s}=e;return(0,v.jsx)("div",{className:"cell-answ",onClick:s,children:(0,v.jsxs)("div",{className:"cell-answ--inner",children:[(0,v.jsx)("i",{className:"fa fa-comments-o","aria-hidden":"true",style:{marginRight:"3px"}}),(0,v.jsx)("span",{children:t.count})]})})},Ge=e=>{let{item:t}=e;return(0,v.jsx)("div",{className:"cell-forum",children:(0,v.jsx)("div",{className:"cell-forum--inner",children:t.forum})})},Qe=e=>{let{item:t}=e;return(0,v.jsx)("div",{className:"cell-last20",children:(0,v.jsx)(l.rU,{to:"/topic.php?id=".concat(t.id,"&page=last20#F"),style:{color:"inherit",display:"block",width:"100%",textAlign:"center"},children:(0,v.jsx)("i",{className:"fa fa-angle-right","aria-hidden":"true"})})})},et=e=>{let{item:t}=e;const[s,n]=(0,o.useState)(t.updated);return(0,o.useEffect)((()=>{if(!t.pinned)return;(async()=>{const e=await z(t.id,t.count);n(e.time)})()}),[t.pinned,t.id,t.count]),(0,o.useEffect)((()=>{n(t.updated)}),[t.updated]),(0,v.jsx)("div",{className:"cell-lastuser",children:(0,v.jsxs)("div",{className:"cell-author--inner",children:[(0,v.jsx)("span",{className:"cell-lastuser-time",children:_(s)}),(0,v.jsx)("span",{className:"cell-lastuser-user",children:t.lastUser})]})})},tt=e=>{let{expanded:t,onClick:s}=e;return(0,v.jsx)("div",{className:"cell-preview-link",onClick:s,children:(0,v.jsx)("span",{children:t?(0,v.jsx)("i",{className:"fa fa-minus-square-o agh","aria-hidden":"true"}):(0,v.jsx)("i",{className:"fa fa-plus-square-o agh","aria-hidden":"true"})})})};var st=s(1418),nt=s.n(st);const at=e=>{let{count:t,topicId:s}=e,n=[];if(t>100){let e=S(t);for(let t=1;t<=e;t++){let a,r="/topic.php?id=".concat(s,"&page=").concat(t);a=t>3&&t<e?"\u2022":String(t),n.push((0,v.jsx)(l.rU,{className:"agh",style:{margin:"3px"},to:r,children:a},t))}}if(t>20){let e="/topic.php?id=".concat(s,"&page=last20#F");n.push((0,v.jsx)(l.rU,{className:"agh",style:{margin:"3px"},to:e,children:"\xbb"},"last20"))}return(0,v.jsx)("span",{className:"topic-pages",children:n})},rt=e=>{let{data:t}=e;const s=ne((e=>e.login.userName));let n,a="/topic.php?id=".concat(t.id),r=nt()("agb","mr5",{bold:t.count>=100,mytopics:t.author===s,pinned:t.pinned}),i="/index.php?section=".concat(t.sectionCode);t.section&&(n=(0,v.jsxs)("span",{className:"topic-section",children:[(0,v.jsx)("span",{className:"agh",style:{margin:"0px 5px"},children:"/"}),(0,v.jsx)(l.rU,{rel:"nofollow",className:"agh",to:i,children:t.section},"1")]}));let o=((e,t,s)=>"life"!==t||e.startsWith("OFF")?"job"!==s||e.startsWith("JOB")?"v7"!==s||e.startsWith("v7")?e:"v7: "+e:"JOB: "+e:"OFF: "+e)(t.text,t.forum,t.sectionCode);return(0,v.jsx)("div",{className:"cell-title",children:(0,v.jsxs)("div",{className:"cell-title--inner",children:[t.pinned&&(0,v.jsx)("i",{className:"fa fa-thumb-tack agh","aria-hidden":"true",style:{marginRight:"5px"}}),(0,v.jsx)(l.rU,{to:a,className:r,dangerouslySetInnerHTML:{__html:o},style:{overflowWrap:"anywhere"}}),t.isVoting&&(0,v.jsx)("span",{className:"agh separator",children:"[\xb1]"}),(0,v.jsx)(at,{count:t.count,topicId:t.id}),t.closed&&(0,v.jsx)("span",{className:"agh",children:"\xd8"}),t.down&&(0,v.jsx)("span",{className:"agh",children:"\u2193"}),n]})})};var it=s(3892);const ot=e=>{let{topicId:t,onFirst:s,onPrev:n,onNext:a,onLast:r,close:i}=e;return(0,v.jsxs)("div",{className:"topic-preview-rewind",children:[(0,v.jsx)("div",{className:"topic-preview-button flex-small",onClick:s,title:"\u041a \u043f\u0435\u0440\u0432\u043e\u043c\u0443",children:(0,v.jsx)("i",{className:"fa fa-angle-double-left","aria-hidden":"true"})}),(0,v.jsx)("div",{className:"topic-preview-button flex-large",onClick:n,title:"\u041a \u043f\u0440\u0435\u0434\u044b\u0434\u0443\u0449\u0435\u043c\u0443",children:(0,v.jsx)("i",{className:"fa fa-angle-left","aria-hidden":"true"})}),(0,v.jsx)("div",{className:"topic-preview-button flex-large",onClick:a,title:"\u041a \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0435\u043c\u0443",children:(0,v.jsx)("i",{className:"fa fa-angle-right","aria-hidden":"true"})}),(0,v.jsx)("div",{className:"topic-preview-button flex-small",onClick:r,title:"\u041a \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0435\u043c\u0443",children:(0,v.jsx)("i",{className:"fa fa-angle-double-right","aria-hidden":"true"})}),(0,v.jsxs)("div",{className:"topic-preview-button close-preview",onClick:i,children:[(0,v.jsx)("i",{className:"fa fa-angle-right","aria-hidden":"true"}),(0,v.jsx)("i",{className:"fa fa-angle-left","aria-hidden":"true",style:{marginLeft:"-2px"}})]}),(0,v.jsx)("div",{className:"topic-preview-button edit-preview",children:(0,v.jsx)(l.rU,{to:"/topic.php?id=".concat(t,"&page=last20#F"),children:(0,v.jsx)("i",{className:"fa fa-pencil","aria-hidden":"true",style:{color:"var(--font-color)"}})})})]})};var lt=s(1947),ct=s.n(lt);const dt=function(e){const t=new Set("if|\u0435\u0441\u043b\u0438|then|\u0442\u043e\u0433\u0434\u0430|elsif|\u0438\u043d\u0430\u0447\u0435\u0435\u0441\u043b\u0438|else|\u0438\u043d\u0430\u0447\u0435|endif|\u043a\u043e\u043d\u0435\u0446\u0435\u0441\u043b\u0438|do|\u0446\u0438\u043a\u043b|for|\u0434\u043b\u044f|to|\u043f\u043e|each|\u043a\u0430\u0436\u0434\u043e\u0433\u043e|in|\u0438\u0437|while|\u043f\u043e\u043a\u0430|enddo|\u043a\u043e\u043d\u0435\u0446\u0446\u0438\u043a\u043b\u0430|procedure|\u043f\u0440\u043e\u0446\u0435\u0434\u0443\u0440\u0430|endprocedure|\u043a\u043e\u043d\u0435\u0446\u043f\u0440\u043e\u0446\u0435\u0434\u0443\u0440\u044b|function|\u0444\u0443\u043d\u043a\u0446\u0438\u044f|endfunction|\u043a\u043e\u043d\u0435\u0446\u0444\u0443\u043d\u043a\u0446\u0438\u0438|var|\u043f\u0435\u0440\u0435\u043c|export|\u044d\u043a\u0441\u043f\u043e\u0440\u0442|goto|\u043f\u0435\u0440\u0435\u0439\u0442\u0438|and|\u0438|or|\u0438\u043b\u0438|not|\u043d\u0435|val|\u0437\u043d\u0430\u0447|break|\u043f\u0440\u0435\u0440\u0432\u0430\u0442\u044c|continue|\u043f\u0440\u043e\u0434\u043e\u043b\u0436\u0438\u0442\u044c|return|\u0432\u043e\u0437\u0432\u0440\u0430\u0442|try|\u043f\u043e\u043f\u044b\u0442\u043a\u0430|except|\u0438\u0441\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435|endtry|\u043a\u043e\u043d\u0435\u0446\u043f\u043e\u043f\u044b\u0442\u043a\u0438|raise|\u0432\u044b\u0437\u0432\u0430\u0442\u044c\u0438\u0441\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435|false|\u043b\u043e\u0436\u044c|true|\u0438\u0441\u0442\u0438\u043d\u0430|undefined|\u043d\u0435\u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u043e|null|new|\u043d\u043e\u0432\u044b\u0439|execute|\u0432\u044b\u043f\u043e\u043b\u043d\u0438\u0442\u044c|\u0430\u0441\u0438\u043d\u0445|async|\u0436\u0434\u0430\u0442\u044c|wait".split("|")),s=new Set("():;.,=+-*<>?[]%/".split("")),n="<span class=",a="</span>",r="bg>",i="num>",o="str>",l="key>";let c,d,u,h=!1,p="";function m(e){return""===e.trim()}function x(e,t,s){return e.substring(t-1,t-1+s)}function g(e,t){return e.substring(e.length-t)}function f(e){return t.has(e.toLowerCase().trim())}function v(e,t){" "===e||u===t?c+=e:(d&&(c+=a,d=!1),c=c+n+t+e,d=!0,u=t)}function j(e){let t=!1,n=!1,a=1,d=!0,j=1;for(j=1;j<=e.length;j++){let y=e.charAt(j-1);if(h)'"'===y?(v(x(e,a,j-a+1),o),h=!1,p="",d=!0):p+=y;else if(t)"'"===y?(v(x(e,a,j-a+1),o),t=!1,p="",d=!0):p+=y;else if(" "===y)m(p)?c+=" ":(n?(v(p+" ",o),n=!1):f(p.trim())?v(p+" ",l):isNaN(parseInt(p,10))?v(p+" ",r):v(p+" ",i),p=""),d=!0;else if(s.has(y)){if(m(p)||(n?(v(p,o),n=!1,d="."!==y):d&&f(p)?(v(p,l),d="."!==y):(isNaN(parseInt(p,10))?v(p,r):v(p,i),d="."!==y),p=""),"."===y&&u===i){v(y,i);continue}if("="===y&&"<"===x(e,j-1,1))u=void 0;else if("/"===y&&"/"===x(e,j+1,1))return void v(g(e,e.length-j+1),"com>");v(y,"sp>")}else if('"'===y||"|"===y)m(p)?(a=j,h=!0):(v(p+y,o),p=""),d=!0;else if("'"===y)m(p)?(a=j,t=!0):(v(p+y,o),p=""),d=!0;else{if("#"===y||"&"===y&&m(c)){v(g(e,e.length-j+1),"pr>"),j=e.length;break}"~"===y?(p+=y,n=!0):p+=y}}h||t?v(x(e,a,j-a+1),o):m(p)||(f(p)?v(p,l):isNaN(parseInt(p,10))?v(p,r):v(p,i))}h=!1,p="",d=!1,u=void 0,c="";let y=[];for(let b of e.split("\n"))m(b)?y.push(""):(c="",j(b),d&&!h?(c+="</span>",d=!1,u="",p=""):h||(u="",p=""),y.push(c));return y.join("\n")},ut=e=>{let{children:t}=e;const[s,n]=(0,o.useState)(!0);let a="";if(t){a=T(t).join(""),a=(e=>{let t=e.replace(/\n<br>/g,"\n").replace(/<br>\n/g,"\n").replace(/\r<br>/g,"\n").replace(/<br>\r/g,"\n").replace(/<br>/g,"\n").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt");for(;"\n"===t[0];)t=t.substring(1);for(;"\n"===t.substring(t.length-1);)t=t.substring(0,t.length-1);return dt(t)})(a)}let r,i=0;a&&(i=a.split("\n").length),r=s?"\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c: ".concat(i," \u0441\u0442\u0440\u043e\u043a"):"\u0421\u043a\u0440\u044b\u0442\u044c";let l=null;i>7&&(l=(0,v.jsx)("div",{className:"expand-button-div",children:(0,v.jsx)("span",{className:"expand-button-span",onClick:()=>{n(!s)},children:r})}));let c={};return s&&i>7?(c.overflow="hidden",c.height="135px"):(c.overflow="auto",c.height="auto"),(0,v.jsxs)("div",{style:{marginTop:"5px"},children:[(0,v.jsx)("pre",{className:"code-pre",style:c,dangerouslySetInnerHTML:{__html:a}}),l]})},ht=e=>{const t=(0,o.useRef)(null),s=ae(Ie),[n]=(0,l.lr)(),a=k(n.get("id"),-1),r=ne((e=>+e.options.items.tooltipDelay));let i="";i=e.children?T(e.children).join(""):String(e.number);const[c,d]=(0,o.useState)(i);(0,o.useEffect)((()=>{let t=!0;if(!i.startsWith("http"))return void d(i);return(async()=>{const{title:s}=await F(e.topicId);t&&d(s)})(),()=>{t=!1}}),[i,e.topicId]);const u=e=>{e.persist(),t.current=window.setTimeout((()=>m(e)),r)},h=()=>{t.current&&clearTimeout(t.current)},p=e=>{e.stopPropagation(),t.current&&clearTimeout(t.current),m(e)},m=t=>{const{topicId:n,number:a}=e,r={x:t.pageX,y:t.pageY-50},i={topicId:+n,number:+a};s.show({keys:i,coords:r})};if(e.topicId!==a&&isNaN(+c)){const t=S(e.number);let s="";return t>1&&(s="&page=".concat(t)),(0,v.jsxs)("span",{children:[(0,v.jsx)("a",{href:"#/topic.php?id=".concat(e.topicId).concat(s,"#").concat(e.number),style:(0,Q.Z)({},e.style),children:c})," ","(",(0,v.jsx)("span",{onMouseOver:u,onMouseOut:h,onClick:p,className:"link",role:"button",children:e.number}),")"]})}return(0,v.jsx)("span",{onMouseOver:u,onMouseOut:h,onClick:p,className:"link",style:(0,Q.Z)({},e.style),role:"button",children:c})};var pt=s(5987),mt=s(5915),xt=s.n(mt);const gt=e=>{let{href:t,children:s}=e;return(0,v.jsx)("a",{href:t,className:"registered-user",children:s})},ft=e=>{let{href:t}=e,[s,n]=(0,o.useState)(t),[a,r]=(0,o.useState)("");(0,o.useEffect)((()=>{let e=!0;return(async()=>{const s=(e=>{let t=e;-1===e.search(/http/)&&(t="http://"+t);try{var s=new URL(t)}catch(n){return null}return-1!==s.hostname.search(/youtube/)?s.searchParams.get("v"):-1!==s.hostname.search(/youtu\.be/)?s.pathname.substring(1):null})(t);if(s)try{const a=await(async e=>{const t=localStorage.getItem("youtubeApiKey")||"AIzaSyCztN2QW4Fxw_1YuAHBTOZdYLbzigPz25g";let s="https://www.googleapis.com/youtube/v3/videos?key=".concat(t,"&fields=items(snippet(title))&part=snippet&id=").concat(e);const n=await fetch(s),a=await n.json();if(0===a.items.length)return{hrefName:"",title:"",notFound:!0};const r=a.items[0].snippet.title;let i=r;return r.length>55&&(i=i.substring(0,50)+"..."),{hrefName:i,title:r,notFound:!1}})(s);e&&(a.notFound?n(t+" (\u0432\u0438\u0434\u0435\u043e \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e)"):(n(a.hrefName),r(a.title)))}catch(a){console.error("youtube",s,a.message)}})(),()=>{e=!1}}),[t]);return(0,v.jsx)("a",{href:t,title:a,children:"".concat("youtube",": ").concat(s)})},vt=["href","children","parentText"],jt=e=>{let{href:t,children:s,parentText:n}=e,a=(0,pt.Z)(e,vt);const r=ne((e=>"true"===e.options.items.showYoutubeVideoTitle)),i=ne((e=>"true"===e.options.items.replaceCatalogMista)),o=ne((e=>"true"===e.options.items.fixBrokenLinks));try{var l=new(xt())(t,!0)}catch(u){return console.error(u.message,t),(0,v.jsx)("a",{href:t,children:t})}let c=t;if(c.startsWith("/")&&(l.set("protocol","https"),l.set("hostname","forum.mista.ru"),c=l.href),-1!==l.hostname.search(/forum\.mista.ru/)){if("/topic.php"===l.pathname)return(0,v.jsx)(ht,{topicId:l.query.id,number:l.hash.replace("#","")||"0",children:T(s)});if("/users.php"===l.pathname)return(0,v.jsx)(gt,{href:l.href,children:s})}return"a-sitnikov.github.io"===l.hostname&&"/react.mista/"===l.pathname&&0===Object.keys(l.query).length&&"/react.mista/topic.php"===(l=new(xt())(t.replace(/#\//,""),!0)).pathname?(0,v.jsx)(ht,{topicId:l.query.id,number:l.hash.replace("#","")||"0",children:T(s)}):!r||-1===(d=l.hostname).search(/youtube/)&&-1===d.search(/youtu\.be/)?i&&(e=>-1!==e.search(/catalog\.mista/))(l.hostname)?(l.set("hostname","infostart.ru"),(0,v.jsxs)("a",{target:null===a||void 0===a?void 0:a.target,className:null===a||void 0===a?void 0:a.class,rel:null===a||void 0===a?void 0:a.rel,href:l.href,children:[l.href," "]})):(o&&n&&(c=((e,t)=>{let s=e.replace(/\[/g,"\\[").replace(/\]/g,"\\]").replace(/\./g,"\\.").replace(/\./g,".").replace(/\*/g,"\\*").replace(/\+/g,"\\+").replace(/\(/g,"\\(").replace(/\)/g,"\\)").replace(/\?/g,"\\?").replace(/\//g,"\\/");try{let n=new RegExp(s+"<\\/a>(\\)|[\u0430-\u044f\u0451\u0410-\u042f\u04010-9#\\-\\+\\_\\%\\?=]*)"),a=t.match(n);if(a&&a.length>1)return")"===a[1]&&-1===e.search("\\(")?e:e+=a[1]}catch(u){console.error(u)}return e})(c,n)),(0,v.jsx)("a",{target:null===a||void 0===a?void 0:a.target,className:null===a||void 0===a?void 0:a.class,rel:null===a||void 0===a?void 0:a.rel,href:c,children:s})):(0,v.jsx)(ft,{href:t});var d},yt=e=>{let{topicId:t,data:s,total:n,n:a,colors:r}=e;const i="".concat(A,"/css/voting").concat(a,".png");let o=0;n&&(o=Math.round(100*s.count/n));return(0,v.jsxs)("li",{className:"voting-item",children:[(0,v.jsx)("div",{className:"voting-title",children:(0,v.jsx)("a",{rel:"nofollow",style:{textDecoration:"none"},href:"#/topic.php?id=".concat(t,"&sel=").concat(a),children:(0,v.jsx)("b",{children:(0,v.jsx)("span",{style:{color:r[a-1]},children:"".concat(a,". ").concat(s.text)})})})}),(0,v.jsx)("div",{className:"voting-percentage",children:(0,v.jsx)("b",{children:(0,v.jsx)("span",{style:{color:r[a-1]},children:"".concat(o,"% (").concat(s.count,")")})})}),(0,v.jsx)("div",{className:"voting-bar",children:(0,v.jsx)("div",{style:{width:"".concat(o,"%")},children:(0,v.jsx)("a",{href:i,children:(0,v.jsx)("img",{src:i,style:{maxWidth:"500px",width:"100%",height:"15px"},alt:"\u0432\u0430\u0440\u0438\u0430\u043d\u0442 ".concat(a)})})})})]})},bt=e=>{let{items:t,topicId:s,colors:n}=e,a=Math.max(...t.map((e=>e.count)));return(0,v.jsx)("ul",{style:{paddingLeft:0},children:t.filter((e=>e.text)).map(((e,t)=>(0,v.jsx)(yt,{data:e,total:a,n:t+1,topicId:s,colors:n},t)))})},Nt=(0,o.memo)((e=>{let{colors:t,n:s,text:n}=e;return(0,v.jsx)("div",{style:{marginTop:"5px"},children:(0,v.jsx)("b",{children:(0,v.jsx)("span",{style:{color:t[s-1]},children:"".concat(s,". ").concat(n)})})})}));var wt=s(5930);s(432);const It=e=>{let{idx:t,topicId:s,topicDate:n,messageNumber:a}=e;const r=I()(n).format("YYYY/MM/DD"),i="https://forum.mista.ru/topics/files/".concat(r,"/").concat(s,"/").concat(a),o="".concat(i,"/").concat(t,"_preview.png"),l="".concat(i,"/").concat(t,".png");return(0,v.jsx)(wt.HI,{src:l,children:(0,v.jsx)("img",{src:o,alt:"",style:{maxWidth:"100%",cursor:"pointer"}})})},kt=(0,o.memo)(It),Ct=ct().Parser(),St=ct().ProcessNodeDefinitions(),Tt=()=>!0,_t={shouldProcessNode:e=>"link"===(null===e||void 0===e?void 0:e.name),processNode:(e,t,s)=>{const n=e.attribs["data-topicid"],a=e.attribs["data-number"];return(0,v.jsx)(ht,{topicId:n,number:a},s)}},Zt={shouldProcessNode:e=>"code"===(null===e||void 0===e?void 0:e.name)||"pre"===(null===e||void 0===e?void 0:e.name),processNode:(e,t,s)=>(0,v.jsx)(ut,{children:t},s)},Lt=e=>({shouldProcessNode:e=>"a"===(null===e||void 0===e?void 0:e.name),processNode:function(t,s,n){const a=t.attribs.href;return(0,v.jsx)(jt,{href:a,parentText:e,children:s},n)}}),Mt=(e,t,s)=>({shouldProcessNode:e=>"int_img"===(null===e||void 0===e?void 0:e.name),processNode:function(n,a,r){const i=n.attribs.idx;return(0,v.jsx)(kt,{topicId:e,topicDate:t,messageNumber:s,idx:i},r)}}),Pt=(0,o.memo)((e=>{let{html:t,topicId:s,topicDate:n,messageNumber:a}=e;const r=((e,t,s,n)=>{if(!e)return e;let a=(e=>e.replace(/\[1[C\u0421]\]/gi,"<code>").replace(/<1[C\u0421]>/gi,"<code>").replace(/\[\/1[C\u0421]\]/gi,"</code>").replace(/<\/1[C\u0421]>/gi,"</code>"))(e);return a=((e,t)=>e.replace(/(\()(\d+)(\))(?![^<>]*<\/)/gi,(function(e){const s=arguments.length<=2?void 0:arguments[2];return"(<link data-topicid='".concat(t,"' data-number='").concat(s,"'></link>)")})))(a,t),a=((e,t,s,n)=>e.replace(/\[IMG_(\d*)\]/gi,(function(e){return"<int_img idx='".concat(arguments.length<=1?void 0:arguments[1],"'></int_img>")})))(a),a})(t,s),i=[_t,Zt,Lt(r),Mt(s,n,a),{shouldProcessNode:()=>!0,processNode:St.processDefaultNode}],o=Ct.parseWithInstructions(r,Tt,i);return(0,v.jsx)(v.Fragment,{children:o})})),Ot=e=>{let{topicId:t,topicDate:s,n:n,html:a,vote:r,style:i}=e;const{data:{info:l}}=Le({topicId:t},{enabled:!1}),c=ne((e=>e.options.voteColors));let d=null;r&&l.voting&&t===l.id&&(d=l.voting[r-1].text);const[u,h]=(0,o.useState)(d);(0,o.useEffect)((()=>{r&&!d&&(async()=>{try{const e=await F(t);h(e.voting[r-1].text)}catch(e){console.error(e.message)}})()}),[r,d,t]);const p=0!==r&&null!==u;let m;return 0===n&&l.isVoting&&l.voting&&(m=(0,v.jsx)(bt,{items:l.voting,topicId:t,colors:c})),(0,v.jsxs)("div",{className:"message",style:i,children:[m,(0,v.jsx)("div",{children:(0,v.jsx)(wt.TV,{children:(0,v.jsx)(Pt,{html:a,topicId:t,topicDate:s,messageNumber:n})})}),p&&(0,v.jsx)(Nt,{text:u,n:r,colors:c})]})},Dt=e=>{const t=ae(_e),[s,n]=(0,o.useState)("none"),a=()=>{const{data:s}=e;t.changeText("(".concat(s.n,")"));let n=document.getElementById("message_text");n&&window.scrollTo(0,n.offsetTop)},{data:r,isAuthor:i,isYou:l,isTooltip:c}=e;(0,o.useEffect)((()=>{n("none")}),[r.n]);const d="".concat(A,"/users.php?id=").concat(r.userId);let u;u=r?0===r.n?I()(r.time).format("DD.MM.YY - HH:mm"):(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("span",{className:"message-number",children:r.n})," - "+I()(r.time).format("DD.MM.YY - HH:mm")]}):"";const h=nt()("registered-user",{"is-author":i,"is-you":l});let p,m;return window.innerWidth>768&&(p=(0,v.jsx)("img",{src:"".concat(A,"/css/user_icons/").concat(r.userId,"_16x16.png"),alt:"user ico",onLoad:()=>{n("inline")},onError:()=>{n("none")},style:{display:s,marginBottom:"4px",marginRight:"1px"}})),m=c?(0,v.jsx)("div",{className:"ah",style:{display:"inline-block",marginLeft:"5px"},children:u}):(0,v.jsxs)("div",{className:"message-time",children:[(0,v.jsx)("span",{className:"ah",children:u}),(0,v.jsx)("button",{className:"button ah",onClick:a,children:u})]}),(0,v.jsxs)("div",{className:"user-info",children:[p,(0,v.jsx)("a",{className:h,href:d,children:r.user}),m]})},Ft=e=>{let{topicId:t,n:s,author:n,loggedUserId:a,onDataLoaded:r}=e;const[i,l]=(0,o.useState)(null),[c,d]=(0,o.useState)(null);return(0,o.useEffect)((()=>{(async()=>{try{const e=await z(t,s);e?(l(e),d(null),r&&r()):(l(null),d("\u041d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435 ".concat(s)))}catch(e){l(null),d(e.message)}})()}),[t,s,r]),i||c?(0,v.jsxs)(v.Fragment,{children:[i&&(0,v.jsxs)("div",{className:"preview-content",children:[(0,v.jsx)("div",{className:"topic-preview-userinfo",children:(0,v.jsx)(Dt,{data:i,isAuthor:i.user===n,isYou:i.userId===a,isTooltip:!0})}),(0,v.jsx)(Ot,{topicId:t,topicDate:i.time,n:s,html:i.text,vote:i.vote,style:{overflowY:"auto",overflowWrap:"break-word"}})]}),c&&(0,v.jsx)("span",{children:c})]}):null},Rt=e=>{let{topicId:t,initialMsgNumber:s,author:n,close:a}=e;const r=ne((e=>e.login.userId)),[i,l]=(0,o.useState)(0),[c,d]=(0,o.useState)("none"),[u,h]=(0,o.useState)({msgNumber:s,key:0}),p=(0,it.QS)({onSwiping:e=>{Math.abs(e.deltaX)<35?l(0):l(e.deltaX)},onSwiped:e=>{Math.abs(e.deltaX)>150&&("Left"===e.dir?h({msgNumber:u.msgNumber+1,key:u.key+1}):"Right"===e.dir&&u.msgNumber>0&&h({msgNumber:u.msgNumber-1,key:u.key+1})),l(0)},delta:15}),m=(0,o.useCallback)((()=>{d("block")}),[]);let x=[u.msgNumber];i<0?x.push(u.msgNumber+1):i>0&&u.msgNumber>0&&x.push(u.msgNumber-1);const g={transform:"translate3d(".concat(i,"px, 0px, 0px)"),flexDirection:i>0?"row-reverse":"row"};return(0,v.jsx)("div",{className:"preview-container",style:{display:c},children:(0,v.jsxs)("div",{className:"topic-preview",children:[(0,v.jsx)(ot,{topicId:t,onFirst:()=>{h({msgNumber:0,key:u.key})},onLast:async()=>{const e=await F(t);h({msgNumber:e.count,key:u.key})},onNext:()=>{h({msgNumber:u.msgNumber+1,key:u.key})},onPrev:()=>{u.msgNumber>0&&h({msgNumber:u.msgNumber-1,key:u.key})},close:a}),(0,v.jsxs)("div",(0,Q.Z)((0,Q.Z)({className:"preview-carousel"},p),{},{style:g,children:[(0,v.jsx)("div",{className:"preview-carousel-item",style:{order:0},children:(0,v.jsx)(Ft,{topicId:t,n:x[0],loggedUserId:r,author:n,onDataLoaded:m})},u.key),x.length>1&&(0,v.jsx)("div",{className:"preview-carousel-item",style:{order:1},children:(0,v.jsx)(Ft,{topicId:t,n:x[1],loggedUserId:r,author:n})},u.key+1)]}))]})})},Et=e=>{let{item:t}=e;const[s,n]=(0,o.useState)();return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsxs)("div",{className:"topics-list-row",children:[(0,v.jsx)(Ge,{item:t}),(0,v.jsx)("div",{className:"cell-section",children:t.section}),(0,v.jsx)($e,{item:t,onClick:()=>{void 0===s||s!==t.count?n(t.count):n(void 0)}}),(0,v.jsx)(tt,{expanded:void 0!==s,onClick:()=>{n(void 0===s?0:void 0)}}),(0,v.jsx)(rt,{data:t}),(0,v.jsx)(Xe,{item:t}),(0,v.jsx)(et,{item:t}),(0,v.jsx)(Qe,{item:t})]}),void 0!==s&&(0,v.jsx)(Rt,{topicId:t.id,initialMsgNumber:s,author:t.author,close:()=>n(void 0)})]})};var zt=s(8116);const Vt=e=>{let{maxPage:t,last20:s}=e;const n=(0,h.TH)();let a=n.pathname;"/"===a&&(a="/index.php");const r=new URLSearchParams(n.search);let i;const o=r.get("page");i=o?"last20"===o?"last20":parseInt(o,10)||1:1;let l=[];for(let c=1;c<=t;c++){r.set("page",String(c));let e="#"+a+"?"+r.toString();l.push((0,v.jsx)(zt.Z.Item,{active:i===c,href:e,children:c},c))}if(!0===s){r.set("page","last20");let e="#"+a+"?"+r.toString();l.push((0,v.jsx)(zt.Z.Item,{active:"last20"===i,href:e,children:"\xbb"},"last20"))}return(0,v.jsx)(zt.Z,{style:{margin:"0px"},children:l})};var Ut=s(323),At=s(6144);const Wt=e=>{let{placeholder:t,showVoting:s,isVoting:n,isFetching:a,text:r,formRef:i,onChange:l,onShowVotingChange:c}=e;const d=(0,o.useRef)(),h=(0,o.useCallback)((e=>{c&&c(e.currentTarget.checked)}),[c]),p=(0,o.useCallback)((e=>{l&&l(e.currentTarget.value)}),[l]);return(0,v.jsxs)("div",{children:[(0,v.jsx)(m.Z,{as:"textarea","aria-label":"\u0421\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435",placeholder:t,cols:70,rows:3,value:r,onChange:p,onKeyUp:e=>{i&&i.current&&"Enter"===e.key&&e.ctrlKey&&i.current.dispatchEvent(new Event("submit",{cancelable:!0,bubbles:!0}))},ref:d,className:"text-editor input","data-lpignore":!0}),(0,v.jsxs)("div",{className:"flex-row",children:[(0,v.jsxs)(At.Z,{children:[(0,v.jsx)(We.Z,{size:"sm",variant:"light",onClick:e=>{e.preventDefault();const t=d.current,s=t.selectionStart,n=t.selectionEnd,a=t.value,r=a.length,i="[1C]\n"+a.substring(s,n)+"\n[/1C]";let o=a.substring(0,s)+i+a.substring(n,r);l&&l(o)},style:{marginRight:"5px"},className:"button",children:"\u041a\u043e\u0434 1\u0421"}),(0,v.jsx)(We.Z,{size:"sm",variant:"light",disabled:a,type:"submit",className:"button",children:a?"\u041e\u0442\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u0442\u0441\u044f":"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c"})]}),s&&(0,v.jsx)(u.Z.Check,{id:"show_voting",type:"checkbox",checked:n,onChange:h,label:"\u0413\u043e\u043b\u043e\u0441\u043e\u0432\u0430\u043d\u0438\u0435",style:{margin:"auto 0px auto auto"}})]})]})},Yt=e=>{var t;let{onSubmitSuccess:s}=e;const{data:n}=G(),a=ne((e=>e.newTopic)),[r,i]=(0,o.useState)(null),[l,c]=(0,o.useState)(Array(10).fill("")),d=(0,o.useRef)(null),h=se(),m=ae(fe),x=(0,f.$0)(((e,t)=>{i(t),m.changeSection(t)})),g=e=>t=>{let s=l.slice();s[e]=t.target.value,c(s)},j=(0,f.$0)((e=>{if(e.preventDefault(),!r)return void m.setError("\u041d\u0435 \u0432\u044b\u0431\u0440\u0430\u043d\u0430 \u0441\u0435\u043a\u0446\u0438\u044f");let t=a.subject;if(!t)return void m.setError("\u041d\u0435 \u0443\u043a\u0430\u0437\u0430\u043d\u0430 \u0442\u0435\u043c\u0430");if(!a.text)return void m.setError("\u041d\u0435 \u0443\u043a\u0430\u0437\u0430\u043d\u043e \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435");let s={subject:t,text:a.text,section:r.id,forum:r.forum,isVoting:a.isVoting,votingItems:[],onSuccess:w};if(a.isVoting){s.votingItems=[];for(let e=1;e<=10;e++){let t=l[e-1];t&&s.votingItems.push(t)}}h((e=>(t,s)=>{if((e=>{let{newTopic:t}=e;return!!t&&"loading"!==t.status})(s()))return t(me(e))})(s))})),y=(0,o.useCallback)((e=>{m.changeSubject(e.target.value)}),[m]),b=(0,o.useCallback)((e=>{m.changeText(e)}),[m]),N=(0,o.useCallback)((e=>{m.showVoting(e)}),[m]),w=()=>{m.clear(),s&&s()};let I=[];for(let o in n.tree)I.push((0,v.jsx)("option",{value:o.toLowerCase(),children:o},o));let k=[];if(a.isVoting){k.push((0,v.jsx)("div",{children:"\u0412\u0430\u0440\u0438\u0430\u043d\u0442\u044b:"},"p"));for(let e=1;e<=10;e++)k.push((0,v.jsxs)(p.Z,{size:"sm",style:{marginBottom:"3px",width:"100%"},children:[(0,v.jsx)(p.Z.Text,{style:{width:"40px"},className:"input",children:"".concat(e,".")}),(0,v.jsx)(u.Z.Control,{type:"text","aria-label":"\u0412\u0430\u0440\u0438\u0430\u043d\u0442 ".concat(e),maxLength:50,className:"input",value:l[e-1],onChange:g(e-1)})]},e))}return(0,v.jsxs)("form",{className:"new-topic-container",onSubmit:j,ref:d,children:[(0,v.jsxs)("div",{id:"newtopic_form",className:"new-topic-text",children:[(0,v.jsx)("div",{children:(0,v.jsx)("b",{children:"\u041d\u043e\u0432\u0430\u044f \u0442\u0435\u043c\u0430:"})}),a.error&&(0,v.jsx)(He,{text:a.error}),(0,v.jsxs)("div",{className:"flex-row",style:{marginBottom:"3px"},children:[(0,v.jsx)(u.Z.Select,{disabled:!0,size:"sm",value:a.forum,style:{flex:"0 1 90px"},className:"input",children:I}),(0,v.jsx)(qe,{id:"target_section",defaultValue:"\u0421\u0435\u043a\u0446\u0438\u044f",selected:null===(t=a.section)||void 0===t?void 0:t.code,size:"sm",style:{flex:"1 1 auto"},onChange:x})]}),(0,v.jsx)(u.Z.Control,{type:"text","aria-label":"\u0422\u0435\u043c\u0430",placeholder:"\u0422\u0435\u043c\u0430",size:"sm",value:a.subject,onChange:y,style:{marginBottom:"3px"},className:"input",maxLength:90}),(0,v.jsx)(Wt,{placeholder:"\u0421\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435",showVoting:!0,isVoting:a.isVoting,text:a.text,isFetching:"loading"===a.status,onChange:b,onShowVotingChange:N,formRef:d})]}),(0,v.jsx)(Ut.Z,{className:"new-topic-voting",children:k})]})},Ht=()=>{const[e]=(0,l.lr)(),{isFetching:t,data:s,error:n,refetch:a}=re({searchParams:e});return(0,o.useEffect)((()=>{document.title="React.Mista"}),[]),(0,o.useEffect)((()=>{window.scrollTo(0,0)}),[e]),(0,v.jsxs)("div",{children:[(0,v.jsx)(Ke,{}),n&&(0,v.jsx)(He,{text:n.message}),(0,v.jsxs)("div",{className:"topic-list-table",children:[(0,v.jsx)(Je,{onUpdateClick:a,isLoading:t}),(null!==s&&void 0!==s?s:[]).map((e=>(0,v.jsx)(Et,{item:e},e.id))),(0,v.jsx)("div",{className:"table-footer",children:(0,v.jsx)(Vt,{maxPage:10})})]}),(0,v.jsx)("div",{id:"F",className:"newtopic",style:{marginBottom:"10px",marginTop:"5px",position:"relative"},children:(0,v.jsx)(Yt,{onSubmitSuccess:a})})]})},Bt={"1c":"1\u0421:\u041f\u0440\u0435\u0434\u043f\u0440\u0438\u044f\u0442\u0438\u0435",life:"\u041e \u0436\u0438\u0437\u043d\u0438",it:"\u0418\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u043e\u043d\u043d\u044b\u0435 \u0442\u0435\u0445\u043d\u043e\u043b\u043e\u0433\u0438\u0438",job:"\u0420\u0430\u0431\u043e\u0442\u0430"},qt=e=>{let{topicId:t}=e;const{data:s}=Le({topicId:t},{enabled:!1});return(0,v.jsxs)("div",{className:"flex-row",children:[(0,v.jsx)("div",{className:"header-left",children:(0,v.jsx)(Be,{})}),(0,v.jsx)("div",{className:"header-right",children:(0,v.jsx)("span",{id:"forum_string",className:"bold120",children:(0,v.jsx)(l.rU,{to:"/index.php?forum=".concat(null===s||void 0===s?void 0:s.info.forum),style:{textDecoration:"none"},children:Bt[null===s||void 0===s?void 0:s.info.forum]})})})]})},Kt=e=>{let{topicId:t}=e;const{data:s}=Le({topicId:t});let n="https://www.yandex.ru/search/?text="+encodeURIComponent(null===s||void 0===s?void 0:s.info.title);return(0,v.jsxs)("div",{className:"topic-row",children:[(0,v.jsx)("div",{className:"cell-userinfo",children:(0,v.jsxs)("div",{className:"topic-tools",children:[(0,v.jsx)("a",{title:"API.info",href:"".concat(A,"/").concat(Y,"?id=").concat(t),className:"agh",style:{display:"block",lineHeight:"1em"},children:"i"}),(0,v.jsx)("a",{title:"API.messages",href:"".concat(A,"/").concat(H,"?id=").concat(t,"&from=0&to=20"),className:"agh",style:{display:"block",lineHeight:"1em"},children:"m"})]})}),(0,v.jsx)("div",{className:"cell-message",children:(0,v.jsxs)("div",{className:"flex-row",children:[(0,v.jsxs)("div",{style:{flex:1,textAlign:"center"},children:[(0,v.jsx)("a",{href:"https://forum.mista.ru/topic/".concat(t),children:(0,v.jsx)("h1",{className:"topic-title",dangerouslySetInnerHTML:{__html:null===s||void 0===s?void 0:s.info.title}})}),(0,v.jsx)("div",{className:"moder-action"})]}),(0,v.jsx)("div",{style:{flex:"0 0 20px",position:"relative"},children:(0,v.jsx)("div",{className:"div-va-middle",children:(0,v.jsx)("a",{rel:"noopener noreferrer",href:n,title:"\u0418\u0441\u043a\u0430\u0442\u044c \u0432 \u042f\u043d\u0434\u0435\u043a\u0441\u0435",target:"_blank",className:"yandex",children:"\u042f"})})})]})})]})},Jt=e=>{var t;let{item:s,topicId:n}=e;const a=ne((e=>e.login)),{data:r}=Le({topicId:n},{enabled:!1}),i=(null===r||void 0===r||null===(t=r.item0)||void 0===t?void 0:t.user)||"";return s?(0,v.jsxs)("div",{className:"topic-row",id:String(s.n),children:[(0,v.jsx)("div",{className:"cell-userinfo",children:(0,v.jsx)(Dt,{data:s,isAuthor:s.user===i,isYou:s.user===a.userName})}),(0,v.jsx)("div",{className:"cell-message",children:(0,v.jsx)(Ot,{html:s.text,topicId:n,topicDate:s.time,n:s.n,vote:s.vote})})]}):null},Xt=e=>{let{topicId:t,isLastPage:s}=e;const{isFetching:n,refetch:a}=Me({topicId:t},{enabled:!1});return(0,v.jsxs)("div",{className:"flex-row",id:"F",children:[(0,v.jsx)("div",{className:"ta-left va-top",style:{width:"50%"},children:(0,v.jsx)(We.Z,{onClick:()=>{},disabled:!1,size:"sm",className:"button",variant:"light",children:"\u0417\u0430\u043a\u043b\u0430\u0434\u043a\u0430"})}),(0,v.jsx)("div",{className:"ta-right va-middle",style:{marginLeft:"auto"},children:s&&(0,v.jsx)(We.Z,{onClick:()=>a(),disabled:n,size:"sm",className:"button",variant:"light",children:n?"\u041e\u0431\u043d\u043e\u0432\u043b\u044f\u0435\u0442\u0441\u044f":"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0432\u0435\u0442\u043a\u0443"})})]})},$t=e=>{let{topicId:t,onSubmitSuccess:s}=e;const[n,a]=(0,o.useState)(),r=se(),i=ae(_e),{data:{info:l}}=Le({topicId:t}),c=ne((e=>e.newMessage)),d=()=>{i.changeText(""),a(void 0),s&&s()},h=e=>{e.preventDefault(),a(void 0)},p=e=>{a(e)},m=(0,o.useCallback)((e=>{r(fe.changeText(e))}),[r]);let x;if(null!==l&&void 0!==l&&l.isVoting&&null!==l&&void 0!==l&&l.voting){let e=[];for(let t=1;t<=l.voting.length;t++){const s=l.voting[t-1];s.text&&e.push((0,v.jsx)(u.Z.Check,{type:"radio",name:"voting",checked:n===t,onChange:()=>p(t),label:"".concat(t,". ").concat(s.text)},t))}x=(0,v.jsxs)(Ut.Z,{children:[(0,v.jsx)("legend",{children:(0,v.jsxs)("small",{children:["\u0412\u0430\u0448 \u0432\u044b\u0431\u043e\u0440:",(0,v.jsx)("span",{id:"voting_clear",style:{marginLeft:"5px",cursor:"pointer"},onClick:h,children:"\u043e\u0447\u0438\u0441\u0442\u0438\u0442\u044c"})]})}),e,"\u041e\u0431\u043e\u0441\u043d\u0443\u0439\u0442\u0435 \u0441\u0432\u043e\u0439 \u0432\u044b\u0431\u043e\u0440!"]})}return(0,v.jsxs)("form",{style:{marginTop:"5px"},onSubmit:e=>{e.preventDefault(),e.stopPropagation();let t={text:c.text,topicId:String(null===l||void 0===l?void 0:l.id),onSuccess:d,voting_select:void 0};n&&(t.voting_select=n),r(Se(t))},children:[(0,v.jsx)("div",{className:"bold",children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435 \u0432 \u0442\u0435\u043c\u0443:"}),(0,v.jsxs)("div",{className:"new-message-container",children:[(0,v.jsx)("div",{className:"new-message-text",children:(0,v.jsx)(Wt,{isFetching:"loading"===c.status,text:c.text,placeholder:"\u0421\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435",onChange:m})}),(0,v.jsx)("div",{className:"new-message-voting",children:x})]})]})},Gt=()=>{const e=se(),{hash:t}=(0,h.TH)(),[s]=(0,l.lr)(),n=k(s.get("id"),-1),{data:a,error:r,isPending:i}=Le({topicId:n}),{info:c,item0:d,list:u=[]}=null!==a&&void 0!==a?a:{},p=ne((e=>e.login)),m="last20"===(x=s.get("page"))?"last20":k(x,1);var x;const g=S(null===c||void 0===c?void 0:c.count),f="last20"===m||m===g,{enableUpdater:j,refreshInterval:y}=(e=>{let{isLastPage:t}=e;const[s,n]=ne((e=>[e.options.items.autoRefreshTopic,1e3*k(e.options.items.autoRefreshTopicInterval,60)])),[a,r]=(0,o.useState)(!1);return(0,o.useEffect)((()=>{"true"===s&&t&&setTimeout((()=>r(!0)),n)}),[s,n,t]),{enableUpdater:a,refreshInterval:n}})({isLastPage:f}),{refetch:b}=Me({topicId:n},{refetchInterval:y,enabled:j});return(0,o.useEffect)((()=>{var e;null!==c&&void 0!==c&&c.title&&(document.title=(e=c.title,(new DOMParser).parseFromString(e,"text/html").firstChild.innerText))}),[null===c||void 0===c?void 0:c.title]),(0,o.useEffect)((()=>{if(i)return;if(!t)return;const e=document.getElementById(t.slice(1));e&&window.scrollTo(0,e.offsetTop)}),[i,t]),(0,v.jsxs)("div",{style:{marginBottom:"5px"},children:[(0,v.jsx)(qt,{topicId:n}),r&&(0,v.jsx)(He,{text:r.message}),(0,v.jsxs)("div",{className:"topic-table",children:[(0,v.jsx)(Kt,{topicId:n}),(0,v.jsx)(Jt,{item:d,topicId:n}),u.map(((e,t)=>(0,v.jsx)(Jt,{item:e,topicId:n},e.n))),(g>1||"last20"===m)&&(0,v.jsx)("div",{className:"table-footer",children:(0,v.jsx)(Vt,{maxPage:g,last20:!0})})]}),(0,v.jsx)(Xt,{topicId:n,isLastPage:f}),p.logged&&(0,v.jsx)($t,{topicId:n,onSubmitSuccess:()=>{b(),e(_e.changeText(""))}})]})},Qt=e=>{let{name:t,label:s,value:n,values:a,oneLine:r,onChange:i}=e;const o=e=>{i(e,t,e.target.value)};return(0,v.jsxs)("span",{children:[(0,v.jsxs)("span",{style:{marginRight:"5px"},children:[" ",s," "]}),r&&(0,v.jsx)("br",{}),a.map(((e,t)=>(0,v.jsx)(u.Z.Check,{type:"radio",id:e.name,label:e.descr,name:s,checked:e.name===n,value:e.name,inline:r,onChange:o},t)))]})},es=e=>{const{name:t,value:s,label:n,postfix:a}=e;return(0,v.jsxs)("label",{htmlFor:t,style:{marginRight:"5px"},children:[(0,v.jsx)("span",{style:{marginRight:"5px"},children:n}),(0,v.jsx)("input",{type:"string",name:t,value:s,onChange:t=>{const{name:s}=e;e.onChange(t,s,t.target.value)},className:"input"}),void 0!==a?(0,v.jsx)("span",{style:{marginLeft:"5px"},children:a}):null]})},ts=[{tabName:"\u041e\u0431\u0449\u0438\u0435",rows:[["theme"],["topicsPerPage"],["autoRefreshTopicsList","autoRefreshTopicsListInterval"],["autoRefreshTopic","autoRefreshTopicInterval"]]},{tabName:"\u0422\u0443\u043b\u0442\u0438\u043f\u044b",rows:[["showTooltips","tooltipDelay"],["showTooltipOnPostLink"]]},{tabName:"\u0421\u0441\u044b\u043b\u043a\u0438",rows:[["showYoutubeVideoTitle"],["replaceCatalogMista"],["fixBrokenLinks"]]}],ss={theme:{type:"radio",label:"\u0426\u0432\u0435\u0442\u043e\u0432\u0430\u044f \u043f\u0430\u043b\u0438\u0442\u0440\u0430:",oneLine:!0,values:[{name:"yellow",descr:"\u0417\u043e\u043b\u043e\u0442\u0430\u044f"},{name:"lightgray",descr:"\u0421\u0435\u0440\u0430\u044f"},{name:"dark",descr:"\u0422\u0435\u043c\u043d\u0430\u044f"}]},topicsPerPage:{type:"number",label:"\u0422\u0435\u043c \u043d\u0430 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0435 (max 99):",min:1,max:99},autoRefreshTopicsList:{type:"checkbox",label:"\u0410\u0432\u0442\u043e\u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u0441\u043f\u0438\u0441\u043a\u0430 \u0442\u0435\u043c"},autoRefreshTopicsListInterval:{type:"number",label:"",min:60,max:1e6,postfix:"\u0441\u0435\u043a"},autoRefreshTopic:{type:"checkbox",label:"\u0410\u0432\u0442\u043e\u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u0442\u0435\u043c\u044b"},autoRefreshTopicInterval:{type:"number",label:"",min:60,max:1e6,postfix:"\u0441\u0435\u043a"},showTooltips:{type:"checkbox",label:"\u041f\u043e\u043a\u0430\u0437\u044b\u0432\u0430\u0442\u044c \u0442\u0443\u043b\u0442\u0438\u043f\u044b, \u0437\u0430\u0434\u0435\u0440\u0436\u043a\u0430",disabled:!0},tooltipDelay:{type:"number",max:1e6,label:"",postfix:"\u043c\u0441",disabled:!0},showTooltipOnPostLink:{type:"checkbox",label:"\u041f\u043e\u043a\u0430\u0437\u044b\u0432\u0430\u0442\u044c \u0442\u0443\u043b\u0442\u0438\u043f \u0441\u0441\u044b\u043a\u0438 \u043d\u0430 \u0434\u0440\u0443\u0433\u0443\u044e \u0432\u0435\u0442\u043a\u0443",disabled:!0},showYoutubeVideoTitle:{type:"checkbox",label:"\u041f\u043e\u043a\u0430\u0437\u044b\u0432\u0430\u0442\u044c \u043d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u044f \u0440\u043e\u043b\u0438\u043a\u043e\u0432 youtube"},replaceCatalogMista:{type:"checkbox",label:"\u041e\u0431\u0440\u0430\u0442\u043d\u043e \u0437\u0430\u043c\u0435\u043d\u044f\u0442\u044c catalog.mista.ru \u043d\u0430 infostart.ru"},fixBrokenLinks:{type:"checkbox",label:"\u0427\u0438\u043d\u0438\u0442\u044c \u043f\u043e\u043b\u043e\u043c\u0430\u043d\u043d\u044b\u0435 \u0441\u0441\u044b\u043b\u043a\u0438 (\u0441 \u0440\u0443\u0441\u0441\u043a\u0438\u043c\u0438 \u0441\u0438\u043c\u0432\u043e\u043b\u0430\u043c\u0438)"}},ns=e=>{let{name:t,children:s}=e;return(0,v.jsxs)("div",{children:[(0,v.jsx)("div",{className:"tab-header",children:t}),(0,v.jsx)("div",{className:"tab-content",children:s})]})},as=()=>{const e=se(),t=(0,h.s0)(),s=ne((e=>e.options)),[n,a]=(0,o.useState)({items:s.items}),r=()=>{t("/#")},i=(e,t,s)=>{let r=Object.assign({},n.items);r[t]=s,a((0,Q.Z)((0,Q.Z)({},n),{},{items:r}))};let l=[];for(let o of ts){let e=[];for(let t in o.rows){const s=o.rows[t];let a=[];for(let e of s){const t=ss[e];if(!t)continue;const s=n.items[e];"radio"===t.type?a.push((0,v.jsx)(Qt,{name:e,label:t.label,values:t.values,value:s,oneLine:t.oneLine,onChange:i},e)):"number"===t.type?(t.label&&a.push((0,v.jsx)("label",{htmlFor:e,style:{fontWeight:"inherit"},children:t.label},e+"_label")),a.push((0,v.jsxs)("div",{className:"options-number",children:[(0,v.jsx)(m.Z,{type:"number",min:t.min,max:t.max,value:s,disabled:t.disabled,onChange:t=>i(0,e,t.target.value),className:"input",size:"sm"}),t.postfix&&(0,v.jsx)("span",{style:{marginLeft:"5px",flex:"0 0 auto"},children:t.postfix},e+"_postfix")]},e))):"string"===t.type?a.push((0,v.jsx)(es,{name:e,label:t.label,postfix:t.postfix,value:s,onChange:i},e)):"checkbox"===t.type&&a.push((0,v.jsx)(u.Z.Check,{id:e,type:"checkbox",label:t.label,name:e,checked:"true"===String(s),disabled:t.disabled,onChange:t=>i(0,e,String(t.target.checked)),style:{flex:"0 0 auto",margin:"0px",maxWidth:"100%"}},e))}e.push((0,v.jsx)("div",{className:"options-row",children:a},t))}l.push((0,v.jsx)(ns,{name:o.tabName,children:e},o.tabName))}return(0,v.jsxs)("div",{className:"options-form",children:[(0,v.jsx)("div",{className:"options-header",style:{cursor:"default"},children:(0,v.jsx)("b",{children:"\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438"})}),l,(0,v.jsxs)("div",{className:"button-row",children:[(0,v.jsx)(We.Z,{id:"applyOptions",size:"sm",variant:"light",style:{margin:"5px"},className:"button",onClick:()=>{e(be.save(n.items)),r()},children:"OK"}),(0,v.jsx)(We.Z,{id:"cancelOptions",size:"sm",variant:"light",style:{margin:"5px",float:"left"},className:"button",onClick:r,children:"\u041e\u0442\u043c\u0435\u043d\u0430"}),(0,v.jsx)(We.Z,{id:"defaultOptions",size:"sm",variant:"light",style:{margin:"5px",float:"right"},className:"button",onClick:()=>{a((0,Q.Z)((0,Q.Z)({},n),{},{items:Object.assign({},je.items)}))},children:"\u0421\u0431\u0440\u043e\u0441\u0438\u0442\u044c \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438"})]})]})},rs=()=>(0,v.jsx)(De.Z,{children:(0,v.jsxs)(h.Z5,{children:[(0,v.jsx)(h.AW,{path:"/",element:(0,v.jsx)(Ht,{})}),(0,v.jsx)(h.AW,{path:"/index.php",element:(0,v.jsx)(Ht,{})}),(0,v.jsx)(h.AW,{path:"/topic.php",element:(0,v.jsx)(Gt,{})}),(0,v.jsx)(h.AW,{path:"/options.php",element:(0,v.jsx)(as,{})})]})}),is=()=>(0,v.jsxs)("footer",{className:"flex-row navbar-footer",children:[(0,v.jsx)("a",{href:"".concat(A,"/rules.php"),children:"\u041f\u0440\u0430\u0432\u0438\u043b\u0430"}),(0,v.jsx)("span",{className:"separator",children:"|"}),(0,v.jsx)("a",{href:"".concat(A,"/about.php"),children:"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435"}),(0,v.jsx)("span",{className:"separator",children:"|"}),(0,v.jsxs)("b",{children:[(0,v.jsx)("a",{href:"".concat(A,"/ad.php"),children:"\u0420\u0435\u043a\u043b\u0430\u043c\u0430 \u043d\u0430 \u0441\u0430\u0439\u0442\u0435"})," "]}),(0,v.jsx)("span",{className:"separator",children:"|"}),(0,v.jsx)("a",{href:"".concat(A,"/find.php"),children:"\u041f\u043e\u0438\u0441\u043a"}),(0,v.jsx)("span",{className:"separator",children:"|"}),(0,v.jsx)("a",{rel:"nofollow",href:"".concat(A,"/sections_list.php"),children:"\u0421\u0435\u043a\u0446\u0438\u0438"}),(0,v.jsx)("span",{className:"separator",children:"|"}),(0,v.jsx)("a",{rel:"nofollow",href:"".concat(A,"/rating.php"),children:"\u0420\u0435\u0439\u0442\u0438\u043d\u0433"}),(0,v.jsx)("span",{className:"separator",children:"|"}),(0,v.jsx)("a",{href:"http://kb.mista.ru",children:"\u041a\u043d\u0438\u0433\u0430 \u0437\u043d\u0430\u043d\u0438\u0439"}),(0,v.jsx)("span",{className:"separator",children:"|"}),(0,v.jsx)("a",{href:"http://wiki.mista.ru",children:"\u0412\u0438\u043a\u0438-\u043c\u0438\u0441\u0442\u0430 (\u041a\u04172)"}),(0,v.jsx)("span",{className:"separator",children:"|"}),(0,v.jsx)("a",{rel:"nofollow",href:"http://m.mista.ru/",children:"\u041c\u043e\u0431\u0438\u043b\u044c\u043d\u0430\u044f"}),(0,v.jsx)("span",{className:"separator",children:"|"}),(0,v.jsx)("a",{href:"".concat(A,"/archive.php"),children:"\u0410\u0440\u0445\u0438\u0432"}),(0,v.jsx)("span",{className:"separator",children:"|"}),(0,v.jsx)("a",{href:"".concat(A,"/moders.php"),children:"\u041c\u043e\u0434\u0435\u0440\u0430\u0442\u043e\u0440\u044b"}),(0,v.jsx)("span",{className:"separator",children:"|"}),(0,v.jsx)("a",{href:"".concat(A,"/users_gallery.php"),children:"\u0413\u0430\u043b\u0435\u0440\u0435\u044f"}),(0,v.jsx)("span",{className:"separator",children:"|"}),(0,v.jsx)("a",{href:"".concat(A,"/ban_list.php"),children:"\u0411\u0430\u043d\u044b"}),(0,v.jsx)("span",{className:"separator",children:"|"}),(0,v.jsx)("span",{children:"18+"})]});var os=s(9962),ls=s.n(os);const cs=e=>{let{children:t,closeWindow:s}=e;return(0,v.jsxs)("div",{className:"tooltip-header",children:[t,(0,v.jsxs)("div",{className:"tooltip-close",onClick:s,onTouchEnd:s,children:[(0,v.jsx)("i",{className:"fa fa-angle-right","aria-hidden":"true"}),(0,v.jsx)("i",{className:"fa fa-angle-left","aria-hidden":"true",style:{marginLeft:"-2px"}})]})]})},ds=e=>{let{children:t,onScroll:s}=e,n=0;return(0,v.jsx)("div",{className:"tooltip-text",onTouchStart:e=>{n=e.nativeEvent.changedTouches[0].clientX},onTouchEnd:e=>{if(!s)return;let t=e.nativeEvent.changedTouches[0].clientX;Math.abs(t-n)>100&&s(-t+n)},children:t})},us=e=>{let{tooltip:t,zIndex:s,children:n}=e;const a=ae(Ie),{coords:r}=t;let i,l;window.innerWidth<=768?(i="y",l={top:r.y,left:5}):(i="both",l={top:r.y,left:Math.min(r.x,window.innerWidth-670)});let[c,d]=o.Children.toArray(n);return(0,v.jsx)(ls(),{axis:i,handle:".tooltip-header",defaultClassNameDragging:"dragging",children:(0,v.jsxs)("div",{className:"tooltip-window",style:(0,Q.Z)({},l),children:[(0,v.jsx)(cs,{closeWindow:()=>{a.close(t.keys)},children:c.props.children}),(0,v.jsx)(ds,{children:d.props.children})]})},s)},hs=e=>{let{tooltip:t}=e;const{keys:s}=t,{data:n,isPending:a,isError:r,error:o}=(e=>{let{topicId:t,number:s}=e;const n=(0,i.NL)();return(0,y.a)({queryKey:[ee.TopicMessageData,t,s],queryFn:async()=>{const e=Pe(n,t);if(e){if(0===s)return e.item0;{const t=e.list.find((e=>e.n===s));if(t)return t}}const a=await z(t,s);if(void 0===a)throw new Error("\u0421\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435 ".concat(s," \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e"));return a},refetchOnWindowFocus:!1})})({topicId:s.topicId,number:s.number});return a?null:(0,v.jsxs)(us,{tooltip:t,children:[(0,v.jsx)(cs,{children:r?(0,v.jsx)("b",{children:"\u041e\u0448\u0438\u0431\u043a\u0430"}):(0,v.jsx)(Dt,{data:n,isAuthor:!1,isYou:!1,isTooltip:!0})}),(0,v.jsx)(ds,{children:(0,v.jsx)(Ot,{n:null===n||void 0===n?void 0:n.n,vote:null===n||void 0===n?void 0:n.vote,html:r?o.message:n.text,topicId:s.topicId,topicDate:null===n||void 0===n?void 0:n.time,style:{maxHeight:"min(550px, 80vh)",overflowY:"auto"}})})]})},ps=()=>{const e=ne((e=>e.tooltips.items)),t=ae(Ie),s=(0,o.useRef)(null);return(0,f.t$)(s,(()=>{t.closeAll()})),(0,v.jsx)("div",{ref:s,children:e.map((e=>(0,v.jsx)(hs,{tooltip:e},e.hash)))})},ms=()=>{const e=ne((e=>e.options.items.theme));return(0,o.useLayoutEffect)((()=>{document.body.setAttribute("data-theme",e)}),[e]),(0,v.jsxs)(l.UT,{children:[(0,v.jsx)(Oe,{}),(0,v.jsx)(rs,{}),(0,v.jsx)(is,{}),(0,v.jsx)(ps,{})]})};var xs=s(6994);const gs=new r.S,fs=e=>{let{store:t}=e;return(0,v.jsx)(i.aH,{client:gs,children:(0,v.jsx)(a.zt,{store:t,children:(0,v.jsx)(xs.r,{loading:null,persistor:Ve,children:(0,v.jsx)(ms,{})})})})},vs=document.getElementById("root");(0,n.s)(vs).render((0,v.jsx)(fs,{store:ze}))}},t={};function s(n){var a=t[n];if(void 0!==a)return a.exports;var r=t[n]={exports:{}};return e[n].call(r.exports,r,r.exports,s),r.exports}s.m=e,(()=>{var e=[];s.O=(t,n,a,r)=>{if(!n){var i=1/0;for(d=0;d<e.length;d++){n=e[d][0],a=e[d][1],r=e[d][2];for(var o=!0,l=0;l<n.length;l++)(!1&r||i>=r)&&Object.keys(s.O).every((e=>s.O[e](n[l])))?n.splice(l--,1):(o=!1,r<i&&(i=r));if(o){e.splice(d--,1);var c=a();void 0!==c&&(t=c)}}return t}r=r||0;for(var d=e.length;d>0&&e[d-1][2]>r;d--)e[d]=e[d-1];e[d]=[n,a,r]}})(),s.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return s.d(t,{a:t}),t},(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;s.t=function(n,a){if(1&a&&(n=this(n)),8&a)return n;if("object"===typeof n&&n){if(4&a&&n.__esModule)return n;if(16&a&&"function"===typeof n.then)return n}var r=Object.create(null);s.r(r);var i={};e=e||[null,t({}),t([]),t(t)];for(var o=2&a&&n;"object"==typeof o&&!~e.indexOf(o);o=t(o))Object.getOwnPropertyNames(o).forEach((e=>i[e]=()=>n[e]));return i.default=()=>n,s.d(r,i),r}})(),s.d=(e,t)=>{for(var n in t)s.o(t,n)&&!s.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),s.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e={179:0};s.O.j=t=>0===e[t];var t=(t,n)=>{var a,r,i=n[0],o=n[1],l=n[2],c=0;if(i.some((t=>0!==e[t]))){for(a in o)s.o(o,a)&&(s.m[a]=o[a]);if(l)var d=l(s)}for(t&&t(n);c<i.length;c++)r=i[c],s.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return s.O(d)},n=self.webpackChunkreact_mista=self.webpackChunkreact_mista||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var n=s.O(void 0,[216],(()=>s(906)));n=s.O(n)})();
//# sourceMappingURL=main.c063cf9e.js.map