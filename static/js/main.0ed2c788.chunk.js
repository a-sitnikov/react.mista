(this["webpackJsonpreact.mista"]=this["webpackJsonpreact.mista"]||[]).push([[0],{114:function(e,t,n){},118:function(e,t,n){},120:function(e,t,n){},121:function(e,t,n){},122:function(e,t,n){},123:function(e,t,n){},132:function(e,t,n){},135:function(e,t,n){},136:function(e,t,n){},137:function(e,t,n){},142:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(25),s=n.n(c),i=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function o(e){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var t=e.installing;t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}})).catch((function(e){console.error("Error during service worker registration:",e)}))}var l=n(17),u=n(12),p=n(20),h=n(47),d=(n(97),n(21)),j=n(4),f=n.n(j),b=n(14),m=n(81),O=n.n(m);var v=function(e){try{return JSON.parse(e)}catch(t){}try{return e=e.replace(/\\</g,"<").replace(/\\>/g,">").replace(/\\&/g,"&").replace(/\\'/g,"'").replace(/\\"/g,"").replace(/ "/g,' \\"').replace(/""/g,'\\""').replace(/\t/g,"\\t").replace(/"(\.| |\?)/g,'\\"$1'),JSON.parse(e)}catch(t){return console.error(t.message),console.log(e),{}}},x=function(e){return Math.min(Math.ceil(e/100),10)||1},g=function(e){return e?e.map((function(e){return"string"===typeof e?e:"br"===e.type?"<br>":"Connect(LinkToPost)"===e.type.displayName||"Connect(t)"===e.type.displayName?e.props.number:(console.log(e),e)})):e},y=localStorage.getItem("domain")||"https://forum.mista.ru",w=localStorage.getItem("urlTopicsList")||"api/topic.php",k=localStorage.getItem("urlTopicInfo")||"ajax_gettopic.php",T=localStorage.getItem("urlTopicMessages")||"api/message.php",C=localStorage.getItem("urlLogin")||"users.php?action=do_enter",N=localStorage.getItem("urlLogout")||"users.php",S=localStorage.getItem("urlCookies")||"ajax_cookie.php",I=localStorage.getItem("urlSections")||"ajax_getsectionslist.php",E=localStorage.getItem("urlNewMessage")||"topic.php?id=:id&page=1",_=localStorage.getItem("urlNewTopic")||"index.php",P=localStorage.getItem("urlAddBookmark")||"ajax_addbookmark.php",L=(localStorage.getItem("urlSearch"),function(){var e=Object(b.a)(f.a.mark((function e(t){var n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,J(w,t);case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),R={id:"",text:"",answers_count:""},A=function(){var e=Object(b.a)(f.a.mark((function e(t){var n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,J(k,t);case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),M=function(){var e=Object(b.a)(f.a.mark((function e(t){var n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,J(T,t);case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),F=function(){var e=Object(b.a)(f.a.mark((function e(t,n){var r,a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,M({id:t,from:n,to:+n+1});case 2:return(r=e.sent)&&r.length>0&&(a=r.find((function(e){return e.n===String(n)}))),e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),D=function(){var e=Object(b.a)(f.a.mark((function e(t){var n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A({id:String(t)});case 2:return n=e.sent,e.abrupt("return",+n.answers_count);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),W=function(){var e=Object(b.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(y,"/").concat(C),{method:"POST",body:H("",{user_name:t.username,user_password:t.password}),mode:"no-cors",credentials:"include",headers:{Accept:"text/html,application/xhtml+xml,application/xml","Content-Type":"application/x-www-form-urlencoded"},redirect:"follow"});case 2:e.sent;case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),V=function(){var e=Object(b.a)(f.a.mark((function e(){var t;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t="".concat(y,"/").concat(N,"?action=exit"),e.next=3,fetch(t,{mode:"no-cors",credentials:"include"});case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),B=function(){var e=Object(b.a)(f.a.mark((function e(){var t;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Y(S);case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),U=function(){var e=Object(b.a)(f.a.mark((function e(){var t;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Y(I);case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),G=function(){var e=Object(b.a)(f.a.mark((function e(t){var n,r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=E.replace(":id",t.topic_id),e.next=3,fetch("".concat(y,"/").concat(n),{method:"POST",body:H("",t),mode:"no-cors",credentials:"include",headers:{Accept:"text/html,application/xhtml+xml,application/xml","Content-Type":"application/x-www-form-urlencoded"},redirect:"follow"});case 3:return r=e.sent,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),K=function(){var e=Object(b.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(y,"/").concat(_),{method:"POST",body:H("",t),mode:"no-cors",credentials:"include",headers:{"Content-Type":"application/x-www-form-urlencoded"}});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),z=function(){var e=Object(b.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(y,"/").concat(P),{method:"POST",body:H("",t),mode:"no-cors",credentials:"include"});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),H=function(e,t){if(!t)return"";var n=[];for(var r in t)void 0!==t[r]&&n.push(r+"="+t[r]);return n.length>0?e+n.join("&"):""},Y=function(){var e=Object(b.a)(f.a.mark((function e(t,n){var r,a,c,s;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="".concat(y,"/").concat(t).concat(H("?",n)),e.next=3,O()(r);case 3:return a=e.sent,e.next=6,a.json();case 6:if("string"===typeof(c=e.sent))try{s=JSON.parse(c)}catch(i){s=v(c)}else s=c;return e.abrupt("return",s);case 9:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),J=function(){var e=Object(b.a)(f.a.mark((function e(t,n,r){var a,c,s,i;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a="".concat(y,"/").concat(t).concat(H("?",n)),e.next=3,fetch(a,r);case 3:return c=e.sent,e.next=6,c.json();case 6:if("string"===typeof(s=e.sent))try{i=JSON.parse(s)}catch(o){i=v(s)}else i=s;return e.abrupt("return",i);case 9:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),X=Object(d.a)("REQUEST_TOPICS_LIST"),Q=Object(d.a)("RECEIVE_TOPICS_LIST",(function(e){return{payload:{list:e},error:!1}})),q=Object(d.a)("RECEIVE_TOPICS_LIST",(function(e){return{payload:e,error:!0}})),$=Object(d.a)("CLEAR_TOPICS_LIST"),Z=Object(d.a)("TOGGLE_PREVIEW",(function(e){return{payload:{id:e}}})),ee=function(e){return function(t,n){if(function(e){var t=e.topicsList;return!t||!t.isFetching}(n()))return t(function(e){return function(){var t=Object(b.a)(f.a.mark((function t(n,r){var a,c,s,i,o,l;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n(X()),a=e.page||1,c={},(s=+r().options.items.topicsPerPage)>99&&(s=99),i=a*s,c.topics=i,e.section&&(c.section_short_name=e.section),e.forum&&(c.forum=e.forum),e.user_id&&(c.user_id=e.user_id),e.mytopics&&(c.mytopics=e.mytopics),t.prev=11,t.next=14,L(c);case 14:o=t.sent,l=o.slice(-s),n(Q(l)),t.next=23;break;case 19:t.prev=19,t.t0=t.catch(11),n(q(t.t0)),console.error(t.t0);case 23:case"end":return t.stop()}}),t,null,[[11,19]])})));return function(e,n){return t.apply(this,arguments)}}()}(e))}},te=Object(d.b)({isFetching:!1,items:[]},(function(e){e.addCase(X,(function(e){e.isFetching=!0})).addCase(Q,(function(e,t){t.error?e.error=t.payload.toString():(e.items=t.payload.list,delete e.error),e.lastUpdated=(new Date).getTime(),e.isFetching=!1})).addCase($,(function(e){e.items=[],e.isFetching=!1,delete e.error,delete e.lastUpdated})).addCase(Z,(function(e,t){var n=e.items.slice(),r=n.findIndex((function(e){return e.id===t.topicId})),a=Object.assign({},n[r]);a.showPreview=!a.showPreview,n[r]=a,e.items=n}))})),ne=n(2),re={isFetching:!1,info:R,items:[]},ae=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:re,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"REQUEST_TOPIC":return Object(ne.a)(Object(ne.a)({},e),{},{isFetching:!0,error:null});case"RECEIVE_TOPIC":return Object(ne.a)(Object(ne.a)({},e),{},{isFetching:!1,info:t.info,item0:t.item0,items:t.items,lastUpdated:t.receivedAt,error:null});case"RECEIVE_TOPIC_FAILED":return Object(ne.a)(Object(ne.a)({},e),{},{isFetching:!1,lastUpdated:t.receivedAt,error:t.error});case"REQUEST_NEW_MESSAGES":return Object(ne.a)(Object(ne.a)({},e),{},{isFetching:!0});case"RECEIVE_NEW_MESSAGES":var n=e.info;return t.items.length>0&&(n.answers_count=t.items[t.items.length-1].n),Object(ne.a)(Object(ne.a)({},e),{},{isFetching:!1,items:e.items.concat(t.items),info:n,lastUpdated:t.receivedAt});case"CLOSE_TOPIC":return Object(ne.a)(Object(ne.a)({},e),{},{items:[],info:R,item0:null,lastUpdated:null,error:null});default:return e}},ce={isFetching:!1,logged:void 0},se=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ce,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOGIN_START":return Object(ne.a)(Object(ne.a)({},e),{},{isFetching:!0});case"LOGIN_COMPLETE":return Object(ne.a)(Object(ne.a)(Object(ne.a)({},e),t.data),{},{isFetching:!1,logged:!0,error:void 0});case"LOGIN_FAILED":return{isFetching:!1,logged:!1,error:t.error};case"LOGOUT_COMPLETE":return Object(ne.a)(Object(ne.a)({},e),{},{userid:void 0,username:void 0,hashkey:void 0,logged:!1});default:return e}},ie=Object(d.a)("REQUEST_SECTIONS"),oe=Object(d.a)("RECEIVE_SECTIONS",(function(e){return{payload:{list:e},error:!1}})),le=Object(d.a)("RECEIVE_SECTIONS",(function(e){return{payload:e,error:!0}})),ue=function(){return function(e,t){if(function(e){var t=e.sections;return!t||!t.isFetching&&!(t.items.length>0)}(t()))return e(function(){var e=Object(b.a)(f.a.mark((function e(t){var n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t(ie),e.prev=1,e.next=4,U();case 4:n=e.sent,t(oe(n)),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(1),t(le(e.t0)),console.error(e.t0);case 12:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}())}},pe=Object(d.b)({isFetching:!1,items:[],tree:{},map:{}},(function(e){e.addCase(ie,(function(e){e.isFetching=!0})).addCase(oe,(function(e,t){if(t.error)e.error=t.payload.toString();else{var n={};t.payload.list.forEach((function(e){n[e.shortn]=e.fulln})),e.items=t.payload.list,e.tree=(r=e.items,a=function(e){return e.forum},r.reduce((function(e,t){var n=a(t);return e[n]||(e[n]=[]),e[n].push(t),e}),{})),e.map=n,delete e.error}var r,a;e.lastUpdated=(new Date).getTime(),e.isFetching=!1}))})),he={isFetching:!1},de=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:he,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_BOOKMARK_START":return Object(ne.a)(Object(ne.a)({},e),{},{isFetching:!0});case"ADD_BOOKMARK_COMPLETE":case"ADD_BOOKMARK_FAIL":return Object(ne.a)(Object(ne.a)({},e),{},{isFetching:!1});default:return e}},je={isFetching:!1,section:null,text:"",subject:"",forum:"1C",isVoting:!1},fe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:je,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"POST_NEW_TOPIC_START":return Object(ne.a)(Object(ne.a)({},e),{},{isFetching:!0,error:void 0});case"POST_NEW_TOPIC_COMPLETE":return Object(ne.a)(Object(ne.a)({},e),{},{isFetching:!1});case"POST_NEW_TOPIC_ERROR":return Object(ne.a)(Object(ne.a)({},e),{},{isFetching:!1,error:t.error});case"NEW_TOPIC_SECTION":return Object(ne.a)(Object(ne.a)({},e),{},{section:t.section,forum:null==t.section?"":t.section.forum.toLowerCase()});case"NEW_TOPIC_TEXT":return Object(ne.a)(Object(ne.a)({},e),{},{text:t.text});case"NEW_TOPIC_SUBJECT":return Object(ne.a)(Object(ne.a)({},e),{},{subject:t.text});case"NEW_TOPIC_CLEAR":return Object(ne.a)(Object(ne.a)({},e),{},{text:"",subject:"",isVoting:!1});case"SHOW_VOTING":return Object(ne.a)(Object(ne.a)({},e),{},{isVoting:t.data});default:return e}},be={isFetching:!1,text:""},me=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:be,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"POST_NEW_MESSAGE_START":return Object(ne.a)(Object(ne.a)({},e),{},{isFetching:!0});case"POST_NEW_MESSAGE_COMPLETE":return Object(ne.a)(Object(ne.a)({},e),{},{isFetching:!1});case"NEW_MESSAGE_TEXT":return Object(ne.a)(Object(ne.a)({},e),{},{text:t.text});case"ADD_MESSAGE_TEXT":return Object(ne.a)(Object(ne.a)({},e),{},{text:e.text+t.text});default:return e}},Oe={items:[]},ve=function(){var e,t,n,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Oe,a=arguments.length>1?arguments[1]:void 0;switch(a.type){case"CREATE_TOOLTIP":t=r.items.slice(),e=JSON.stringify(a.keys);var c=t.findIndex((function(t){return t.hash===e}));return-1===c?t.push({i:0,keys:a.keys,hash:e,coords:a.coords}):((n=Object.assign({},t[c])).coords=a.coords,n.i+=1,t[c]=n),Object(ne.a)(Object(ne.a)({},r),{},{items:t});case"CLOSE_TOOLTIP":return e=JSON.stringify(a.keys),Object(ne.a)(Object(ne.a)({},r),{},{items:r.items.filter((function(t){return t.hash!==e}))});case"CLEAR_TOOLTIPS":return 0===r.items.length?r:Object(ne.a)(Object(ne.a)({},r),{},{items:[]});default:return r}},xe={items:{}},ge=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:xe,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SHOW_PREVIEW":return void 0===e[t.topicId]&&(e.items[t.topicId]={n:"0",id:t.topicId,text:"",user:"",userId:"",utime:"0",vote:0}),Object(ne.a)({},e);case"CLOSE_PREVIEW":return delete e.items[t.topicId],Object(ne.a)({},e);case"RECEIVE_PREVIEW_TEXT":return void 0===e.items[t.topicId]?e:(e.items[t.topicId]=t.message,Object(ne.a)({},e));default:return e}},ye={voteColors:["#FF1616","#1A861A","#0023FF","#FF6B18","#9B3A6E","#567655","#233345","#CC0000","#00CCCC","#0000CC"],items:{theme:"lightgray",topicsPerPage:"20",autoRefreshTopicsList:"false",autoRefreshTopicsListInterval:"60",autoRefreshTopic:"true",autoRefreshTopicInterval:"60",showTooltips:"true",tooltipDelay:"500",showTooltipOnTopicsList:"true",showTooltipOnPostLink:"true",showYoutubeVideoTitle:"true",replaceCatalogMista:"true",fixBrokenLinks:"true"}};function we(e,t){return window.localStorage.getItem(e)||t}var ke=function(e,t){switch(e||(e=function(){var e=ye;for(var t in e.items)e.items[t]=we(t,e.items[t]);return e}()),t.type){case"READ_OPTIONS":var n=Object.assign({},ye.items);for(var r in n)n[r]=we(r,ye.items[r]);return Object(ne.a)(Object(ne.a)({},e),{},{items:n});case"SAVE_OPTIONS":for(var a in t.options)window.localStorage.setItem(a,String(t.options[a]));return Object(ne.a)(Object(ne.a)({},e),{},{items:t.options});default:return e}},Te=Object(p.b)({topicsList:te,sections:pe,topic:ae,login:se,bookmark:de,newTopic:fe,newMessage:me,tooltips:ve,topicPreview:ge,options:ke}),Ce=(n(99),n(6)),Ne=n(7),Se=n(9),Ie=n(8),Ee=n(52),_e=n(67),Pe=n(33),Le=n(27),Re=n.n(Le),Ae=n(15),Me=n(50),Fe=n(34),De=n(63),We=n(49),Ve=n(82),Be=(n(114),n(1)),Ue=function(){var e=Object(r.useState)("\u042f\u043d\u0434\u0435\u043a\u0441"),t=Object(Me.a)(e,2),n=t[0],a=t[1],c=Object(r.useState)(""),s=Object(Me.a)(c,2),i=s[0],o=s[1];function l(){var e;"\u042f\u043d\u0434\u0435\u043a\u0441"===n?e="https://www.yandex.ru/search/?text=".concat(i,"&site=forum.mista.ru"):"Google"===n&&(e="https://www.google.ru/search?q=".concat(i,"+site:forum.mista.ru")),window.open(e),o("")}return Object(Be.jsxs)(Fe.a,{size:"sm",children:[Object(Be.jsx)(Fe.a.Prepend,{children:Object(Be.jsxs)(Ve.a,{id:"search-engine",title:"",size:"sm",style:{marginRight:"2px"},className:"button",variant:"light",children:[Object(Be.jsx)(We.a.Item,{eventKey:"\u042f\u043d\u0434\u0435\u043a\u0441",onSelect:function(){return a("\u042f\u043d\u0434\u0435\u043a\u0441")},children:"\u042f\u043d\u0434\u0435\u043a\u0441"}),Object(Be.jsx)(We.a.Item,{eventKey:"Google",onSelect:function(){return a("Google")},children:"Google"})]})}),Object(Be.jsx)(De.a,{type:"text",placeholder:"".concat(n,": \u043f\u043e\u0438\u0441\u043a"),style:{marginRight:"4px",paddingRight:"27px"},className:"input",onKeyPress:function(e){"Enter"===e.key&&l()},onChange:function(e){return o(e.target.value)},value:i}),Object(Be.jsx)(Fe.a.Append,{style:{marginLeft:"-25px",marginTop:"auto",marginBottom:"auto",cursor:"pointer"},onClick:l,children:Object(Be.jsx)("i",{className:"fa fa-search input",style:{zIndex:1e3}})})]})},Ge=(n(118),function(e){Object(Se.a)(n,e);var t=Object(Ie.a)(n);function n(){var e;Object(Ce.a)(this,n);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return(e=t.call.apply(t,[this].concat(a))).onClick=function(t){var n=e.props,r=n.dispatch,a=n.location,c=Re.a.parse(a.search);r(ee(c))},e}return Object(Ne.a)(n,[{key:"render",value:function(){var e=[{name:"1\u0421",link:"".concat(window.hash,"/index.php?forum=1C")},{name:"IT",link:"".concat(window.hash,"/index.php?forum=IT")},{name:"JOB",link:"".concat(window.hash,"/index.php?forum=JOB")},{name:"LIFE",link:"".concat(window.hash,"/index.php?forum=LIFE")},{name:"Wiki",link:"https://wiki.mista.ru"},{name:"\u041a\u043d\u0438\u0433\u0430 \u0437\u043d\u0430\u043d\u0438\u0439",link:"https://kb.mista.ru"}].map((function(e,t){return Object(Be.jsx)(_e.a.Item,{children:Object(Be.jsx)(_e.a.Link,{href:e.link,children:e.name})},t)}));return Object(Be.jsxs)(Ee.a,{bg:"dark",variant:"dark",expand:"md",fixed:"top",children:[Object(Be.jsx)(Ee.a.Brand,{href:"".concat(window.hash),onClick:this.onClick,children:"React.Mista"}),Object(Be.jsx)(Ee.a.Toggle,{"aria-controls":"basic-navbar-nav"}),Object(Be.jsxs)(Ee.a.Collapse,{children:[Object(Be.jsx)(_e.a,{className:"mr-auto",children:e}),Object(Be.jsx)(Pe.a,{inline:!0,children:Object(Be.jsx)(Ue,{})})]})]})}}]),n}(r.Component)),Ke=Object(u.b)()(Object(Ae.f)(Ge)),ze=n(38),He=n(40),Ye=function(e){return{type:"LOGIN_COMPLETE",data:e}},Je=function(e){return{type:"LOGIN_FAILED",error:e}},Xe=function(e){var t=e.login;return!t||!t.isFetching},Qe=function(e){return function(){var e=Object(b.a)(f.a.mark((function e(t){var n,r,a,c,s;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t({type:"CHECK_LOGIN_START"}),e.prev=1,e.next=4,B();case 4:n=e.sent,e.next=11;break;case 7:return e.prev=7,e.t0=e.catch(1),t(Je(e.t0.message)),e.abrupt("return");case 11:a=(r=n).cookie,(c=r.session)&&c.user_id?("\u041d\u0435 \u0443\u043a\u0430\u0437\u0430\u043d\u043e \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435."===(s=(c.last_error||"").trim())&&(s=""),t(Ye({error:s,userid:c.user_id,username:c.user_name,hashkey:a.entr_hash}))):t(Je(""));case 13:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t){return e.apply(this,arguments)}}()},qe=function(e){return function(t,n){if(Xe(n()))return t(function(e){return function(){var t=Object(b.a)(f.a.mark((function t(n){return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n({type:"LOGIN_START"}),t.prev=1,t.next=4,W({username:encodeURIComponent(e.username),password:encodeURIComponent(e.password)});case 4:n(Qe()),t.next=11;break;case 7:t.prev=7,t.t0=t.catch(1),console.error("Login error :",t.t0),n(Je(t.t0.message));case 11:case"end":return t.stop()}}),t,null,[[1,7]])})));return function(e){return t.apply(this,arguments)}}()}(e))}},$e=a.a.forwardRef((function(e,t){var n=e.children,r=e.onClick;return Object(Be.jsx)("span",{ref:t,style:{cursor:"pointer"},className:"link",onClick:function(e){e.preventDefault(),r(e)},children:n})})),Ze=function(e){Object(Se.a)(n,e);var t=Object(Ie.a)(n);function n(e){var r;return Object(Ce.a)(this,n),(r=t.call(this,e)).onMenuSelect=function(e,t){"exit"===e&&r.onLogout(t)},r.onLogout=r.onLogout.bind(Object(He.a)(r)),r}return Object(Ne.a)(n,[{key:"onLogout",value:function(e){e.preventDefault(),(0,this.props.dispatch)(function(){var e=Object(b.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t({type:"LOGOUT_START"});try{V()}catch(n){console.error(n)}t({type:"LOGOUT_COMPLETE"}),t(Qe());case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}},{key:"render",value:function(){var e=this.props,t=e.userId,n=e.userName;return Object(Be.jsx)("div",{style:{float:"left"},children:Object(Be.jsxs)(We.a,{id:"dropdown-custom-menu",onSelect:this.onMenuSelect,children:[Object(Be.jsx)("span",{children:"\u041f\u0440\u0438\u0432\u0435\u0442, "}),Object(Be.jsxs)(We.a.Toggle,{as:$e,bsRole:"toggle",children:[n," \u25bc"]}),Object(Be.jsxs)(We.a.Menu,{children:[Object(Be.jsx)(We.a.Item,{eventKey:"profile",href:"".concat(y,"/users.php?id=").concat(t),children:"\u041f\u0440\u043e\u0444\u0438\u043b\u044c"}),Object(Be.jsx)(We.a.Item,{eventKey:"myTopics",href:"".concat(window.hash,"/index.php?user_id=").concat(t),children:"\u041c\u043e\u0438 \u0442\u0435\u043c\u044b"}),Object(Be.jsx)(We.a.Divider,{}),Object(Be.jsx)(We.a.Item,{eventKey:"options",href:"".concat(window.hash,"/options.php"),children:"\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438"}),Object(Be.jsx)(We.a.Divider,{}),Object(Be.jsx)(We.a.Item,{eventKey:"exit",children:"\u0412\u044b\u0445\u043e\u0434"})]})]})})}}]),n}(r.Component),et=Object(u.b)()(Object(Ae.f)(Ze)),tt=n(85),nt=function(e){Object(Se.a)(n,e);var t=Object(Ie.a)(n);function n(e){var r;return Object(Ce.a)(this,n),(r=t.call(this,e)).onLogin=function(e){e.preventDefault();var t=r.props.dispatch,n={username:r.username.current.value,password:r.password.current.value};t(qe(n))},r.username=a.a.createRef(),r.password=a.a.createRef(),r}return Object(Ne.a)(n,[{key:"render",value:function(){return Object(Be.jsxs)("div",{children:[Object(Be.jsxs)("form",{name:"enterform",className:"flex-row",style:{flexWrap:"wrap"},children:[Object(Be.jsx)(De.a,{type:"text",placeholder:"\u0418\u043c\u044f",ref:this.username,size:"sm",style:{marginRight:"5px",flex:"0 1 300px"}}),Object(Be.jsx)(De.a,{type:"password",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",maxLength:"20",autoComplete:"off",ref:this.password,size:"sm",style:{marginRight:"5px",flex:"0 1 300px"}}),Object(Be.jsx)(tt.a,{size:"sm",variant:"light",onClick:this.onLogin,children:"\u0412\u043e\u0439\u0442\u0438"})]}),Object(Be.jsxs)("p",{style:{margin:"0px"},children:["\u0412\u043e\u0439\u0442\u0438 \u043c\u043e\u0436\u043d\u043e \u043d\u0430 \u0441\u0430\u0439\u0442\u0435 ",Object(Be.jsx)("a",{href:"https://forum.mista.ru/",children:"forum.mista.ru"})]}),Object(Be.jsx)("a",{rel:"nofollow",href:"https://forum.mista.ru/user_registration.php",children:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"}),Object(Be.jsx)("span",{style:{margin:"5px"},children:"|"}),Object(Be.jsx)("a",{rel:"nofollow",href:"https://forum.mista.ru/remember_password.php",children:"\u0417\u0430\u0431\u044b\u043b\u0438 \u043f\u0430\u0440\u043e\u043b\u044c?"})]})}}]),n}(r.Component),rt=Object(u.b)((function(e){return e.login}))(nt),at=(n(120),function(e){return e.text?Object(Be.jsx)("div",{className:"error",dangerouslySetInnerHTML:{__html:e.text}}):null}),ct=function(e){Object(Se.a)(n,e);var t=Object(Ie.a)(n);function n(){return Object(Ce.a)(this,n),t.apply(this,arguments)}return Object(Ne.a)(n,[{key:"componentDidMount",value:function(){(0,this.props.dispatch)((function(e,t){if(Xe(t()))return e(Qe())}))}},{key:"render",value:function(){var e,t=this.props,n=t.logged,a=t.userid,c=t.username,s=t.error,i=t.dispatch;return e=!0===n?Object(Be.jsx)(et,{dispatch:i,userId:a,userName:c}):!1===n?Object(Be.jsx)(rt,{}):null,Object(Be.jsxs)(r.Fragment,{children:[e,s&&Object(Be.jsx)(at,{text:s})]})}}]),n}(r.Component),st=Object(u.b)((function(e){return e.login}))(ct),it=function(e){Object(Se.a)(n,e);var t=Object(Ie.a)(n);function n(){var e;Object(Ce.a)(this,n);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return(e=t.call.apply(t,[this].concat(a))).onSelect=function(t){var n=e.props,r=n.items,a=n.onChange;if(a){var c=t.currentTarget.value,s=r.filter((function(e){return e.shortn===c}));s.length>0?a(t,s[0]):a(t,null)}},e}return Object(Ne.a)(n,[{key:"componentDidMount",value:function(){(0,this.props.dispatch)(ue())}},{key:"render",value:function(){var e=this.props,t=e.id,n=e.tree,r=e.defaultValue,a=e.selected,c=e.style,s=e.size,i=[];for(var o in n){var l=Object(Be.jsx)("optgroup",{label:o,children:n[o].map((function(e,t){return Object(Be.jsx)("option",{value:e.shortn,children:e.fulln},e.id)}))},o);i.push(l)}return Object(Be.jsxs)(Pe.a.Control,{as:"select",onChange:this.onSelect,value:a,style:c,className:"input",size:s,id:t,children:[Object(Be.jsx)("option",{value:"",children:r}),i]})}}]),n}(r.Component),ot=Object(u.b)((function(e){var t=e.sections;return{items:t.items,tree:t.tree}}))(it),lt=function(e){Object(Se.a)(n,e);var t=Object(Ie.a)(n);function n(){var e;Object(Ce.a)(this,n);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return(e=t.call.apply(t,[this].concat(a))).onSectionSelect=function(t,n){n?e.props.history.push("/index.php?section=".concat(n.shortn)):e.props.history.push("/")},e}return Object(Ne.a)(n,[{key:"componentDidMount",value:function(){(0,this.props.dispatch)(ue())}},{key:"render",value:function(){var e=this.props.location,t=Re.a.parse(e.search);return Object(Be.jsxs)("div",{className:"flex-row",children:[Object(Be.jsx)("div",{className:"user-td",children:Object(Be.jsx)(st,{})}),Object(Be.jsx)("div",{className:"section-td",style:{marginLeft:"auto"},children:Object(Be.jsx)(ot,{defaultValue:"--\u0412\u0441\u0435 \u0441\u0435\u043a\u0446\u0438\u0438--",selected:t.section,onChange:this.onSectionSelect,size:"sm"})})]})}}]),n}(r.Component),ut=Object(u.b)()(Object(Ae.f)(lt)),pt=n(32),ht=n(10),dt=n.n(ht),jt=function(e){var t=e.answ,n=e.topicId,r=[];if(t>100)for(var a=x(t),c=1;c<=a;c++){var s="/topic.php?id=".concat(n,"&page=").concat(c),i=void 0;i=c>3&&c<a?"\u2022":c,r.push(Object(Be.jsx)(l.c,{className:"agh",style:{margin:"3px"},to:s,children:i},c))}if(t>20){var o="/topic.php?id=".concat(n,"&page=last20#F");r.push(Object(Be.jsx)(l.c,{className:"agh",style:{margin:"3px"},to:o,children:"\xbb"},"last20"))}return Object(Be.jsx)("span",{className:"topic-pages",children:r})},ft=function(e){Object(Se.a)(n,e);var t=Object(Ie.a)(n);function n(){return Object(Ce.a)(this,n),t.apply(this,arguments)}return Object(Ne.a)(n,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e,t=this.props,n=t.data,r=t.login,a="/topic.php?id=".concat(n.id),c=dt()("agb","mr5",{bold:n.answ>=100,mytopics:n.user0===r.username});1===n.is_voting&&(e=Object(Be.jsx)("span",{className:"agh separator",children:"[\xb1]"}));var s,i,o,u="/index.php?section=".concat(n.sect2);n.sect1&&(s=Object(Be.jsxs)("span",{className:"topic-section",children:[Object(Be.jsx)("span",{className:"agh",style:{margin:"0px 5px"},children:"/"}),Object(Be.jsx)(l.c,{rel:"nofollow",className:"agh",to:u,children:n.sect1},"1")]}));var p=n.text;return n.closed&&(i=Object(Be.jsx)("span",{className:"agh",children:"\xd8"})),1===n.down&&(o=Object(Be.jsx)("span",{className:"agh",children:"\u2193"})),"job"===n.sect2&&"JOB"!==p.substr(0,3)?p="JOB: "+p:"life"===n.forum&&"OFF"!==p.substr(0,3)?p="OFF: "+p:"v7"===n.sect2&&"v7"!==p.substr(0,2)&&(p="v7: "+p),Object(Be.jsxs)("div",{className:"cell-title",children:[Object(Be.jsx)(l.c,{to:a,className:c,dangerouslySetInnerHTML:{__html:p},style:{overflowWrap:"anywhere"}}),e,Object(Be.jsx)(jt,{answ:n.answ,topicId:n.id}),i,o,s]})}}]),n}(r.Component),bt=Object(u.b)((function(e){return{login:e.login,topicPreview:e.topicPreview}}))(ft),mt=function(e){return function(t){t({type:"CLOSE_TOOLTIP",keys:e})}},Ot=function(e){Object(Se.a)(n,e);var t=Object(Ie.a)(n);function n(e){var r;Object(Ce.a)(this,n),(r=t.call(this,e)).onMouseOver=function(e){e.persist();var t=r.props.tooltipDelay;r.timer=setTimeout((function(){return r.showToolTip(e)}),+t)},r.onClick=function(e){e.stopPropagation(),clearTimeout(r.timer),r.showToolTip(e)},r.onMouseOut=function(e){clearTimeout(r.timer)},r.showToolTip=function(e){var t=r.props,n=t.topicId,a=t.number;(0,t.dispatch)(function(e,t){return function(){var n=Object(b.a)(f.a.mark((function n(r){return f.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:"TOPIC"!==e.type&&"TOPIC_PREVIEW"!==e.type||r({type:"CREATE_TOOLTIP",keys:e,coords:t});case 1:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()}({type:t.isPreview?"TOPIC_PREVIEW":"TOPIC",topicId:n,number:a},{x:e.pageX,y:e.pageY-50}))};var a=r.props,c=a.children,s=a.number;return r.state=c?{text:g(c).join("")}:{text:String(s)},r}return Object(Ne.a)(n,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){e.children||this.setState({text:String(e.number)})}},{key:"componentDidMount",value:function(){var e=this;if(this.state.text.startsWith("http")){var t=this.props.topicId;A({id:t}).then((function(t){e.setState({text:t.text})}))}}},{key:"render",value:function(){var e=this.props,t=e.topicId,n=e.number,r=e.style,a=e.info,c=x(n),s="";return c>1&&(s="&page=".concat(c)),t!==a.id&&isNaN(this.state.text)?Object(Be.jsxs)("span",{children:[Object(Be.jsx)("a",{href:"".concat(window.hash,"/topic.php?id=").concat(t).concat(s,"#").concat(n),style:Object(ne.a)({},r),children:this.state.text})," ","(",Object(Be.jsx)("span",{onMouseOver:this.onMouseOver,onMouseOut:this.onMouseOut,onClick:this.onClick,className:"link",children:n}),")"]}):Object(Be.jsx)("span",{onMouseOver:this.onMouseOver,onMouseOut:this.onMouseOut,onClick:this.onClick,className:"link",style:Object(ne.a)({},r),children:this.state.text})}}]),n}(r.Component),vt=Object(u.b)((function(e){var t=e.topic;return{items:t.items,info:t.info,tooltipDelay:e.options.items.tooltipDelay}}))(Ot),xt=function(e){Object(Se.a)(n,e);var t=Object(Ie.a)(n);function n(){var e;Object(Ce.a)(this,n);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return(e=t.call.apply(t,[this].concat(a))).onClick=function(){var t=e.props,n=t.topicId;(0,t.dispatch)({type:"TOGGLE_PREVIEW",topicId:n})},e}return Object(Ne.a)(n,[{key:"render",value:function(){var e;return e=this.props.expanded?"-":"+",Object(Be.jsx)("div",{className:"cell-preview-link",onClick:this.onClick,children:Object(Be.jsx)("span",{children:e})})}}]),n}(r.Component),gt=Object(u.b)()(xt),yt=Object(u.b)((function(e){return{login:e.login,showTooltipOnTopicsList:e.options.items.showTooltipOnTopicsList}}))((function(e){var t=e.data,n=e.showTooltipOnTopicsList,r=new Date(1e3*+t.utime);return r=function(e){var t=new Date;return e.getDate()===t.getDate()&&e.getMonth()===t.getMonth()&&e.getFullYear()===t.getFullYear()}(r)?Object(pt.a)(r,"HH:MM"):Object(pt.a)(r,"dd.mm.yy"),Object(Be.jsxs)("div",{className:"topics-list-row",children:[Object(Be.jsx)("div",{className:"cell-forum",children:t.forum}),Object(Be.jsx)("div",{className:"cell-section",children:t.sect1}),Object(Be.jsxs)("div",{className:"cell-answ",children:[Object(Be.jsx)("i",{className:"fa fa-comments-o","aria-hidden":"true",style:{marginRight:"3px"}}),"true"===n?Object(Be.jsx)(vt,{topicId:t.id,number:t.answ,style:{color:"inherit"},isPreview:!0}):t.answ]}),Object(Be.jsx)(gt,{topicId:t.id,expanded:t.showPreview}),Object(Be.jsx)(bt,{data:t}),Object(Be.jsxs)("div",{className:"cell-author",children:[Object(Be.jsx)("i",{"aria-hidden":"true",className:"fa fa-user-circle",style:{marginRight:"3px"}}),t.user0]}),Object(Be.jsx)("div",{className:"cell-lastuser",children:Object(Be.jsxs)("div",{style:{display:"flex"},children:[Object(Be.jsx)("span",{className:"cell-lastuser-time",children:r}),Object(Be.jsx)("span",{className:"cell-lastuser-user",children:t.user})]})}),Object(Be.jsx)("div",{className:"cell-last20",children:Object(Be.jsx)(l.c,{to:"/topic.php?id=".concat(String(t.id),"&page=last20"),style:{color:"inherit",display:"block",width:"100%",textAlign:"center"},children:">"})})]})})),wt=n(148),kt=(n(121),function(e){var t,n=e.locationParams,r=e.baseUrl,a=e.maxPage,c=e.last20;t=n.page?"last20"===n.page?"last20":parseInt(n.page,10)||1:1;for(var s=[],i=1;i<=a;i++){var o=Object(ne.a)(Object(ne.a)({},n),{},{page:i}),l="".concat(window.hash,"/").concat(r)+H("?",o);s.push(Object(Be.jsx)(wt.a.Item,{active:t===i,href:l,children:i},i))}if(!0===c){var u=Object(ne.a)(Object(ne.a)({},n),{},{page:"last20"}),p="".concat(window.hash,"/").concat(r)+H("?",u);s.push(Object(Be.jsx)(wt.a.Item,{active:"last20"===t,href:p,children:"\xbb"},"last20"))}return Object(Be.jsx)(wt.a,{style:{margin:"0px"},children:s})}),Tt=n(86),Ct=function(e){return function(t,n){if(function(e){var t=e.newTopic;return!!t&&!t.isFetching}(n()))return t(Nt(e))}},Nt=function(e){return function(){var t=Object(b.a)(f.a.mark((function t(n){var r,a;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n({type:"POST_NEW_TOPIC_START"}),r={message_text:encodeURIComponent(e.text),topic_text:encodeURIComponent(e.subject),target_section:String(e.section),target_forum:e.forum.toLowerCase(),action:"new",rnd:Math.round(1e10*Math.random()),voting:e.isVoting?1:0},e.votingItems)for(a=0;a<e.votingItems.length;a++)r["section".concat(a+1)]=e.votingItems[a];return t.next=5,K(r);case 5:n({type:"POST_NEW_TOPIC_COMPLETE"}),e.onSuccess&&e.onSuccess();case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},St=n(147),It=(n(122),function(e){Object(Se.a)(n,e);var t=Object(Ie.a)(n);function n(e){var r;return Object(Ce.a)(this,n),(r=t.call(this,e)).onButtonCode1c=function(e){e.preventDefault();var t=r.textArea.current,n=t.selectionStart,a=t.selectionEnd,c=t.value,s=c.length,i="[1C]\n"+c.substring(n,a)+"\n[/1C]",o=c.substring(0,n)+i+c.substring(a,s),l=r.props;(0,l.dispatch)({type:l.formName+"_TEXT",text:o})},r.onVotingChange=function(e){(0,r.props.dispatch)({type:"SHOW_VOTING",data:e.currentTarget.checked})},r.onChange=function(e){var t=r.props;(0,t.dispatch)({type:t.formName+"_TEXT",text:e.currentTarget.value})},r.onKeyPress=function(e){if("Enter"===e.key&&e.ctrlKey){for(var t=e.currentTarget.parentElement;t&&"FORM"!==t.tagName.toUpperCase();)t=t.parentElement;t&&t.dispatchEvent(new Event("submit",{cancelable:!0,bubbles:!0}))}},r.textArea=a.a.createRef(),r}return Object(Ne.a)(n,[{key:"render",value:function(){var e=this.props,t=e.placeholder,n=e.showVoting,r=e.isVoting,a=e.isFetching,c=e.text;return Object(Be.jsxs)("div",{children:[Object(Be.jsx)(De.a,{as:"textarea",placeholder:t,cols:"70",rows:"3",value:c,onChange:this.onChange,onKeyPress:this.onKeyPress,ref:this.textArea,className:"text-editor input"}),Object(Be.jsxs)("div",{className:"flex-row",children:[Object(Be.jsxs)(St.a,{children:[Object(Be.jsx)(tt.a,{size:"sm",variant:"light",onClick:this.onButtonCode1c,style:{marginRight:"5px"},className:"button",children:"\u041a\u043e\u0434 1\u0421"}),Object(Be.jsx)(tt.a,{size:"sm",variant:"light",disabled:a,type:"submit",className:"button",children:a?"\u041e\u0442\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u0442\u0441\u044f":"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c"})]}),n&&Object(Be.jsx)(Pe.a.Check,{type:"checkbox",checked:r,onChange:this.onVotingChange,label:"\u0413\u043e\u043b\u043e\u0441\u043e\u0432\u0430\u043d\u0438\u0435",style:{margin:"auto 0px auto auto"}})]})]})}}]),n}(r.Component)),Et=Object(u.b)()(It),_t=(n(123),function(e){Object(Se.a)(n,e);var t=Object(Ie.a)(n);function n(){var e;Object(Ce.a)(this,n);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return(e=t.call.apply(t,[this].concat(a))).onSectionChange=function(t,n){var r=e.props.dispatch;e.currentSection=n,r({type:"NEW_TOPIC_SECTION",section:n})},e.onSubmit=function(t){t.preventDefault();var n=e.props,r=n.dispatch,a=n.newTopic;if(e.currentSection){var c=a.subject;if(c)if(a.text){var s={subject:c,text:a.text,section:e.currentSection.id,forum:e.currentSection.forum,isVoting:a.isVoting,votingItems:[],onSuccess:e.onSubmitSuccess};if(a.isVoting){s.votingItems=[];for(var i=1;i<=10;i++){var o=e.refs["vote".concat(i)].value;o&&s.votingItems.push(o)}}r(Ct(s))}else r({type:"POST_NEW_TOPIC_ERROR",error:"\u041d\u0435 \u0443\u043a\u0430\u0437\u0430\u043d\u043e \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435"});else r({type:"POST_NEW_TOPIC_ERROR",error:"\u041d\u0435 \u0443\u043a\u0430\u0437\u0430\u043d\u0430 \u0442\u0435\u043c\u0430"})}else r({type:"POST_NEW_TOPIC_ERROR",error:"\u041d\u0435 \u0432\u044b\u0431\u0440\u0430\u043d\u0430 \u0441\u0435\u043a\u0446\u0438\u044f"})},e.onSubjectChange=function(t){(0,e.props.dispatch)({type:"NEW_TOPIC_SUBJECT",text:t.target.value})},e.onSubmitSuccess=function(){(0,e.props.dispatch)({type:"NEW_TOPIC_CLEAR",text:""}),e.props.onSubmitSuccess&&e.props.onSubmitSuccess()},e}return Object(Ne.a)(n,[{key:"render",value:function(){var e=this.props,t=e.sections,n=e.newTopic,r=[];for(var a in t.tree)r.push(Object(Be.jsx)("option",{value:a.toLowerCase(),children:a},a));var c=[];if(n.isVoting){c.push(Object(Be.jsx)("div",{children:"\u0412\u0430\u0440\u0438\u0430\u043d\u0442\u044b:"},"p"));for(var s=1;s<=10;s++)c.push(Object(Be.jsxs)(Fe.a,{size:"sm",style:{marginBottom:"3px",width:"100%"},children:[Object(Be.jsx)(Fe.a.Prepend,{children:Object(Be.jsx)(Fe.a.Text,{style:{width:"40px"},className:"input",children:"".concat(s,".")})}),Object(Be.jsx)(Pe.a.Control,{type:"text",maxLength:"50",ref:"vote".concat(s),className:"input"})]},s))}return Object(Be.jsxs)("form",{className:"new-topic-container",onSubmit:this.onSubmit,children:[Object(Be.jsxs)("div",{id:"newtopic_form",className:"new-topic-text",children:[Object(Be.jsx)("div",{children:Object(Be.jsx)("b",{children:"\u041d\u043e\u0432\u0430\u044f \u0442\u0435\u043c\u0430:"})}),n.error&&Object(Be.jsx)(at,{text:n.error}),Object(Be.jsxs)("div",{className:"flex-row",style:{marginBottom:"3px"},children:[Object(Be.jsx)(Pe.a.Control,{as:"select",size:"sm",readOnly:!0,value:n.forum,style:{flex:"0 1 90px"},className:"input",children:r}),Object(Be.jsx)(ot,{defaultValue:"\u0421\u0435\u043a\u0446\u0438\u044f",id:"target_section",size:"sm",style:{flex:"1 1 auto"},onChange:this.onSectionChange})]}),Object(Be.jsx)(Pe.a.Control,{type:"text",size:"sm",value:n.subject,onChange:this.onSubjectChange,style:{marginBottom:"3px"},className:"input",placeholder:"\u0422\u0435\u043c\u0430",maxLength:"90"}),Object(Be.jsx)(Et,{placeholder:"\u0421\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435",showVoting:!0,isVoting:n.isVoting,text:n.text,isFetching:n.isFetching,formName:"NEW_TOPIC"})]}),Object(Be.jsx)(Tt.a,{className:"new-topic-voting",children:c})]})}}]),n}(r.Component)),Pt=Object(u.b)((function(e){return{sections:e.sections,newTopic:e.newTopic}}))(_t),Lt=n(88),Rt=n.n(Lt);var At=function(e){var t,n,r,a=new Set("|if|\u0435\u0441\u043b\u0438|then|\u0442\u043e\u0433\u0434\u0430|elsif|\u0438\u043d\u0430\u0447\u0435\u0435\u0441\u043b\u0438|else|\u0438\u043d\u0430\u0447\u0435|endif|\u043a\u043e\u043d\u0435\u0446\u0435\u0441\u043b\u0438|do|\u0446\u0438\u043a\u043b|for|\u0434\u043b\u044f|to|\u043f\u043e|each|\u043a\u0430\u0436\u0434\u043e\u0433\u043e|in|\u0438\u0437|while|\u043f\u043e\u043a\u0430|enddo|\u043a\u043e\u043d\u0435\u0446\u0446\u0438\u043a\u043b\u0430|procedure|\u043f\u0440\u043e\u0446\u0435\u0434\u0443\u0440\u0430|endprocedure|\u043a\u043e\u043d\u0435\u0446\u043f\u0440\u043e\u0446\u0435\u0434\u0443\u0440\u044b|function|\u0444\u0443\u043d\u043a\u0446\u0438\u044f|endfunction|\u043a\u043e\u043d\u0435\u0446\u0444\u0443\u043d\u043a\u0446\u0438\u0438|var|\u043f\u0435\u0440\u0435\u043c|export|\u044d\u043a\u0441\u043f\u043e\u0440\u0442|goto|\u043f\u0435\u0440\u0435\u0439\u0442\u0438|and|\u0438|or|\u0438\u043b\u0438|not|\u043d\u0435|val|\u0437\u043d\u0430\u0447|break|\u043f\u0440\u0435\u0440\u0432\u0430\u0442\u044c|continue|\u043f\u0440\u043e\u0434\u043e\u043b\u0436\u0438\u0442\u044c|return|\u0432\u043e\u0437\u0432\u0440\u0430\u0442|try|\u043f\u043e\u043f\u044b\u0442\u043a\u0430|except|\u0438\u0441\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435|endtry|\u043a\u043e\u043d\u0435\u0446\u043f\u043e\u043f\u044b\u0442\u043a\u0438|raise|\u0432\u044b\u0437\u0432\u0430\u0442\u044c\u0438\u0441\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435|false|\u043b\u043e\u0436\u044c|true|\u0438\u0441\u0442\u0438\u043d\u0430|undefined|\u043d\u0435\u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u043e|null|new|\u043d\u043e\u0432\u044b\u0439|execute|\u0432\u044b\u043f\u043e\u043b\u043d\u0438\u0442\u044c|".split("|")),c=new Set("():;.,=+-*<>?[]%/".split("")),s="bg>",i="num>",o="str>",l="key>",u=!1,p="";function h(e){return""===e.trim()}function d(e,t,n){return e.substr(t-1,n)}function j(e,t){return e.substr(-t)}function f(e){return a.has(e.toLowerCase().trim())}function b(e,a){" "===e||r===a?t+=e:(n&&(t+="</span>",n=!1),t=t+"<span class="+a+e,n=!0,r=a)}function m(e){var n=!1,a=!1,m=1,O=!0,v=1;for(v=1;v<=e.length;v++){var x=e.charAt(v-1);if(u)'"'===x?(b(d(e,m,v-m+1),o),u=!1,p="",O=!0):p+=x;else if(n)"'"===x?(b(d(e,m,v-m+1),o),n=!1,p="",O=!0):p+=x;else if(" "===x)h(p)?t+=" ":(a?(b(p+" ",o),a=!1):f(p.trim())?b(p+" ",l):isNaN(parseInt(p,10))?b(p+" ",s):b(p+" ",i),p=""),O=!0;else if(c.has(x)){if(h(p)||(a?(b(p,o),a=!1,O="."!==x):O&&f(p)?(b(p,l),O="."!==x):(isNaN(parseInt(p,10))?b(p,s):b(p,i),O="."!==x),p=""),"."===x&&r===i){b(x,i);continue}if("="===x&&"<"===d(e,v-1,1))r=void 0;else if("/"===x&&"/"===d(e,v+1,1))return void b(j(e,e.length-v+1),"com>");b(x,"sp>")}else if('"'===x||"|"===x)h(p)?(m=v,u=!0):(b(p+x,o),p=""),O=!0;else if("'"===x)h(p)?(m=v,n=!0):(b(p+x,o),p=""),O=!0;else{if("#"===x||"&"===x&&h(t)){b(j(e,e.length-v+1),"pr>"),v=e.length;break}"~"===x?(p+=x,a=!0):p+=x}}u||n?b(d(e,m,v-m+1),o):h(p)||(f(p)?b(p,l):isNaN(parseInt(p,10))?b(p,s):b(p,i))}u=!1,p="",n=!1,r=void 0,t="";var O,v=[],x=Object(ze.a)(e.split("\n"));try{for(x.s();!(O=x.n()).done;){var g=O.value;h(g)?v.push(""):(t="",m(g),n&&!u?(t+="</span>",n=!1,r="",p=""):u||(r="",p=""),v.push(t))}}catch(y){x.e(y)}finally{x.f()}return v.join("\n")},Mt=(n(132),function(e){Object(Se.a)(n,e);var t=Object(Ie.a)(n);function n(e){var r;Object(Ce.a)(this,n),(r=t.call(this,e)).onShowClick=r.onShowClick.bind(Object(He.a)(r)),r.state={hidden:!0};var a=e.children;if(a){var c=g(a);for(r.text=c.join(""),r.text=r.text.replace(/\n<br>/g,"\n").replace(/<br>\n/g,"\n").replace(/\r<br>/g,"\n").replace(/<br>\r/g,"\n").replace(/<br>/g,"\n");"\n"===r.text[0];)r.text=r.text.substr(1);for(;"\n"===r.text.substr(-1);)r.text=r.text.substr(0,r.text.length-1);r.text=At(r.text)}return r}return Object(Ne.a)(n,[{key:"onShowClick",value:function(){this.setState({hidden:!this.state.hidden})}},{key:"render",value:function(){var e,t,n=0;this.text&&(n=this.text.split("\n").length),e=this.state.hidden?"\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c: ".concat(n," \u0441\u0442\u0440\u043e\u043a"):"\u0421\u043a\u0440\u044b\u0442\u044c",n>7&&(t=Object(Be.jsx)("div",{className:"expand-button-div",children:Object(Be.jsx)("span",{className:"expand-button-span",onClick:this.onShowClick,children:e})}));var r={};return this.state.hidden&&n>7?(r.overflow="hidden",r.height="135px"):(r.overflow="auto",r.height="auto"),Object(Be.jsxs)("div",{style:{marginTop:"5px"},children:[Object(Be.jsx)("pre",{className:"code-pre",style:r,dangerouslySetInnerHTML:{__html:this.text}}),t]})}}]),n}(r.Component)),Ft=n(74),Dt=n.n(Ft),Wt=function(e){Object(Se.a)(n,e);var t=Object(Ie.a)(n);function n(){return Object(Ce.a)(this,n),t.apply(this,arguments)}return Object(Ne.a)(n,[{key:"render",value:function(){var e=this.props,t=e.href,n=e.children;return Object(Be.jsx)("a",{href:t,className:"registered-user",children:n})}}]),n}(r.Component),Vt=function(e){Object(Se.a)(n,e);var t=Object(Ie.a)(n);function n(e){var r;return Object(Ce.a)(this,n),(r=t.call(this,e)).state={hrefName:e.href,title:""},r}return Object(Ne.a)(n,[{key:"getVideoId",value:function(e){if(-1!==e.search(/youtube/)){var t=e.split("?");return Re.a.parse(t[1]).v}if(-1!==e.search(/youtu\.be/)){var n=e.match(/e\/(.+?)(&|\?|$)/);if(n&&n.length>1)return n[1]}return null}},{key:"getVideoParams",value:function(){var e=Object(b.a)(f.a.mark((function e(t){var n,r,a,c,s,i;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=localStorage.getItem("youtubeApiKey")||"AIzaSyCztN2QW4Fxw_1YuAHBTOZdYLbzigPz25g",r="https://www.googleapis.com/youtube/v3/videos?key=".concat(n,"&fields=items(snippet(title))&part=snippet&id=").concat(t),e.next=4,fetch(r);case 4:return a=e.sent,e.next=7,a.json();case 7:return c=e.sent,s=c.items[0].snippet.title,i=s,50,s.length>55&&(i=i.substring(0,50)+"..."),e.abrupt("return",{hrefName:i,title:s});case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){var e=Object(b.a)(f.a.mark((function e(){var t,n,r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.props.href,n=this.getVideoId(t)){e.next=4;break}return e.abrupt("return");case 4:return e.prev=4,e.next=7,this.getVideoParams(n);case 7:r=e.sent,this.setState(Object(ne.a)({},r)),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(4),console.error("youtube",e.t0.message);case 14:case"end":return e.stop()}}),e,this,[[4,11]])})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return Object(Be.jsx)("a",{href:this.props.href,title:this.state.title,children:"".concat("youtube",": ").concat(this.state.hrefName)})}}]),n}(r.Component),Bt=function(e){Object(Se.a)(n,e);var t=Object(Ie.a)(n);function n(){return Object(Ce.a)(this,n),t.apply(this,arguments)}return Object(Ne.a)(n,[{key:"fixBrokenLink",value:function(e,t){var n=e.replace(/\[/g,"\\[").replace(/\]/g,"\\]").replace(/\./g,"\\.").replace(/\./g,".").replace(/\*/g,"\\*").replace(/\+/g,"\\+").replace(/\(/g,"\\(").replace(/\)/g,"\\)").replace(/\?/g,"\\?").replace(/\//g,"\\/");try{var r=new RegExp(n+"<\\/a>(\\)|[\u0430-\u044f\u0451\u0410-\u042f\u04010-9#\\-\\+\\_\\%\\?=]*)"),a=t.match(r);if(a&&a.length>1)return")"===a[1]&&-1===e.search("\\(")?e:e+=a[1]}catch(c){console.error(c)}return e}},{key:"render",value:function(){var e=this.props,t=e.href,n=e.children,r=e.parentText,a=e.showTooltipOnPostLink,c=e.showYoutubeVideoTitle,s=e.replaceCatalogMista,i=e.fixBrokenLinks;try{var o=new Dt.a(t,!0)}catch(u){return console.error(u.message,t),Object(Be.jsx)("a",{href:t,children:t})}var l=t;if(l.startsWith("/")&&(o.set("protocol","https"),o.set("hostname","forum.mista.ru"),l=o.href),"true"===a){if(-1!==o.hostname.search(/forum\.mista.ru/)){if("/topic.php"===o.pathname)return Object(Be.jsx)(vt,{topicId:o.query.id,number:o.hash.replace("#","")||"0",children:g(n)});if("/users.php"===o.pathname)return Object(Be.jsx)(Wt,{href:o.href,children:n})}if("a-sitnikov.github.io"===o.hostname&&"/react.mista/"===o.pathname&&0===Object.keys(o.query).length&&"/react.mista/topic.php"===(o=new Dt.a(t.replace(/#\//,""),!0)).pathname)return Object(Be.jsx)(vt,{topicId:o.query.id,number:o.hash.replace("#","")||"0",children:g(n)})}return"true"!==c||-1===o.hostname.search(/youtube/)&&-1===o.hostname.search(/youtu\.be/)?"true"===s&&-1!==o.hostname.search(/catalog\.mista/)?(o.set("hostname","infostart.ru"),Object(Be.jsxs)("a",{target:this.props.target,className:this.props.class,rel:this.props.rel,href:o.href,children:[o.href," "]})):("true"===i&&r&&(l=this.fixBrokenLink(l,r)),Object(Be.jsx)("a",{target:this.props.target,className:this.props.class,rel:this.props.rel,href:l,children:n})):Object(Be.jsx)(Vt,{href:t})}}]),n}(r.Component),Ut=Object(u.b)((function(e){var t=e.options.items;return{showTooltipOnPostLink:t.showTooltipOnPostLink,showYoutubeVideoTitle:t.showYoutubeVideoTitle,replaceCatalogMista:t.replaceCatalogMista,fixBrokenLinks:t.fixBrokenLinks}}))(Bt),Gt=function(e){var t=e.topicId,n=e.data,r=e.total,a=e.n,c=e.colors,s="".concat(y,"/css/voting").concat(a,".png"),i=0;r&&(i=Math.round(100*n.result/r));return Object(Be.jsxs)("div",{className:"voting-item",children:[Object(Be.jsx)("div",{className:"voting-title",children:Object(Be.jsx)("a",{rel:"nofollow",style:{textDecoration:"none"},href:"".concat(window.hash,"/topic.php?id=").concat(t,"&sel=").concat(a),children:Object(Be.jsx)("b",{children:Object(Be.jsx)("span",{style:{color:c[a-1]},children:"".concat(a,". ").concat(n.select)})})})}),Object(Be.jsx)("div",{className:"voting-percentage",children:Object(Be.jsx)("b",{children:Object(Be.jsx)("span",{style:{color:c[a-1]},children:"".concat(i,"% (").concat(n.result,")")})})}),Object(Be.jsx)("div",{className:"voting-bar",children:Object(Be.jsx)("div",{style:{width:"".concat(i,"%")},children:Object(Be.jsx)("a",{href:s,children:Object(Be.jsx)("img",{src:s,style:{maxWwidth:"500px",width:"100%",height:"15px"},alt:"\u043f".concat(a)})})})})]})},Kt=function(e){var t=e.items,n=e.topicId,r=e.colors,a=t.reduce((function(e,t){return e+t.result}),0);return Object(Be.jsx)("div",{style:{marginBottom:"10px"},children:t.filter((function(e){return e.select})).map((function(e,t){return Object(Be.jsx)(Gt,{data:e,total:a,n:t+1,topicId:n,colors:r},t)}))})},zt=function(e){Object(Se.a)(n,e);var t=Object(Ie.a)(n);function n(){return Object(Ce.a)(this,n),t.apply(this,arguments)}return Object(Ne.a)(n,[{key:"render",value:function(){var e=this.props,t=e.colors,n=e.info,r=e.vote,a=n[r-1];return Object(Be.jsx)("div",{style:{marginTop:"5px"},children:Object(Be.jsx)("b",{children:Object(Be.jsx)("span",{style:{color:t[r-1]},children:"".concat(r,". ").concat(a.select)})})})}}]),n}(r.Component),Ht=function(e){Object(Se.a)(n,e);var t=Object(Ie.a)(n);function n(){return Object(Ce.a)(this,n),t.apply(this,arguments)}return Object(Ne.a)(n,[{key:"processLinksToPosts",value:function(e){var t=this.props.topicId;return e.replace(/(\()(\d+)(\))/gi,(function(e){var n=arguments.length<=2?void 0:arguments[2];return"(<link data-topicid='".concat(t,"' data-number='").concat(n,"' ></link>)")}))}},{key:"processCode1C",value:function(e){return e.replace(/(\[1[C\u0421]\])((.|\n|\r)*?)(\[\/1[C\u0421]\])/gi,(function(e){var t=arguments.length<=2?void 0:arguments[2];return"<br>"===t.substr(0,4)&&(t=t.substr(4)),"<code>".concat(t,"</code>")}))}},{key:"processText",value:function(e){if(!e)return e;var t=this.props.showTooltips;return e=this.processCode1C(e),"true"===t&&(e=this.processLinksToPosts(e)),e}},{key:"render",value:function(){var e,t,n=this.props,r=n.topicId,a=n.n,c=n.html,s=n.vote,i=n.info,o=n.style,l=n.voteColors;s&&i.voting&&r===i.id&&(i.voting[s-1]&&(e=Object(Be.jsx)(zt,{info:i.voting,vote:s,colors:l})));"0"===a&&1===i.is_voting&&i.voting&&(t=Object(Be.jsx)(Kt,{items:i.voting,topicId:r,colors:l}));var u=this.processText(c),p={link:function(e){return Object(Be.jsx)(vt,{topicId:e["data-topicid"],number:e["data-number"]},e.key)},code:function(e){return Object(Be.jsx)(Mt,Object(ne.a)({},e))},a:function(e){return Object(Be.jsx)(Ut,Object(ne.a)(Object(ne.a)({},e),{},{parentText:u}))}},h=Rt()(u,p);return Object(Be.jsxs)("div",{className:"message",style:Object(ne.a)({},o),children:[t,Object(Be.jsx)("div",{children:h}),e]})}}]),n}(r.Component),Yt=Object(u.b)((function(e){return{info:e.topic.info,voteColors:e.options.voteColors,showTooltips:e.options.items.showTooltips}}))(Ht),Jt=(n(77),function(e){Object(Se.a)(n,e);var t=Object(Ie.a)(n);function n(){return Object(Ce.a)(this,n),t.apply(this,arguments)}return Object(Ne.a)(n,[{key:"render",value:function(){var e=this.props,t=e.user,n=e.utime,r=e.topicId,a=e.n;if(n)var c=new Date(1e3*n);return Object(Be.jsxs)("div",{children:[Object(Be.jsx)("span",{className:"plus-nav",onClick:this.props.onFirst,children:"[\u2190 "}),Object(Be.jsx)("span",{className:"plus-nav",onClick:this.props.onPrev,children:" \xab "}),Object(Be.jsx)(l.c,{className:"plus-nav",title:"\u041f\u0435\u0440\u0435\u0439\u0442\u0438 \u043a \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044e ".concat(a),to:"/topic.php?id=".concat(r,"#").concat(a),children:a}),Object(Be.jsx)("span",{className:"plus-nav",onClick:this.props.onNext,children:" \xbb "}),Object(Be.jsx)("span",{className:"plus-nav",onClick:this.props.onLast,children:" \u2192]"}),Object(Be.jsx)("b",{style:{margin:"auto 5px"},children:t}),Object(Be.jsx)("span",{className:"agh",children:Object(pt.a)(c,"dd.mm.yy - HH:MM")})]})}}]),n}(r.Component)),Xt=function(e){Object(Se.a)(n,e);var t=Object(Ie.a)(n);function n(e){var r;return Object(Ce.a)(this,n),(r=t.call(this,e)).fetchData=function(){var e=Object(b.a)(f.a.mark((function e(t){var n,a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,F(r.props.topicId,t);case 3:(n=e.sent)||(a="\u0421\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e ".concat(t)),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),a=e.t0.message;case 10:r.setState({n:t,data:n,error:a});case 12:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),r.onClickFirst=function(){r.fetchData(0)},r.onClickNext=function(){r.fetchData(r.state.n+1)},r.onClickPrev=function(){r.state.n>0&&r.fetchData(r.state.n-1)},r.onClickLast=Object(b.a)(f.a.mark((function e(){var t;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D(r.props.topicId);case 2:t=e.sent,r.fetchData(t);case 4:case"end":return e.stop()}}),e)}))),r.state={n:e.n,data:null,error:null},r}return Object(Ne.a)(n,[{key:"componentDidMount",value:function(){var e=Object(b.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.fetchData(this.state.n);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.props.topicId,t=this.state,n=t.data,r=t.error,a=t.n;if(!n&&!r)return null;if(n)var c=n.user,s=n.utime;return Object(Be.jsxs)("div",{className:"topic-preview",children:[Object(Be.jsx)(Jt,{user:c,utime:+s,topicId:e,n:a,onFirst:this.onClickFirst,onLast:this.onClickLast,onNext:this.onClickNext,onPrev:this.onClickPrev}),n&&Object(Be.jsx)(Yt,{data:n,html:n.text,topicId:e,style:{maxHeight:"500px",overflowY:"auto",overflowWrap:"break-word"}}),r&&Object(Be.jsx)("p",{children:r})]})}}]),n}(r.Component),Qt=(n(135),function(e){Object(Se.a)(n,e);var t=Object(Ie.a)(n);function n(e){var r;return Object(Ce.a)(this,n),(r=t.call(this,e)).updateTopicsList=function(){var e=r.props.fetchTopicsListIfNeeded,t=r.props,n=t.autoRefreshTopicsList,a=t.autoRefreshTopicsListInterval;r.locationParams=Re.a.parse(r.location.search),e(r.locationParams),"true"===n&&((a=+a)<60&&(a=60),clearTimeout(r.timer),r.timer=setTimeout(r.updateTopicsList,1e3*a))},r.onPostNewTopicSuccess=function(){r.updateTopicsList()},r.locationParams={page:"1"},r}return Object(Ne.a)(n,[{key:"componentDidMount",value:function(){var e=this.props.location;this.location=e,this.updateTopicsList()}},{key:"componentWillUnmount",value:function(){clearTimeout(this.timer)}},{key:"componentDidUpdate",value:function(){var e=this.props,t=e.location,n=e.topicsPerPage;this.location.search===t.search&&this.props.topicsPerPage===n||(this.location=t,this.updateTopicsList(),window.scrollTo(0,0)),document.title="React.Mista"}},{key:"render",value:function(){var e,t=this.props,n=t.topicsList,r=t.sections,a=[],c=Object(ze.a)(n.items);try{for(c.s();!(e=c.n()).done;){var s=e.value;a.push(Object(Be.jsx)(yt,{data:s},s.id)),s.showPreview&&a.push(Object(Be.jsx)("div",{className:"preview-container",children:Object(Be.jsx)(Xt,{topicId:String(s.id),n:0})},"preview".concat(String(s.id))))}}catch(i){c.e(i)}finally{c.f()}return Object(Be.jsxs)("div",{children:[Object(Be.jsx)(ut,{history:this.props.history}),n.error&&Object(Be.jsx)(at,{text:n.error}),Object(Be.jsxs)("div",{className:"table",children:[Object(Be.jsxs)("div",{className:"th",style:{position:"sticky",top:"39px"},children:[Object(Be.jsx)("div",{style:{letterSpacing:"-1px"},children:"\u0420\u0430\u0437\u0434\u0435\u043b"}),Object(Be.jsx)("div",{children:"Re"}),Object(Be.jsx)("div",{}),Object(Be.jsx)("div",{children:"\u0422\u0435\u043c\u0430"}),Object(Be.jsx)("div",{children:"\u0410\u0432\u0442\u043e\u0440"}),Object(Be.jsx)("div",{children:Object(Be.jsx)("span",{style:{cursor:"pointer"},title:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a",onClick:this.updateTopicsList,children:n.isFetching?"\u041e\u0431\u043d\u043e\u0432\u043b\u044f\u0435\u0442\u0441\u044f":"\u041e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u043e"})})]}),a,Object(Be.jsx)("div",{className:"tf",children:Object(Be.jsx)(kt,{baseUrl:"index.php",locationParams:this.locationParams,maxPage:10})})]}),Object(Be.jsx)("div",{id:"F",className:"newtopic",style:{marginBottom:"10px",marginTop:"5px",position:"relative"},children:Object(Be.jsx)(Pt,{sections:r.items,onSubmitSuccess:this.onPostNewTopicSuccess,locationParams:this.locationParams})})]})}}]),n}(r.Component)),qt=Object(u.b)((function(e){return{topicsList:e.topicsList,sections:e.sections,login:e.login,topicsPerPage:e.options.items.topicsPerPage,autoRefreshTopicsList:e.options.items.autoRefreshTopicsList,autoRefreshTopicsListInterval:e.options.items.autoRefreshTopicsListInterval}}),(function(e){return{fetchTopicsListIfNeeded:function(){return e(ee.apply(void 0,arguments))}}}))(Qt),$t=function(e,t,n){return{type:"RECEIVE_TOPIC",info:e,item0:t,items:n,receivedAt:Date.now()}},Zt=function(){return{type:"CLOSE_TOPIC"}},en=function(e){var t=e.topic;return!t||!t.isFetching},tn=function(e,t){return function(n,r){if(en(r()))return n(function(e,t){return function(){var n=Object(b.a)(f.a.mark((function n(r){var a,c,s,i,o,l,u,p,h,d,j;return f.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r({type:"REQUEST_TOPIC"}),n.prev=1,n.next=4,A({id:e.id});case 4:a=n.sent,n.next=11;break;case 7:n.prev=7,n.t0=n.catch(1),console.error(n.t0),a={id:e.id,text:"",answers_count:"0"};case 11:if(n.prev=11,c=e.page||1,s=t,"last20"!==c){n.next=34;break}if(!(+a.answers_count>21)){n.next=27;break}if(s){n.next=21;break}return n.next=19,M({id:e.id,from:0,to:1});case 19:o=n.sent,s=o[0];case 21:return l=+a.answers_count-20,n.next=24,M({id:e.id,from:l,to:1010});case 24:i=n.sent,n.next=32;break;case 27:return n.next=29,M({id:e.id,from:0,to:1010});case 29:u=n.sent,s=u[0],i=u.slice(1);case 32:n.next=54;break;case 34:if(p=0,h=100*(c=+c)-1,!(c>1)){n.next=49;break}if(p=100*(c-1),s){n.next=44;break}return n.next=42,M({id:e.id,from:0,to:1});case 42:d=n.sent,s=d[0];case 44:return n.next=46,M({id:e.id,from:p,to:h});case 46:i=n.sent,n.next=54;break;case 49:return p=s?1:0,n.next=52,M({id:e.id,from:p,to:h});case 52:j=n.sent,s?i=j:(s=j[0],i=j.slice(1));case 54:"0"===a.answers_count&&i.length>0&&(a.answers_count=i[i.length-1].n),"last20"===c&&i.length>20&&(i=i.slice(-20)),r($t(a,s,i)),n.next=63;break;case 59:n.prev=59,n.t1=n.catch(11),console.error("Failed to fetch topic:",n.t1),r({type:"RECEIVE_TOPIC_FAILED",error:n.t1,receivedAt:Date.now()});case 63:case"end":return n.stop()}}),n,null,[[1,7],[11,59]])})));return function(e){return n.apply(this,arguments)}}()}(e,t))}},nn=function(e){return function(t,n){if(en(n()))return t(function(e){return function(){var t=Object(b.a)(f.a.mark((function t(n){var r;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n({type:"REQUEST_NEW_MESSAGES"}),t.prev=1,t.next=4,M({id:e.id,from:e.last+1,to:1002});case 4:r=t.sent,n({type:"RECEIVE_NEW_MESSAGES",items:r,receivedAt:Date.now()}),t.next=12;break;case 8:t.prev=8,t.t0=t.catch(1),console.error("Failed to fetch new messages:",t.t0),n({type:"RECEIVE_NEW_MESSAGES_FAILED",error:t.t0,receivedAt:Date.now()});case 12:case"end":return t.stop()}}),t,null,[[1,8]])})));return function(e){return t.apply(this,arguments)}}()}(e))}},rn=function(e){Object(Se.a)(n,e);var t=Object(Ie.a)(n);function n(){return Object(Ce.a)(this,n),t.apply(this,arguments)}return Object(Ne.a)(n,[{key:"render",value:function(){var e=this.props.info;return Object(Be.jsxs)("div",{className:"flex-row",children:[Object(Be.jsx)("div",{className:"user-td",children:Object(Be.jsx)(st,{})}),Object(Be.jsx)("div",{className:"section-td",children:Object(Be.jsx)("span",{id:"forum_string",className:"bold120",children:Object(Be.jsx)("a",{rel:"nofollow",href:"".concat(window.hash,"/index.php?forum=").concat(e.forum),style:{textDecoration:"none"},children:{"1c":"1\u0421:\u041f\u0440\u0435\u0434\u043f\u0440\u0438\u044f\u0442\u0438\u0435",life:"\u041e \u0436\u0438\u0437\u043d\u0438",it:"\u0418\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u043e\u043d\u043d\u044b\u0435 \u0442\u0435\u0445\u043d\u043e\u043b\u043e\u0433\u0438\u0438",job:"\u0420\u0430\u0431\u043e\u0442\u0430"}[e.forum]})})})]})}}]),n}(r.Component),an=Object(u.b)((function(e){return{info:(e.topic||{info:{forum:""}}).info}}))(rn),cn=function(e){Object(Se.a)(n,e);var t=Object(Ie.a)(n);function n(){return Object(Ce.a)(this,n),t.apply(this,arguments)}return Object(Ne.a)(n,[{key:"render",value:function(){var e=this.props.info,t="https://www.yandex.ru/yandsearch?rpt=rad&text="+encodeURIComponent(e.text);return Object(Be.jsxs)("div",{className:"topic-row",children:[Object(Be.jsx)("div",{className:"cell-userinfo",children:Object(Be.jsxs)("div",{className:"topic-tools",children:[Object(Be.jsx)("a",{title:"API.info",href:"".concat(y,"/").concat(k,"?id=").concat(e.id),className:"agh",style:{display:"block",lineHeight:"1em"},children:"i"}),Object(Be.jsx)("a",{title:"API.messages",href:"".concat(y,"/").concat(T,"?id=").concat(e.id,"&from=0&to=20"),className:"agh",style:{display:"block",lineHeight:"1em"},children:"m"})]})}),Object(Be.jsx)("div",{className:"cell-message",children:Object(Be.jsxs)("div",{className:"flex-row",children:[Object(Be.jsxs)("div",{style:{flex:1,textAlign:"center"},children:[Object(Be.jsx)("a",{href:"".concat(y,"/topic.php?id=").concat(e.id),children:Object(Be.jsx)("h1",{className:"topic-title",dangerouslySetInnerHTML:{__html:e.text}})}),Object(Be.jsx)("div",{className:"moder-action"})]}),Object(Be.jsx)("div",{style:{flex:"0 0 20px",position:"relative"},children:Object(Be.jsx)("div",{className:"div-va-middle",children:Object(Be.jsx)("a",{rel:"noopener noreferrer",href:t,title:"\u0418\u0441\u043a\u0430\u0442\u044c \u0432 \u042f\u043d\u0434\u0435\u043a\u0441\u0435",target:"_blank",className:"yandex",children:"\u042f"})})})]})})]})}}]),n}(r.Component),sn=Object(u.b)((function(e){return{info:(e.topic||re).info}}))(cn),on=function(e){return function(t){t({type:"ADD_MESSAGE_TEXT",text:e})}},ln=function(e){Object(Se.a)(n,e);var t=Object(Ie.a)(n);function n(){var e;Object(Ce.a)(this,n);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return(e=t.call.apply(t,[this].concat(a))).onClick=function(){var t=e.props,n=t.dispatch,r=t.data;n(on("(".concat(r.n,")")));var a=document.getElementById("message_text");a&&window.scrollTo(0,a.offsetTop)},e.onImageLoad=function(e){e.target.style.display="inline"},e}return Object(Ne.a)(n,[{key:"render",value:function(){var e,t=this.props,n=t.data,a=t.isAuthor,c=t.isYou,s=t.isTooltip,i="".concat(y,"/users.php?id=").concat(n.userId);e=n?"0"===n.n?Object(pt.a)(new Date(1e3*+n.utime),"dd.mm.yy - HH:MM"):Object(Be.jsxs)(r.Fragment,{children:[Object(Be.jsx)("span",{className:"message-number",children:n.n})," - "+Object(pt.a)(new Date(1e3*+n.utime),"dd.mm.yy - HH:MM")]}):"";var o,l,u=dt()("registered-user",{"is-author":a,"is-you":c});return window.innerWidth>768&&(o=Object(Be.jsx)("img",{src:"".concat(y,"/css/user_icons/").concat(n.userId,"_16x16.png"),onLoad:this.onImageLoad,style:{display:"none",marginBottom:"4px",marginRight:"1px"}})),l=s?Object(Be.jsx)("div",{className:"ah",style:{display:"inline-block",marginLeft:"5px"},children:e}):Object(Be.jsxs)("div",{className:"message-time",children:[Object(Be.jsx)("span",{className:"ah",children:e}),Object(Be.jsx)("button",{className:"button ah",onClick:this.onClick,children:e})]}),Object(Be.jsxs)("div",{className:"user-info",children:[o,Object(Be.jsx)("a",{className:u,href:i,children:n.user}),l]})}}]),n}(r.Component),un=Object(u.b)()(ln),pn=function(e){Object(Se.a)(n,e);var t=Object(Ie.a)(n);function n(){return Object(Ce.a)(this,n),t.apply(this,arguments)}return Object(Ne.a)(n,[{key:"render",value:function(){var e=this.props,t=e.data,n=e.author,r=e.topicId,a=e.login;return t?Object(Be.jsxs)("div",{className:"topic-row",id:t.n,children:[Object(Be.jsx)("div",{className:"cell-userinfo",children:Object(Be.jsx)(un,{data:t,isAuthor:t.user===n,isYou:t.user===a.username})}),Object(Be.jsx)("div",{className:"cell-message",children:Object(Be.jsx)(Yt,{data:t,html:t.text,topicId:r,n:t.n,vote:+t.vote})})]}):null}}]),n}(r.Component),hn=Object(u.b)((function(e){var t=e.topic||{info:{},item0:{}},n=t.info,r=t.item0;return{topicId:n.id,author:r?r.user:"",login:e.login}}))(pn),dn=function(e){return function(){var t=Object(b.a)(f.a.mark((function t(n){return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n({type:"ADD_BOOKMARK_START"}),t.prev=1,t.next=4,z(e);case 4:n({type:"ADD_BOOKMARK_COMPLETE"}),t.next=11;break;case 7:t.prev=7,t.t0=t.catch(1),console.error("Error adding bookmark:",t.t0),n({type:"ADD_BOOKMARK_FAIL"});case 11:case"end":return t.stop()}}),t,null,[[1,7]])})));return function(e){return t.apply(this,arguments)}}()},jn=function(e){Object(Se.a)(n,e);var t=Object(Ie.a)(n);function n(){var e;Object(Ce.a)(this,n);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return(e=t.call.apply(t,[this].concat(a))).onBookmarkClick=function(){var t=e.props,n=t.info;(0,t.dispatch)(dn(n))},e.onRefreshClick=function(){var t=e.props,n=t.info;(0,t.dispatch)(nn({id:n.id,last:parseInt(n.answers_count,10)}))},e}return Object(Ne.a)(n,[{key:"render",value:function(){var e,t=this.props,n=t.info,r=t.bookmark,a=t.isFetching,c=t.params,s=x(n.answers_count),i=c.page||1;return"last20"!==i&&i!==s||(e=Object(Be.jsx)(tt.a,{onClick:this.onRefreshClick,disabled:r.isFetching,size:"sm",className:"button",variant:"light",children:a?"\u041e\u0431\u043d\u043e\u0432\u043b\u044f\u0435\u0442\u0441\u044f":"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0432\u0435\u0442\u043a\u0443"})),Object(Be.jsxs)("div",{className:"flex-row",id:"F",children:[Object(Be.jsx)("div",{className:"ta-left va-top",style:{width:"50%"},children:Object(Be.jsx)(tt.a,{onClick:this.onBookmarkClick,disabled:r.isFetching,size:"sm",className:"button",variant:"light",children:r.isFetching?"\u041f\u043e\u0434\u043e\u0436\u0434\u0438\u0442\u0435...":"\u0417\u0430\u043a\u043b\u0430\u0434\u043a\u0430"})}),Object(Be.jsx)("div",{className:"ta-right va-middle",style:{marginLeft:"auto"},children:e})]})}}]),n}(r.Component),fn=Object(u.b)((function(e){var t=e.topic||{isFetching:!0,info:{}},n=t.isFetching,r=t.lastUpdated;return{info:t.info,isFetching:n,lastUpdated:r,bookmark:e.bookmark||{}}}))(jn),bn=function(e){Object(Se.a)(n,e);var t=Object(Ie.a)(n);function n(e){var r;return Object(Ce.a)(this,n),(r=t.call(this,e)).onSubmit=function(e){e.preventDefault(),e.stopPropagation();var t=r.props,n=t.dispatch,a=t.info,c={text:t.newMessage.text,topicId:a.id,onSuccess:r.onSubmitSuccess,voting_select:void 0};r.state.voting&&(c.voting_select=r.state.voting),n(function(e){return function(){var t=Object(b.a)(f.a.mark((function t(n){var r;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n({type:"POST_NEW_MESSAGE_START"}),r={message_text:encodeURIComponent(e.text),action:"new",topic_id:e.topicId,rnd:Math.round(1e10*Math.random())},e.voting_select&&(r.voting_select=e.voting_select),t.prev=3,t.next=6,G(r);case 6:return t.next=8,n({type:"POST_NEW_MESSAGE_COMPLETE"});case 8:e.onSuccess&&e.onSuccess(),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(3),console.error("Failed to post new message: "+t.t0);case 14:case"end":return t.stop()}}),t,null,[[3,11]])})));return function(e){return t.apply(this,arguments)}}()}(c))},r.onSubmitSuccess=function(){(0,r.props.dispatch)({type:"NEW_MESSAGE_TEXT",text:""}),r.setState(Object(ne.a)(Object(ne.a)({},r.state),{},{voting:void 0})),r.props.onSubmitSuccess&&r.props.onSubmitSuccess()},r.clearVoting=function(e){e.preventDefault(),r.setState(Object(ne.a)(Object(ne.a)({},r.state),{},{voting:void 0}))},r.setVotingOption=function(e){r.setState(Object(ne.a)(Object(ne.a)({},r.state),{},{voting:e}))},r.state={voting:void 0},r}return Object(Ne.a)(n,[{key:"render",value:function(){var e,t=this,n=this.props,r=n.info,a=n.newMessage;if(r.is_voting&&r.voting){for(var c=[],s=function(e){var n=r.voting[e-1];if(!n.select)return"continue";c.push(Object(Be.jsx)(Pe.a.Check,{type:"radio",name:"voting",checked:t.state.voting===e,onChange:function(){return t.setVotingOption(e)},label:"".concat(e,". ").concat(n.select)},e))},i=1;i<=r.voting.length;i++)s(i);e=Object(Be.jsxs)(Tt.a,{children:[Object(Be.jsx)("legend",{children:Object(Be.jsxs)("small",{children:["\u0412\u0430\u0448 \u0432\u044b\u0431\u043e\u0440:",Object(Be.jsx)("span",{href:"",id:"voting_clear",style:{marginLeft:"5px",cursor:"pointer"},onClick:this.clearVoting,children:"\u043e\u0447\u0438\u0441\u0442\u0438\u0442\u044c"})]})}),c,"\u041e\u0431\u043e\u0441\u043d\u0443\u0439\u0442\u0435 \u0441\u0432\u043e\u0439 \u0432\u044b\u0431\u043e\u0440!"]})}return Object(Be.jsxs)("form",{style:{marginTop:"5px"},onSubmit:this.onSubmit,children:[Object(Be.jsx)("div",{className:"bold",children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435 \u0432 \u0442\u0435\u043c\u0443:"}),Object(Be.jsxs)("div",{className:"new-message-container",children:[Object(Be.jsx)("div",{className:"new-message-text",children:Object(Be.jsx)(Et,{isFetching:a.isFetching,text:a.text,placeholder:"\u0421\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435",formName:"NEW_MESSAGE"})}),Object(Be.jsx)("div",{className:"new-message-voting",children:e})]})]})}}]),n}(r.Component),mn=Object(u.b)((function(e){return{info:e.topic.info,newMessage:e.newMessage}}))(bn),On=(n(136),function(e){Object(Se.a)(n,e);var t=Object(Ie.a)(n);function n(e){var r;return Object(Ce.a)(this,n),(r=t.call(this,e)).autoUpdate=function(){var e=r.props,t=e.info,n=e.fetchNewMessagesIfNeeded;("last20"===r.locationParams.page||r.locationParams.page===x(+t.answers_count))&&n({id:t.id,last:parseInt(t.answers_count,10)})},r.updateTopic=function(){var e=r.props,t=e.fetchTopicIfNeeded,n=e.item0,a=Re.a.parse(r.location.search);a.page?"last20"!==a.page&&(a.page=+a.page,isNaN(a.page)&&(a.page=1)):a.page=1,a.id!==r.locationParams.id&&(n=null),r.locationParams=a,t(r.locationParams,n)},r.onPostNewMessageSuccess=function(){var e=r.props,t=e.fetchNewMessagesIfNeeded,n=e.info;("last20"===r.locationParams.page||r.locationParams.page===x(+n.answers_count))&&t({id:n.id,last:parseInt(n.answers_count,10)})},r.locationParams={id:""},r.scrolledToHash=!1,r}return Object(Ne.a)(n,[{key:"componentDidMount",value:function(){if(this.location=this.props.location,this.updateTopic(),"true"===this.props.options.autoRefreshTopic){var e=+this.props.options.autoRefreshTopicInterval;e<60&&(e=60),this.timer=setInterval(this.autoUpdate,1e3*e)}}},{key:"componentDidUpdate",value:function(){var e=this.props,t=e.location,n=e.items,r=e.info;if(!this.scrolledToHash&&t.hash&&n.length>0){this.scrolledToHash=!0;var a=document.getElementById(t.hash.slice(1));a&&setTimeout((function(){return window.scrollTo(0,a.offsetTop)}),1)}var c=r.text;c&&document.title!==c&&(c=(new DOMParser).parseFromString(c,"text/html").firstChild.innerText,document.title=c);this.location.search!==t.search&&(this.location=t,this.updateTopic())}},{key:"componentWillUnmount",value:function(){var e=this.props,t=e.closeTopic,n=e.clearText;clearInterval(this.timer),t(),n()}},{key:"render",value:function(){var e=this.props,t=e.login,n=e.items,r=e.item0,a=e.info,c=e.error,s=x(+a.answers_count);return Object(Be.jsxs)("div",{style:{marginBottom:"5px"},children:[c&&Object(Be.jsx)(at,{text:c.message}),Object(Be.jsx)(an,{currentPage:this.locationParams.page}),Object(Be.jsxs)("div",{className:"topic-table",children:[Object(Be.jsx)(sn,{}),Object(Be.jsx)(hn,{data:r},"0"),n.map((function(e,t){return Object(Be.jsx)(hn,{data:e},e.n)})),(s>1||"last20"===this.locationParams.page)&&Object(Be.jsx)("div",{className:"tf",children:Object(Be.jsx)(kt,{baseUrl:"topic.php",locationParams:this.locationParams,maxPage:s,last20:!0})})]}),Object(Be.jsx)(fn,{params:this.locationParams}),t.logged&&Object(Be.jsx)(mn,{onSubmitSuccess:this.onPostNewMessageSuccess})]})}}]),n}(r.Component)),vn=Object(u.b)((function(e){var t=e.topic,n=t.isFetching,r=t.lastUpdated,a=t.info,c=t.item0,s=t.items,i=t.error;return{login:e.login,info:a,item0:c,items:s,isFetching:n,lastUpdated:r,error:i,options:e.options.items}}),(function(e){return{fetchTopicIfNeeded:function(){return e(tn.apply(void 0,arguments))},fetchNewMessagesIfNeeded:function(){return e(nn.apply(void 0,arguments))},closeTopic:function(){return e(Zt.apply(void 0,arguments))},clearText:function(){return e({type:"NEW_MESSAGE_TEXT",text:""})}}}))(On),xn=function(e){Object(Se.a)(n,e);var t=Object(Ie.a)(n);function n(){var e;Object(Ce.a)(this,n);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return(e=t.call.apply(t,[this].concat(a))).onChange=function(t){var n=e.props.name;e.props.onChange(t,n,t.target.value)},e}return Object(Ne.a)(n,[{key:"render",value:function(){for(var e=this.props,t=e.name,n=e.label,r=e.values,a=e.oneLine,c=[],s=0;s<r.length;s++){var i=r[s];c.push(Object(Be.jsxs)("label",{htmlFor:i.name,style:{marginRight:"5px"},children:[Object(Be.jsx)("input",{type:"radio",name:t,value:i.name,checked:i.name===this.props.value,onChange:this.onChange}),i.descr]},s))}return Object(Be.jsxs)("span",{children:[Object(Be.jsx)("span",{style:{marginRight:"5px"},children:n}),a?null:Object(Be.jsx)("br",{}),c]})}}]),n}(r.Component),gn=function(e){Object(Se.a)(n,e);var t=Object(Ie.a)(n);function n(){var e;Object(Ce.a)(this,n);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return(e=t.call.apply(t,[this].concat(a))).onChange=function(t){var n=e.props.name;e.props.onChange(t,n,t.target.value)},e}return Object(Ne.a)(n,[{key:"render",value:function(){var e=this.props,t=e.name,n=e.value,r=e.label,a=e.postfix;return Object(Be.jsxs)("label",{htmlFor:t,style:{marginRight:"5px"},children:[Object(Be.jsx)("span",{style:{marginRight:"5px"},children:r}),Object(Be.jsx)("input",{type:"string",name:t,value:n,onChange:this.onChange,className:"input"}),void 0!==a?Object(Be.jsx)("span",{style:{marginLeft:"5px"},children:a}):null]})}}]),n}(r.Component),yn=(n(137),function(e){Object(Se.a)(n,e);var t=Object(Ie.a)(n);function n(e){var r;return Object(Ce.a)(this,n),(r=t.call(this,e)).closeForm=function(){r.props.history.push("/"+window.hash)},r.resetOptions=function(){r.setState(Object(ne.a)(Object(ne.a)({},r.state),{},{items:Object.assign({},ye.items)}))},r.applyOptions=function(){var e;(0,r.props.dispatch)((e=r.state.items,function(t){t({type:"SAVE_OPTIONS",options:e})})),r.closeForm()},r.onTabClick=function(e){r.setState(Object(ne.a)(Object(ne.a)({},r.state),{},{activeTab:e.target.textContent}))},r.onChange=function(e,t,n){var a=Object.assign({},r.state.items);a[t]=n,r.setState(Object(ne.a)(Object(ne.a)({},r.state),{},{items:a}))},r.state={items:e.options.items},r.optionsParams={theme:{type:"radio",label:"\u0426\u0432\u0435\u0442\u043e\u0432\u0430\u044f \u043f\u0430\u043b\u0438\u0442\u0440\u0430:",oneLine:!0,values:[{name:"yellow",descr:"\u0417\u043e\u043b\u043e\u0442\u0430\u044f"},{name:"lightgray",descr:"\u0421\u0435\u0440\u0430\u044f"},{name:"dark",descr:"\u0422\u0435\u043c\u043d\u0430\u044f"}]},topicsPerPage:{type:"number",label:"\u0422\u0435\u043c \u043d\u0430 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0435 (max 99):",min:1,max:99},autoRefreshTopicsList:{type:"checkbox",label:"\u0410\u0432\u0442\u043e\u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u0441\u043f\u0438\u0441\u043a\u0430 \u0442\u0435\u043c"},autoRefreshTopicsListInterval:{type:"number",label:"",min:60,max:1e6,postfix:"\u0441\u0435\u043a"},autoRefreshTopic:{type:"checkbox",label:"\u0410\u0432\u0442\u043e\u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u0442\u0435\u043c\u044b"},autoRefreshTopicInterval:{type:"number",label:"",min:60,max:1e6,postfix:"\u0441\u0435\u043a"},showTooltips:{type:"checkbox",label:"\u041f\u043e\u043a\u0430\u0437\u044b\u0432\u0430\u0442\u044c \u0442\u0443\u043b\u0442\u0438\u043f\u044b, \u0437\u0430\u0434\u0435\u0440\u0436\u043a\u0430"},tooltipDelay:{type:"number",max:1e6,label:"",postfix:"\u043c\u0441"},showTooltipOnTopicsList:{type:"checkbox",label:"\u041f\u043e\u043a\u0430\u0437\u044b\u0432\u0430\u0442\u044c \u0442\u0443\u043b\u0442\u0438\u043f\u044b \u043d\u0430 \u0433\u043b\u0430\u0432\u043d\u043e\u0439 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0435, \u043f\u0440\u0438 \u043d\u0430\u0432\u0435\u0434\u0435\u043d\u0438\u0438 \u043d\u0430 \u043a\u043e\u043b-\u0432\u043e \u043e\u0442\u0432\u0435\u0442\u043e\u0432"},showTooltipOnPostLink:{type:"checkbox",label:"\u041f\u043e\u043a\u0430\u0437\u044b\u0432\u0430\u0442\u044c \u0442\u0443\u043b\u0442\u0438\u043f \u0441\u0441\u044b\u043a\u0438 \u043d\u0430 \u0434\u0440\u0443\u0433\u0443\u044e \u0432\u0435\u0442\u043a\u0443"},showYoutubeVideoTitle:{type:"checkbox",label:"\u041f\u043e\u043a\u0430\u0437\u044b\u0432\u0430\u0442\u044c \u043d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u044f \u0440\u043e\u043b\u0438\u043a\u043e\u0432 youtube"},replaceCatalogMista:{type:"checkbox",label:"\u041e\u0431\u0440\u0430\u0442\u043d\u043e \u0437\u0430\u043c\u0435\u043d\u044f\u0442\u044c catalog.mista.ru \u043d\u0430 infostart.ru"},fixBrokenLinks:{type:"checkbox",label:"\u0427\u0438\u043d\u0438\u0442\u044c \u043f\u043e\u043b\u043e\u043c\u0430\u043d\u043d\u044b\u0435 \u0441\u0441\u044b\u043b\u043a\u0438 (\u0441 \u0440\u0443\u0441\u0441\u043a\u0438\u043c\u0438 \u0441\u0438\u043c\u0432\u043e\u043b\u0430\u043c\u0438)"}},r.form=[{tabName:"\u041e\u0431\u0449\u0438\u0435",rows:[["theme"],["topicsPerPage"],["autoRefreshTopicsList","autoRefreshTopicsListInterval"],["autoRefreshTopic","autoRefreshTopicInterval"]]},{tabName:"\u0422\u0443\u043b\u0442\u0438\u043f\u044b",rows:[["showTooltips","tooltipDelay"],["showTooltipOnTopicsList"],["showTooltipOnPostLink"]]},{tabName:"\u0421\u0441\u044b\u043b\u043a\u0438",rows:[["showYoutubeVideoTitle"],["replaceCatalogMista"],["fixBrokenLinks"]]}],r}return Object(Ne.a)(n,[{key:"render",value:function(){var e,t=this,n=[],r=Object(ze.a)(this.form);try{for(r.s();!(e=r.n()).done;){var a=e.value,c=[];for(var s in a.rows){var i,o=a.rows[s],l=[],u=Object(ze.a)(o);try{var p=function(){var e=i.value,n=t.optionsParams[e];if(!n)return"continue";var r=t.state.items[e];"radio"===n.type?l.push(Object(Be.jsx)(xn,{name:e,label:n.label,values:n.values,value:r,oneLine:n.oneLine,onChange:t.onChange},e)):"number"===n.type?(n.label&&l.push(Object(Be.jsx)("label",{htmlFor:e,style:{fontWeight:"inherit"},children:n.label},e+"_label")),l.push(Object(Be.jsx)(De.a,{type:"number",min:n.min,max:n.max,value:r,onChange:function(n){return t.onChange(n,e,n.target.value)},style:{flex:"0 0 100px",marginLeft:"5px"},className:"input",size:"sm"},e)),n.postfix&&l.push(Object(Be.jsx)("span",{style:{marginLeft:"5px",flex:"0 0 auto"},children:n.postfix},e+"_postfix"))):"string"===n.type?l.push(Object(Be.jsx)(gn,{name:e,label:n.label,postfix:n.postfix,value:r,onChange:t.onChange},e)):"checkbox"===n.type&&l.push(Object(Be.jsx)(Pe.a.Check,{type:"checkbox",label:n.label,name:e,checked:"true"===String(r),onChange:function(n){return t.onChange(n,e,n.target.checked)},style:{flex:"0 0 auto",margin:"0px",width:"100%"}},e))};for(u.s();!(i=u.n()).done;)p()}catch(h){u.e(h)}finally{u.f()}c.push(Object(Be.jsx)("div",{className:"options-row",children:l},s))}n.push(Object(Be.jsxs)("div",{children:[Object(Be.jsx)("div",{className:"tab-header",children:a.tabName}),Object(Be.jsx)("div",{className:"tab-content",children:c})]},a.tabName))}}catch(h){r.e(h)}finally{r.f()}return Object(Be.jsxs)("div",{className:"options-form",children:[Object(Be.jsx)("div",{className:"options-header",style:{cursor:"default"},children:Object(Be.jsx)("b",{children:"\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438"})}),n,Object(Be.jsxs)("div",{className:"button-row",children:[Object(Be.jsx)(tt.a,{id:"applyOptions",size:"sm",variant:"light",style:{margin:"5px"},className:"button",onClick:this.applyOptions,children:"OK"}),Object(Be.jsx)(tt.a,{id:"cancelOptions",size:"sm",variant:"light",style:{margin:"5px",float:"left"},className:"button",onClick:this.closeForm,children:"\u041e\u0442\u043c\u0435\u043d\u0430"}),Object(Be.jsx)(tt.a,{id:"defaultOptions",size:"sm",variant:"light",style:{margin:"5px",float:"right"},className:"button",onClick:this.resetOptions,children:"\u0421\u0431\u0440\u043e\u0441\u0438\u0442\u044c \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438"})]})]})}}]),n}(r.Component)),wn=Object(u.b)((function(e){return{options:e.options}}))(Object(Ae.f)(yn)),kn=function(e){Object(Se.a)(n,e);var t=Object(Ie.a)(n);function n(){var e;Object(Ce.a)(this,n);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return(e=t.call.apply(t,[this].concat(a))).onClick=function(t){(0,e.props.dispatch)((function(e,t){t().tooltips.items.length>0&&e({type:"CLEAR_TOOLTIPS"})}))},e}return Object(Ne.a)(n,[{key:"render",value:function(){var e=Object(Be.jsxs)(Ae.c,{children:[Object(Be.jsx)(Ae.a,{exact:!0,path:"/",component:qt}),Object(Be.jsx)(Ae.a,{path:"/index.php",component:qt}),Object(Be.jsx)(Ae.a,{path:"/topic.php",component:vn}),Object(Be.jsx)(Ae.a,{path:"/options.php",component:wn})]});return window.hash?Object(Be.jsx)("div",{onClick:this.onClick,style:{flex:"auto"},children:Object(Be.jsx)("div",{className:"container",children:Object(Be.jsx)(l.b,{children:e})})}):Object(Be.jsx)("div",{onClick:this.onClick,style:{flex:"auto"},children:Object(Be.jsx)("div",{className:"container",children:e})})}}]),n}(r.Component),Tn=Object(u.b)()(kn),Cn=function(e){return Object(Be.jsxs)("footer",{className:"flex-row navbar-footer",children:[Object(Be.jsx)("a",{href:"".concat(y,"/rules.php"),children:"\u041f\u0440\u0430\u0432\u0438\u043b\u0430"}),Object(Be.jsx)("span",{className:"separator",children:"|"}),Object(Be.jsx)("a",{href:"".concat(y,"/about.php"),children:"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435"}),Object(Be.jsx)("span",{className:"separator",children:"|"}),Object(Be.jsxs)("b",{children:[Object(Be.jsx)("a",{href:"".concat(y,"/ad.php"),children:"\u0420\u0435\u043a\u043b\u0430\u043c\u0430 \u043d\u0430 \u0441\u0430\u0439\u0442\u0435"}),"  "]}),Object(Be.jsx)("span",{className:"separator",children:"|"}),Object(Be.jsx)("a",{href:"".concat(y,"/find.php"),children:"\u041f\u043e\u0438\u0441\u043a"}),Object(Be.jsx)("span",{className:"separator",children:"|"}),Object(Be.jsx)("a",{rel:"nofollow",href:"".concat(y,"/sections_list.php"),children:"\u0421\u0435\u043a\u0446\u0438\u0438"}),Object(Be.jsx)("span",{className:"separator",children:"|"}),Object(Be.jsx)("a",{rel:"nofollow",href:"".concat(y,"/rating.php"),children:"\u0420\u0435\u0439\u0442\u0438\u043d\u0433"}),Object(Be.jsx)("span",{className:"separator",children:"|"}),Object(Be.jsx)("a",{href:"http://kb.mista.ru",children:"\u041a\u043d\u0438\u0433\u0430 \u0437\u043d\u0430\u043d\u0438\u0439"}),Object(Be.jsx)("span",{className:"separator",children:"|"}),Object(Be.jsx)("a",{href:"http://wiki.mista.ru",children:"\u0412\u0438\u043a\u0438-\u043c\u0438\u0441\u0442\u0430 (\u041a\u04172)"}),Object(Be.jsx)("span",{className:"separator",children:"|"}),Object(Be.jsx)("a",{rel:"nofollow",href:"http://m.mista.ru/",children:"\u041c\u043e\u0431\u0438\u043b\u044c\u043d\u0430\u044f"}),Object(Be.jsx)("span",{className:"separator",children:"|"}),Object(Be.jsx)("a",{href:"".concat(y,"/archive.php"),children:"\u0410\u0440\u0445\u0438\u0432"}),Object(Be.jsx)("span",{className:"separator",children:"|"}),Object(Be.jsx)("a",{href:"".concat(y,"/moders.php"),children:"\u041c\u043e\u0434\u0435\u0440\u0430\u0442\u043e\u0440\u044b"}),Object(Be.jsx)("span",{className:"separator",children:"|"}),Object(Be.jsx)("a",{href:"".concat(y,"/users_gallery.php"),children:"\u0413\u0430\u043b\u0435\u0440\u0435\u044f"}),Object(Be.jsx)("span",{className:"separator",children:"|"}),Object(Be.jsx)("span",{children:"18+"})]})},Nn=n(89),Sn=n.n(Nn),In=function(e){var t=e.children,n=e.closeWindow;return Object(Be.jsxs)("div",{className:"tooltip-header",children:[t,Object(Be.jsx)("div",{className:"tooltip-close",onClick:n,onTouchEnd:n,children:Object(Be.jsx)("span",{className:"tooltip-close-x",children:"x"})})]})},En=function(e){var t=e.children,n=e.onScroll,r=0;return Object(Be.jsx)("div",{className:"tooltip-text",onTouchStart:function(e){r=e.nativeEvent.changedTouches[0].clientX},onTouchEnd:function(e){var t=e.nativeEvent.changedTouches[0].clientX;Math.abs(t-r)>100&&n(-t+r)},children:t})},_n=(n(80),function(e){Object(Se.a)(n,e);var t=Object(Ie.a)(n);function n(){var e;Object(Ce.a)(this,n);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return(e=t.call.apply(t,[this].concat(a))).onCloseClick=function(){var t=e.props,n=t.dispatch,r=t.tooltip;n(mt(r.keys))},e.onWheel=function(t){t.preventDefault(),e.props.onScroll(-t.nativeEvent.deltaY)},e}return Object(Ne.a)(n,[{key:"render",value:function(){var e,t,n=this.props.tooltip,r=n.coords,c=n.i;window.innerWidth<=768?(e="y",t={top:r.y,left:5}):(e="both",t={top:r.y,left:Math.min(r.x,window.innerWidth-670)});var s=a.a.Children.toArray(this.props.children),i=Object(Me.a)(s,2),o=i[0],l=i[1];return Object(Be.jsx)(Sn.a,{axis:e,handle:".tooltip-header",defaultClassNameDragging:"dragging",children:Object(Be.jsxs)("div",{className:"tooltip-window",style:Object(ne.a)({},t),onWheelCapture:this.onWheel,children:[Object(Be.jsx)(In,{closeWindow:this.onCloseClick,children:o.props.children}),Object(Be.jsx)(En,{onScroll:this.props.onScroll,children:l.props.children})]})},c)}}]),n}(r.Component)),Pn=Object(u.b)()(_n),Ln=function(e){Object(Se.a)(n,e);var t=Object(Ie.a)(n);function n(e){var r;Object(Ce.a)(this,n),(r=t.call(this,e)).fetchData=function(){var e=Object(b.a)(f.a.mark((function e(t){var n,a,c;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t<0)){e.next=2;break}return e.abrupt("return");case 2:return a="",c=r.props.tooltip.keys.topicId,e.prev=4,e.next=7,F(c,t);case 7:n=e.sent,a=n?n.text:"\u0421\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e ".concat(t),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(4),a=e.t0.message;case 14:r.setState({data:n,text:a,number:t});case 15:case"end":return e.stop()}}),e,null,[[4,11]])})));return function(t){return e.apply(this,arguments)}}(),r.onScroll=function(e){"TOPIC_PREVIEW"===r.props.tooltip.keys.type&&(e>0?r.fetchData(r.state.number+1):r.fetchData(r.state.number-1))};var a,c=e.tooltip,s=e.info,i=e.items,o=e.item0,l=c.keys,u="";return l.topicId===s.id&&(a=0===l.number?o:i.find((function(e){return e.n===String(l.number)})))&&(u=a.text),r.state={data:a,text:u,number:l.number},r}return Object(Ne.a)(n,[{key:"componentDidMount",value:function(){this.state.data||this.fetchData(this.state.number)}},{key:"render",value:function(){var e,t=this.props.tooltip.keys;return this.state.text?(e=this.state.data?Object(Be.jsx)(un,{data:this.state.data,isAuthor:!1,isTooltip:!0}):Object(Be.jsx)("b",{children:"\u0417\u0430\u0433\u043e\u043b\u043e\u0432\u043e\u043a"}),"TOPIC"===t.type||"TOPIC_PREVIEW"===t.type?Object(Be.jsxs)(Pn,{tooltip:this.props.tooltip,onScroll:this.onScroll,children:[Object(Be.jsx)(In,{children:e}),Object(Be.jsx)(En,{children:Object(Be.jsx)(Yt,{data:this.state.data,html:this.state.text,topicId:t.topicId,style:{maxHeight:"min(550px, 80vh)",overflowY:"auto"}})})]}):null):null}}]),n}(r.Component),Rn=Object(u.b)((function(e){var t=e.topic;return{info:t.info,items:t.items,item0:t.item0}}))(Ln),An=function(e){Object(Se.a)(n,e);var t=Object(Ie.a)(n);function n(){return Object(Ce.a)(this,n),t.apply(this,arguments)}return Object(Ne.a)(n,[{key:"render",value:function(){var e=this.props.items;return Object(Be.jsx)("div",{children:e.map((function(e,t){return Object(Be.jsx)(Rn,{tooltip:e,keys:e.keys},e.hash)}))})}}]),n}(r.Component),Mn=Object(u.b)((function(e){return{items:e.tooltips.items}}))(An);var Fn=Object(u.b)((function(e){return{theme:e.options.items.theme}}))((function(e){return Object(r.useEffect)((function(){document.body.setAttribute("theme",e.theme)})),Object(Be.jsxs)(r.Fragment,{children:[Object(Be.jsx)(Ke,{}),Object(Be.jsx)(Tn,{}),Object(Be.jsx)(Cn,{}),Object(Be.jsx)(Mn,{})]})})),Dn=[h.a];var Wn=Object(p.d)(Te,p.a.apply(void 0,Dn)),Vn=function(e){var t=e.store;return Object(Be.jsx)(u.a,{store:t,children:Object(Be.jsx)(l.a,{children:Object(Be.jsx)(Fn,{})})})};window.hash="#",s.a.render(Object(Be.jsx)(Vn,{store:Wn}),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL("/react.mista",window.location).origin!==window.location.origin)return;window.addEventListener("load",(function(){var e="".concat("/react.mista","/service-worker.js");i?(!function(e){fetch(e).then((function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):o(e)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")}))):o(e)}))}}()},77:function(e,t,n){},80:function(e,t,n){},99:function(e,t,n){}},[[142,1,2]]]);
//# sourceMappingURL=main.0ed2c788.chunk.js.map