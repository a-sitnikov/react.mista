(()=>{"use strict";var e={5268:(e,t,s)=>{var a=s(1250),n=s(6030),r=s(2902),i=s(3713),o=s(2791),l=s(1087),c=s(8682),d=s(6955),u=s(2940),h=s(7689),p=s(2076),m=s(4292),x=s(7022),g=s(9546),f=s(4792),v=s(184);const j=()=>{const[e,t]=(0,o.useState)("\u042f\u043d\u0434\u0435\u043a\u0441"),[s,a]=(0,o.useState)(""),n=(0,o.useCallback)((e=>{a(e.target.value)}),[]),r=(0,f.$0)((e=>{"Enter"===e.key&&i()})),i=(0,f.$0)((()=>{let t;switch(e){case"\u042f\u043d\u0434\u0435\u043a\u0441":t="https://www.yandex.ru/search/?text=".concat(s,"&site=forum.mista.ru");break;case"Google":t="https://www.google.ru/search?q=".concat(s,"+site:forum.mista.ru")}window.open(t),a("")}));return(0,v.jsxs)(p.Z,{size:"sm",children:[(0,v.jsxs)(g.Z,{id:"search-engine",title:"",size:"sm",variant:"light",onSelect:t,children:[(0,v.jsx)(x.Z.Item,{eventKey:"\u042f\u043d\u0434\u0435\u043a\u0441",children:"\u042f\u043d\u0434\u0435\u043a\u0441"}),(0,v.jsx)(x.Z.Item,{eventKey:"Google",children:"Google"})]}),(0,v.jsx)(m.Z,{type:"text",placeholder:"".concat(e,": \u043f\u043e\u0438\u0441\u043a"),className:"search-input input",onKeyDown:r,onChange:n,value:s}),(0,v.jsx)(p.Z.Text,{className:"search-button",onClick:i,children:(0,v.jsx)("i",{className:"fa fa-search input",style:{zIndex:1e3}})})]})};var y=s(3063),b=s(8463),N=s(6490),w=s.n(N),I=s(7892),k=s.n(I);const C=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!e)return t;if("number"===typeof e)return e;const s=parseInt(e,10);return isNaN(s)?t:s},S=(e,t)=>e.reduce(((e,s)=>{const a=t(s);return e[a]||(e[a]=[]),e[a].push(s),e}),{}),T=e=>e?"last20"===e?"last20":C(e,1):1,_=e=>-1===e||void 0===e?-1:Math.min(Math.ceil(e/100),10)||1,Z=e=>e?e.map((e=>"string"===typeof e?e:"br"===e.type?"<br>":"Connect(LinkToPost)"===e.type.displayName||"Connect(t)"===e.type.displayName?e.props.number:(console.log(e),e))):[""];const M=e=>{return 2147483648e3===e?"":(t=e,k()(t).isSame(new Date,"day")?k()(e).format("HH:mm"):k()(e).format("DD.MM.YY"));var t},L=(e,t)=>{if(!t)return"";let s=new URLSearchParams;for(let n in t){const e=t[n];void 0!==e&&s.append(n,e)}let a=s.toString();return a.length>0?e+a:""},P=async(e,t,s)=>{let a="".concat(Y,"/").concat(e).concat(L("?",t));const n=await w()(a);let r,i=await n.json();if("string"===typeof i)try{r=JSON.parse(i)}catch(o){r=(e=>{try{return JSON.parse(e)}catch(o){}try{return e=e.replace(/\\</g,"<").replace(/\\>/g,">").replace(/\\&/g,"&").replace(/\\'/g,"'").replace(/\\"/g,"").replace(/ "/g,' \\"').replace(/""/g,'\\""').replace(/\t/g,"\\t").replace(/"(\.| |\?)/g,'\\"$1'),JSON.parse(e)}catch(o){return console.error(o.message),console.log(e),{}}})(i)}else r=i;return r},O=async(e,t,s)=>{let a="".concat(Y,"/").concat(e).concat(L("?",t));s||(s={mode:"cors",credentials:"same-origin"});const n=await fetch(a,s);return await n.json()};async function D(){return function(e){const{session:t}=e;return{userId:Number(null===t||void 0===t?void 0:t.user_id),userName:null===t||void 0===t?void 0:t.user_name,userHash:null===t||void 0===t?void 0:t.user_hash,lastError:null===t||void 0===t?void 0:t.last_error}}(await P(X))}function F(e){return{id:e.id,forum:e.forum,code:e.shortn,name:e.fulln}}const E=async()=>{const e=(await P($)).map(F);return{items:e,tree:S(e,(e=>e.forum))}};async function R(e){return function(e){let t=[];return e.voting&&(t=e.voting.map((e=>({text:e.select,count:e.result})))),{id:parseInt(e.id),title:e.text,forum:e.forum,sectionId:e.section,created:1e3*parseInt(e.created),authorId:e.user_id,author:e.user_name,updated:1e3*parseInt(e.updated),lastUser:e.updated_name,count:parseInt(e.answers_count),down:e.down,closed:e.closed,deleted:e.deleted,isVoting:1===e.is_voting,voting:t}}(await O(H,{id:e}))}function z(e){return{id:parseInt(e.id),n:parseInt(e.n),user:e.user,userId:parseInt(e.userId),text:e.text,time:1e3*parseInt(e.utime),vote:e.vote}}async function U(e){return(await O(q,e)).map(z)}async function V(e,t){const s=0===t?t+1:t;return(await O(q,{id:e,from:t,to:s})).map(z).find((e=>e.n===t))}function A(e){return{id:e.id,forum:e.forum,section:e.sect1,sectionCode:e.sect2,author:e.user0,lastUser:e.user,created:1e3*e.created,updated:1e3*e.utime,count:e.answ,text:e.text,closed:1===e.closed,down:1===e.down,pinned:2147483648===e.utime,isVoting:1===e.is_voting}}async function W(e){const t=function(e){const t=C(e.page,1),s=C(e.itemsPerPage,20)*t;return{topics:String(s),section_short_name:e.section,forum:e.forum,user_id:e.userId,mytopics:e.myTopics}}(e),s=C(null===e||void 0===e?void 0:e.itemsPerPage,20);return(await O(B,t)).map(A).slice(-s)}const Y=localStorage.getItem("domain")||"https://dev.mista.ru",B=localStorage.getItem("urlTopicsList")||"api/topic.php",H=localStorage.getItem("urlTopicInfo")||"ajax_gettopic.php",q=localStorage.getItem("urlTopicMessages")||"api/message.php",K=localStorage.getItem("urlLogin")||"users.php?action=do_enter",J=localStorage.getItem("urlLogout")||"users.php?action=exit",X=localStorage.getItem("urlCookies")||"ajax_cookie.php",$=localStorage.getItem("urlSections")||"ajax_getsectionslist.php",G=localStorage.getItem("urlNewMessage")||"topic.php?id=:id&page=1",Q=localStorage.getItem("urlNewTopic")||"index.php";localStorage.getItem("urlAddBookmark"),localStorage.getItem("urlSearch");let ee=function(e){return e.Sections="sections",e.TopicsList="topics-list",e.TopicMessages="topic-messages",e.TopicMessageData="topic-message-data",e.UpdateTopicMessages="update-topic-messages",e}({});const te=e=>(0,b.a)((0,y.Z)({queryKey:[ee.Sections],queryFn:E,placeholderData:{items:[],tree:{}}},e));var se=s(7781);const ae=()=>(0,n.I0)(),ne=n.v9,re=e=>{const t=ae();return(0,o.useMemo)((()=>(0,se.DE)(e,t)),[e,t])},ie=(e,t)=>{let{searchParams:s}=e;const a=ne((e=>e.options.items.topicsPerPage));return(0,b.a)((0,y.Z)({queryKey:[ee.TopicsList,Object.fromEntries(s)],queryFn:async e=>{let{queryKey:t}=e;const s=t[1];return W((0,y.Z)({itemsPerPage:a},s))},placeholderData:e=>null!==e&&void 0!==e?e:[]},t))};var oe=s(6382);const le=(0,oe.hg)("login/check",(async()=>await D())),ce=(0,oe.hg)("login/login",(async(e,t)=>{let{dispatch:s}=t;return await(async e=>{await fetch("".concat(Y,"/").concat(K),{method:"POST",body:L("",{user_name:e.username,user_password:e.password}),mode:"no-cors",credentials:"include",headers:{Accept:"text/html,application/xhtml+xml,application/xml","Content-Type":"application/x-www-form-urlencoded"},redirect:"follow"})})(e),D()})),de=(0,oe.hg)("login/logout",(async()=>await(async()=>{const e="".concat(Y,"/").concat(J);await fetch(e,{mode:"no-cors",credentials:"include"})})())),ue=e=>{let{login:t}=e;return!t||"loading"!==t.status},he=(0,oe.oM)({name:"login",initialState:{status:"init",logged:!1},reducers:{},extraReducers:e=>{e.addCase(ce.pending,(e=>{e.status="loading",delete e.error})).addCase(ce.fulfilled,((e,t)=>{let{payload:s}=t;e.status="success",e.userId=s.userId,e.userName=s.userName,e.userHash=s.userHash,e.logged=!0,delete e.error})).addCase(ce.rejected,((e,t)=>{let{error:s}=t;e.status="error",e.error=null===s||void 0===s?void 0:s.message})).addCase(de.pending,(e=>{e.status="loading",delete e.error})).addCase(de.fulfilled,(e=>{e.status="success",e.logged=!1,delete e.userId,delete e.userName,delete e.userHash,delete e.error})).addCase(de.rejected,((e,t)=>{let{error:s}=t;e.status="error",e.error=null===s||void 0===s?void 0:s.message}))}}),{actions:pe,reducer:me}=he,xe=(0,oe.hg)("newTopic/post",(async e=>{let t={message_text:e.text,topic_text:e.subject,target_section:String(e.section),target_forum:e.forum.toLowerCase(),action:"new",rnd:Math.round(1e10*Math.random()),voting:e.isVoting?1:0};if(e.votingItems)for(let s=0;s<e.votingItems.length;s++)t["section".concat(s+1)]=e.votingItems[s];await(async e=>{await fetch("".concat(Y,"/").concat(Q),{method:"POST",body:L("",e),mode:"no-cors",credentials:"include",headers:{"Content-Type":"application/x-www-form-urlencoded"}})})(t)})),ge=e=>{e.status="init",e.text="",e.subject="",e.forum="",e.isVoting=!1},fe=(0,oe.oM)({name:"newTopic",initialState:{status:"init",section:null,text:"",subject:"",forum:"1C",isVoting:!1},reducers:{clear:ge,changeSubject:(e,t)=>{let{payload:s}=t;e.subject=s},changeText:(e,t)=>{let{payload:s}=t;e.text=s},changeSection:(e,t)=>{let{payload:s}=t;e.section=s,e.forum=null===s||void 0===s?void 0:s.forum.toLowerCase()},showVoting:(e,t)=>{let{payload:s}=t;e.isVoting=s},setError:(e,t)=>{let{payload:s}=t;e.error=s}},extraReducers:e=>{e.addCase(xe.pending,(e=>{e.status="loading",delete e.error})).addCase(xe.fulfilled,(e=>{ge(e),delete e.error})).addCase(xe.rejected,((e,t)=>{let{error:s}=t;e.status="error",e.error=null===s||void 0===s?void 0:s.message}))}}),{actions:ve,reducer:je}=fe,ye={voteColors:["#FF1616","#1A861A","#0023FF","#FF6B18","#9B3A6E","#567655","#233345","#CC0000","#00CCCC","#0000CC"],items:{theme:"lightgray",topicsPerPage:"20",autoRefreshTopicsList:"false",autoRefreshTopicsListInterval:"60",autoRefreshTopic:"true",autoRefreshTopicInterval:"60",showTooltips:"true",tooltipDelay:"500",showTooltipOnPostLink:"true",showYoutubeVideoTitle:"true",replaceCatalogMista:"true",fixBrokenLinks:"true"}},be=(0,oe.oM)({name:"options",initialState:ye,reducers:{save:(e,t)=>{let{payload:s}=t;for(let a in s){const t=String(s[a]);e.items[a]=t}}}}),{actions:Ne,reducer:we}=be,Ie=(0,oe.oM)({name:"tooltips",initialState:{items:[]},reducers:{show:(e,t)=>{let{payload:s}=t;const a=JSON.stringify(s.keys),n=e.items.findIndex((e=>e.hash===a));let r=0;e.items.length&&(r=e.items[e.items.length-1].zIndex+1),-1===n?e.items.push({keys:s.keys,coords:s.coords,hash:a,zIndex:r}):e.items[e.items.length-1].zIndex=r},close:(e,t)=>{let{payload:s}=t;const a=JSON.stringify(s);e.items=e.items.filter((e=>e.hash!==a))},closeAll:e=>{e.items=[]}}}),{actions:ke,reducer:Ce}=Ie,Se=async e=>{let t,{topicId:s,page:a,item0:n}=e;try{t=await R(s)}catch(c){console.error(c),t={id:s,title:"",count:-1}}let[r,i]=((e,t)=>{if("last20"===t)return-1===e?[0,1010]:[Math.max(0,e-19),e];const s=C(t,1)-1;return[100*s,100*s+99]})(t.count,a);0===r&&n&&(r=1);let o=await U({id:s,from:r,to:i}),l=n;return l=0===r?o.shift():await V(s,0),0===t.count&&o.length>0&&(t.count=o[o.length-1].n),"last20"===a&&o.length>20&&(o=o.slice(-20)),{info:t,item0:l,list:o}},Te=(0,oe.hg)("newMessage/post",(async e=>{let t={message_text:e.text,action:"new",topic_id:e.topicId,rnd:Math.round(1e10*Math.random())};e.voting_select&&(t.voting_select=e.voting_select),await(async e=>{const t=G.replace(":id",e.topic_id),s={method:"POST",body:L("",e),mode:"no-cors",credentials:"include",headers:{Accept:"text/html,application/xhtml+xml,application/xml","Content-Type":"application/x-www-form-urlencoded"},redirect:"follow"};return await fetch("".concat(Y,"/").concat(t),s)})(t)})),_e=(0,oe.oM)({name:"newMessage",initialState:{status:"init",text:""},reducers:{changeText:(e,t)=>{let{payload:s}=t;e.text=s}},extraReducers:e=>{e.addCase(Te.pending,(e=>{e.status="loading",delete e.error})).addCase(Te.fulfilled,(e=>{e.text="",delete e.error})).addCase(Te.rejected,((e,t)=>{let{error:s}=t;e.status="error",e.error=null===s||void 0===s?void 0:s.message}))}}),{actions:Ze,reducer:Me}=_e,Le=(e,t)=>{let{topicId:s}=e;const[a]=(0,l.lr)(),n=a.get("page");return(0,b.a)((0,y.Z)({queryKey:[ee.TopicMessages,s,n],queryFn:e=>{let{client:t}=e;const a=Oe(t,s);return Se({topicId:s,page:n,item0:null===a||void 0===a?void 0:a.item0})},placeholderData:e=>e},t))},Pe=(e,t)=>{let{topicId:s}=e;const[a]=(0,l.lr)(),n=a.get("page");return(0,b.a)((0,y.Z)({queryKey:[ee.UpdateTopicMessages,s],queryFn:async e=>{let{client:t}=e;const a=Oe(t,s);if(!a)return!0;const r=await U({id:s,from:a.info.count+1,to:1050});return 0===r.length||t.setQueryData([ee.TopicMessages,s,n],(e=>({info:(0,y.Z)((0,y.Z)({},e.info),{},{count:r.at(-1).n}),item0:e.item0,list:[...e.list,...r]}))),!0},initialData:!0,refetchOnMount:!1},t))},Oe=(e,t)=>{const s=e.getQueriesData({queryKey:[ee.TopicMessages,t]});if(0!==s.length)return s[0][1]},De=()=>{const e=(0,h.TH)(),[t]=(0,l.lr)(),s=t.get("forum"),{refetch:a}=ie({searchParams:t},{enabled:!1});return(0,v.jsxs)(c.Z,{bg:"dark",variant:"dark",expand:"md",fixed:"top",children:[(0,v.jsx)(c.Z.Brand,{as:l.rU,to:"/",onClick:s=>{"/"===e.pathname&&0===t.size&&(s.preventDefault(),a())},children:"React.Mista"}),(0,v.jsx)(c.Z.Toggle,{"aria-controls":"basic-navbar-nav"}),(0,v.jsxs)(c.Z.Collapse,{children:[(0,v.jsxs)(d.Z,{className:"me-auto",children:[[{name:"1C",link:"/index.php?forum=1C"},{name:"IT",link:"/index.php?forum=IT"},{name:"JOB",link:"/index.php?forum=JOB"},{name:"LIFE",link:"/index.php?forum=LIFE"},{name:"\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438",link:"/options.php"}].map(((e,t)=>(0,v.jsx)(d.Z.Item,{children:(0,v.jsx)(d.Z.Link,{to:e.link,active:e.name===s,as:l.rU,children:e.name})},"i"+t))),[{name:"Wiki",link:"https://wiki.mista.ru"},{name:"\u041a\u043d\u0438\u0433\u0430 \u0437\u043d\u0430\u043d\u0438\u0439",link:"https://kb.mista.ru"}].map(((e,t)=>(0,v.jsx)(d.Z.Item,{children:(0,v.jsx)(d.Z.Link,{href:e.link,children:e.name})},"e"+t)))]}),(0,v.jsx)(u.Z,{className:"d-flex",children:(0,v.jsx)(j,{})})]})]})};var Fe=s(7262),Ee=s(2540);const Re={key:"options",storage:s(5752).Z},ze=(0,se.UY)({options:(0,Ee.OJ)(Re,we),login:me,tooltips:Ce,newTopic:je,newMessage:Me}),Ue=(0,oe.xC)({reducer:ze,middleware:e=>e({serializableCheck:{ignoredActions:[Ee._P,Ee.I2,Ee.E7,Ee.ex,Ee.e,Ee.Nz]}}),devTools:!1}),Ve=(0,Ee.p5)(Ue),Ae=o.forwardRef(((e,t)=>{let{children:s,onClick:a}=e;return(0,v.jsx)("span",{ref:t,style:{cursor:"pointer"},className:"link",onClick:e=>{e.preventDefault(),a(e)},children:s})})),We=e=>{let{userId:t,userName:s}=e;const a=re(pe);return(0,v.jsx)("div",{style:{float:"left"},children:(0,v.jsxs)(x.Z,{id:"dropdown-custom-menu",onSelect:(e,t)=>{"exit"===e&&(e=>{e.preventDefault(),a.doLogout()})(t)},children:[(0,v.jsx)("span",{children:"\u041f\u0440\u0438\u0432\u0435\u0442, "}),(0,v.jsxs)(x.Z.Toggle,{as:Ae,children:[s," \u25bc"]}),(0,v.jsxs)(x.Z.Menu,{children:[(0,v.jsx)(x.Z.Item,{eventKey:"profile",href:"".concat(Y,"/users.php?id=").concat(t),children:"\u041f\u0440\u043e\u0444\u0438\u043b\u044c"}),(0,v.jsx)(x.Z.Item,{eventKey:"myTopics",href:"#/index.php?user_id=".concat(t),children:"\u041c\u043e\u0438 \u0442\u0435\u043c\u044b"}),(0,v.jsx)(x.Z.Divider,{}),(0,v.jsx)(x.Z.Item,{eventKey:"options",href:"#/options.php",children:"\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438"}),(0,v.jsx)(x.Z.Divider,{}),(0,v.jsx)(x.Z.Item,{eventKey:"exit",children:"\u0412\u044b\u0445\u043e\u0434"})]})]})})};var Ye=s(3360);const Be=()=>{const e=ae(),[t,s]=(0,o.useState)(""),[a,n]=(0,o.useState)("");return(0,v.jsxs)("div",{children:[(0,v.jsxs)("form",{name:"enterform",className:"flex-row",style:{flexWrap:"wrap"},children:[(0,v.jsx)(m.Z,{id:"username",type:"text",placeholder:"\u0418\u043c\u044f",value:t,onChange:e=>s(e.target.value),size:"sm",className:"input",style:{marginRight:"5px",flex:"0 1 300px"}}),(0,v.jsx)(m.Z,{id:"password",type:"password",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",maxLength:20,autoComplete:"off",value:a,onChange:e=>n(e.target.value),size:"sm",className:"input",style:{marginRight:"5px",flex:"0 1 300px"}}),(0,v.jsx)(Ye.Z,{size:"sm",variant:"light",className:"button",onClick:s=>{s.preventDefault(),e(((e,t)=>(s,a)=>{if(ue(a()))return s(ce({username:e,password:t}))})(t,a))},children:"\u0412\u043e\u0439\u0442\u0438"})]}),(0,v.jsxs)("p",{style:{margin:"0px"},children:["\u0412\u043e\u0439\u0442\u0438 \u043c\u043e\u0436\u043d\u043e \u043d\u0430 \u0441\u0430\u0439\u0442\u0435"," ",(0,v.jsx)("a",{href:"https://forum.mista.ru/",children:"forum.mista.ru"})]}),(0,v.jsx)("a",{rel:"nofollow",href:"https://forum.mista.ru/user_registration.php",children:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"}),(0,v.jsx)("span",{style:{margin:"5px"},children:"|"}),(0,v.jsx)("a",{rel:"nofollow",href:"https://forum.mista.ru/remember_password.php",children:"\u0417\u0430\u0431\u044b\u043b\u0438 \u043f\u0430\u0440\u043e\u043b\u044c?"})]})},He=e=>{let{text:t}=e;return t?(0,v.jsx)("div",{className:"error",dangerouslySetInnerHTML:{__html:t}}):null},qe=()=>{const e=ae(),t=ne((e=>e.login.logged)),s=ne((e=>e.login.userId)),a=ne((e=>e.login.userName)),n=ne((e=>e.login.error));return(0,o.useEffect)((()=>{e(((e,t)=>{if(ue(t()))return e(le())}))}),[e]),(0,v.jsxs)(v.Fragment,{children:[t?(0,v.jsx)(We,{userId:s,userName:a}):(0,v.jsx)(Be,{}),n&&(0,v.jsx)(He,{text:n})]})},Ke=e=>{let{id:t,defaultValue:s,selected:a,style:n,size:r,onChange:i}=e;const{data:o}=te();return(0,v.jsxs)(u.Z.Select,{"aria-label":"\u0421\u0435\u043a\u0446\u0438\u044f",onChange:e=>{if(!i)return;const t=e.currentTarget.value,s=o.items.find((e=>e.code===t));i(e,s)},value:a,style:n,className:"input",size:r,id:t,children:[(0,v.jsx)("option",{value:"",children:s}),Object.keys(o.tree).map((e=>(0,v.jsx)("optgroup",{label:e,children:o.tree[e].map((e=>(0,v.jsx)("option",{value:e.code,children:e.name},e.id)))},e)))]})},Je=()=>{var e;const[t,s]=(0,l.lr)();return(0,v.jsxs)("div",{className:"flex-row",children:[(0,v.jsx)("div",{className:"header-left",children:(0,v.jsx)(qe,{})}),(0,v.jsx)("div",{className:"header-right",children:(0,v.jsx)(Ke,{id:"sect",defaultValue:"--\u0412\u0441\u0435 \u0441\u0435\u043a\u0446\u0438\u0438--",selected:null!==(e=t.get("section"))&&void 0!==e?e:"",onChange:(e,t)=>{s((e=>{const s=new URLSearchParams(e);return t?s.set("section",t.code):s.delete("section"),s}))},size:"sm"})})]})},Xe=e=>{let{isLoading:t,onUpdateClick:s}=e;return(0,v.jsxs)("div",{className:"table-header",children:[(0,v.jsx)("div",{style:{letterSpacing:"-1px"},children:"\u0420\u0430\u0437\u0434\u0435\u043b"}),(0,v.jsx)("div",{}),(0,v.jsx)("div",{children:"\u0422\u0435\u043c\u0430"}),(0,v.jsx)("div",{children:"Re"}),(0,v.jsx)("div",{children:"\u0410\u0432\u0442\u043e\u0440"}),(0,v.jsx)("div",{children:(0,v.jsx)("span",{style:{cursor:"pointer"},title:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a",onClick:s,children:t?"\u041e\u0431\u043d\u043e\u0432\u043b\u044f\u0435\u0442\u0441\u044f":"\u041e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u043e"})})]})},$e=e=>{let{item:t}=e;return(0,v.jsx)("div",{className:"cell-author",children:(0,v.jsxs)("div",{className:"cell-author--inner",children:[(0,v.jsx)("i",{"aria-hidden":"true",className:"fa fa-user-circle",style:{marginRight:"3px"}}),t.author]})})},Ge=e=>{let{item:t,onClick:s}=e;return(0,v.jsx)("div",{className:"cell-answ",onClick:s,children:(0,v.jsxs)("div",{className:"cell-answ--inner",children:[(0,v.jsx)("i",{className:"fa fa-comments-o","aria-hidden":"true",style:{marginRight:"3px"}}),(0,v.jsx)("span",{children:t.count})]})})},Qe=e=>{let{item:t}=e;return(0,v.jsx)("div",{className:"cell-forum",children:(0,v.jsx)("div",{className:"cell-forum--inner",children:t.forum})})},et=e=>{let{item:t}=e;return(0,v.jsx)("div",{className:"cell-last20",children:(0,v.jsx)(l.rU,{to:"/topic.php?id=".concat(t.id,"&page=last20#F"),style:{color:"inherit",display:"block",width:"100%",textAlign:"center"},children:(0,v.jsx)("i",{className:"fa fa-angle-right","aria-hidden":"true"})})})},tt=e=>{let{item:t}=e;const[s,a]=(0,o.useState)(t.updated);return(0,o.useEffect)((()=>{if(!t.pinned)return;(async()=>{const e=await V(t.id,t.count);a(e.time)})()}),[t.pinned,t.id,t.count]),(0,o.useEffect)((()=>{a(t.updated)}),[t.updated]),(0,v.jsx)("div",{className:"cell-lastuser",children:(0,v.jsxs)("div",{className:"cell-author--inner",children:[(0,v.jsx)("span",{className:"cell-lastuser-time",children:M(s)}),(0,v.jsx)("span",{className:"cell-lastuser-user",children:t.lastUser})]})})},st=e=>{let{expanded:t,onClick:s}=e;return(0,v.jsx)("div",{className:"cell-preview-link",onClick:s,children:(0,v.jsx)("span",{children:t?(0,v.jsx)("i",{className:"fa fa-minus-square-o agh","aria-hidden":"true"}):(0,v.jsx)("i",{className:"fa fa-plus-square-o agh","aria-hidden":"true"})})})};var at=s(1418),nt=s.n(at);const rt=e=>{let{count:t,topicId:s}=e,a=[];if(t>100){let e=_(t);for(let t=1;t<=e;t++)a.push((0,v.jsx)(l.rU,{className:"agh",style:{margin:"3px"},to:"/topic.php?id=".concat(s,"&page=").concat(t),children:t>3&&t<e?"\u2022":String(t)},t))}return t>20&&a.push((0,v.jsx)(l.rU,{className:"agh",style:{margin:"3px"},to:"/topic.php?id=".concat(s,"&page=last20#F"),children:"\xbb"},"last20")),(0,v.jsx)("span",{className:"topic-pages",children:a})},it=e=>{let{data:t}=e;const s=ne((e=>e.login.userName));let a=((e,t,s)=>"life"!==t||e.startsWith("OFF")?"job"!==s||e.startsWith("JOB")?"v7"!==s||e.startsWith("v7")?e:"v7: "+e:"JOB: "+e:"OFF: "+e)(t.text,t.forum,t.sectionCode);return(0,v.jsx)("div",{className:"cell-title",children:(0,v.jsxs)("div",{className:"cell-title--inner",children:[t.pinned&&(0,v.jsx)("i",{className:"fa fa-thumb-tack agh","aria-hidden":"true",style:{marginRight:"5px"}}),(0,v.jsx)(l.rU,{to:"/topic.php?id=".concat(t.id),className:nt()("agb","mr5",{bold:t.count>=100,mytopics:t.author===s,pinned:t.pinned}),dangerouslySetInnerHTML:{__html:a},style:{overflowWrap:"anywhere"}}),t.isVoting&&(0,v.jsx)("span",{className:"agh separator",children:"[\xb1]"}),(0,v.jsx)(rt,{count:t.count,topicId:t.id}),t.closed&&(0,v.jsx)("span",{className:"agh",children:"\xd8"}),t.down&&(0,v.jsx)("span",{className:"agh",children:"\u2193"}),t.section&&(0,v.jsxs)("span",{className:"topic-section",children:[(0,v.jsx)("span",{className:"agh",style:{margin:"0px 5px"},children:"/"}),(0,v.jsx)(l.rU,{rel:"nofollow",className:"agh",to:"/index.php?section=".concat(t.sectionCode),children:t.section},"1")]})]})})};var ot=s(3892);const lt=e=>{let{topicId:t,onFirst:s,onPrev:a,onNext:n,onLast:r,close:i}=e;return(0,v.jsxs)("div",{className:"topic-preview-rewind",children:[(0,v.jsx)("div",{className:"topic-preview-button flex-small",onClick:s,title:"\u041a \u043f\u0435\u0440\u0432\u043e\u043c\u0443",children:(0,v.jsx)("i",{className:"fa fa-angle-double-left","aria-hidden":"true"})}),(0,v.jsx)("div",{className:"topic-preview-button flex-large",onClick:a,title:"\u041a \u043f\u0440\u0435\u0434\u044b\u0434\u0443\u0449\u0435\u043c\u0443",children:(0,v.jsx)("i",{className:"fa fa-angle-left","aria-hidden":"true"})}),(0,v.jsx)("div",{className:"topic-preview-button flex-large",onClick:n,title:"\u041a \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0435\u043c\u0443",children:(0,v.jsx)("i",{className:"fa fa-angle-right","aria-hidden":"true"})}),(0,v.jsx)("div",{className:"topic-preview-button flex-small",onClick:r,title:"\u041a \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0435\u043c\u0443",children:(0,v.jsx)("i",{className:"fa fa-angle-double-right","aria-hidden":"true"})}),(0,v.jsxs)("div",{className:"topic-preview-button close-preview",onClick:i,children:[(0,v.jsx)("i",{className:"fa fa-angle-right","aria-hidden":"true"}),(0,v.jsx)("i",{className:"fa fa-angle-left","aria-hidden":"true",style:{marginLeft:"-2px"}})]}),(0,v.jsx)("div",{className:"topic-preview-button edit-preview",children:(0,v.jsx)(l.rU,{to:"/topic.php?id=".concat(t,"&page=last20#F"),children:(0,v.jsx)("i",{className:"fa fa-pencil","aria-hidden":"true",style:{color:"var(--font-color)"}})})})]})},ct=e=>{let{topicId:t,data:s,total:a,n:n,colors:r}=e;const i="".concat(Y,"/css/voting").concat(n,".png"),o=a?Math.round(100*s.count/a):0;return(0,v.jsxs)("li",{className:"voting-item",children:[(0,v.jsx)("div",{className:"voting-title",children:(0,v.jsx)("a",{rel:"nofollow",style:{textDecoration:"none"},href:"#/topic.php?id=".concat(t,"&sel=").concat(n),children:(0,v.jsx)("b",{children:(0,v.jsx)("span",{style:{color:r[n-1]},children:"".concat(n,". ").concat(s.text)})})})}),(0,v.jsx)("div",{className:"voting-percentage",children:(0,v.jsx)("b",{children:(0,v.jsx)("span",{style:{color:r[n-1]},children:"".concat(o,"% (").concat(s.count,")")})})}),(0,v.jsx)("div",{className:"voting-bar",children:(0,v.jsx)("div",{style:{width:"".concat(o,"%")},children:(0,v.jsx)("a",{href:i,children:(0,v.jsx)("img",{src:i,style:{maxWidth:"500px",width:"100%",height:"15px"},alt:"\u0432\u0430\u0440\u0438\u0430\u043d\u0442 ".concat(n)})})})})]})},dt=e=>{let{items:t,topicId:s,colors:a}=e,n=Math.max(...t.map((e=>e.count)));return(0,v.jsx)("ul",{style:{paddingLeft:0},children:t.filter((e=>e.text)).map(((e,t)=>(0,v.jsx)(ct,{data:e,total:n,n:t+1,topicId:s,colors:a},t)))})},ut=(0,o.memo)((e=>{let{colors:t,n:s,text:a}=e;return(0,v.jsx)("div",{style:{marginTop:"5px"},children:(0,v.jsx)("b",{children:(0,v.jsx)("span",{style:{color:t[s-1]},children:"".concat(s,". ").concat(a)})})})}));var ht=s(5930),pt=s(1947),mt=s.n(pt);const xt=function(e){const t=new Set("if|\u0435\u0441\u043b\u0438|then|\u0442\u043e\u0433\u0434\u0430|elsif|\u0438\u043d\u0430\u0447\u0435\u0435\u0441\u043b\u0438|else|\u0438\u043d\u0430\u0447\u0435|endif|\u043a\u043e\u043d\u0435\u0446\u0435\u0441\u043b\u0438|do|\u0446\u0438\u043a\u043b|for|\u0434\u043b\u044f|to|\u043f\u043e|each|\u043a\u0430\u0436\u0434\u043e\u0433\u043e|in|\u0438\u0437|while|\u043f\u043e\u043a\u0430|enddo|\u043a\u043e\u043d\u0435\u0446\u0446\u0438\u043a\u043b\u0430|procedure|\u043f\u0440\u043e\u0446\u0435\u0434\u0443\u0440\u0430|endprocedure|\u043a\u043e\u043d\u0435\u0446\u043f\u0440\u043e\u0446\u0435\u0434\u0443\u0440\u044b|function|\u0444\u0443\u043d\u043a\u0446\u0438\u044f|endfunction|\u043a\u043e\u043d\u0435\u0446\u0444\u0443\u043d\u043a\u0446\u0438\u0438|var|\u043f\u0435\u0440\u0435\u043c|export|\u044d\u043a\u0441\u043f\u043e\u0440\u0442|goto|\u043f\u0435\u0440\u0435\u0439\u0442\u0438|and|\u0438|or|\u0438\u043b\u0438|not|\u043d\u0435|val|\u0437\u043d\u0430\u0447|break|\u043f\u0440\u0435\u0440\u0432\u0430\u0442\u044c|continue|\u043f\u0440\u043e\u0434\u043e\u043b\u0436\u0438\u0442\u044c|return|\u0432\u043e\u0437\u0432\u0440\u0430\u0442|try|\u043f\u043e\u043f\u044b\u0442\u043a\u0430|except|\u0438\u0441\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435|endtry|\u043a\u043e\u043d\u0435\u0446\u043f\u043e\u043f\u044b\u0442\u043a\u0438|raise|\u0432\u044b\u0437\u0432\u0430\u0442\u044c\u0438\u0441\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435|false|\u043b\u043e\u0436\u044c|true|\u0438\u0441\u0442\u0438\u043d\u0430|undefined|\u043d\u0435\u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u043e|null|new|\u043d\u043e\u0432\u044b\u0439|execute|\u0432\u044b\u043f\u043e\u043b\u043d\u0438\u0442\u044c|\u0430\u0441\u0438\u043d\u0445|async|\u0436\u0434\u0430\u0442\u044c|wait".split("|")),s=new Set("():;.,=+-*<>?[]%/".split("")),a="<span class=",n="</span>",r="bg>",i="num>",o="str>",l="key>";let c,d,u,h=!1,p="";function m(e){return""===e.trim()}function x(e,t,s){return e.substring(t-1,t-1+s)}function g(e,t){return e.substring(e.length-t)}function f(e){return t.has(e.toLowerCase().trim())}function v(e,t){" "===e||u===t?c+=e:(d&&(c+=n,d=!1),c=c+a+t+e,d=!0,u=t)}function j(e){let t=!1,a=!1,n=1,d=!0,j=1;for(j=1;j<=e.length;j++){let y=e.charAt(j-1);if(h)'"'===y?(v(x(e,n,j-n+1),o),h=!1,p="",d=!0):p+=y;else if(t)"'"===y?(v(x(e,n,j-n+1),o),t=!1,p="",d=!0):p+=y;else if(" "===y)m(p)?c+=" ":(a?(v(p+" ",o),a=!1):f(p.trim())?v(p+" ",l):isNaN(parseInt(p,10))?v(p+" ",r):v(p+" ",i),p=""),d=!0;else if(s.has(y)){if(m(p)||(a?(v(p,o),a=!1,d="."!==y):d&&f(p)?(v(p,l),d="."!==y):(isNaN(parseInt(p,10))?v(p,r):v(p,i),d="."!==y),p=""),"."===y&&u===i){v(y,i);continue}if("="===y&&"<"===x(e,j-1,1))u=void 0;else if("/"===y&&"/"===x(e,j+1,1))return void v(g(e,e.length-j+1),"com>");v(y,"sp>")}else if('"'===y||"|"===y)m(p)?(n=j,h=!0):(v(p+y,o),p=""),d=!0;else if("'"===y)m(p)?(n=j,t=!0):(v(p+y,o),p=""),d=!0;else{if("#"===y||"&"===y&&m(c)){v(g(e,e.length-j+1),"pr>"),j=e.length;break}"~"===y?(p+=y,a=!0):p+=y}}h||t?v(x(e,n,j-n+1),o):m(p)||(f(p)?v(p,l):isNaN(parseInt(p,10))?v(p,r):v(p,i))}h=!1,p="",d=!1,u=void 0,c="";let y=[];for(let b of e.split("\n"))m(b)?y.push(""):(c="",j(b),d&&!h?(c+="</span>",d=!1,u="",p=""):h||(u="",p=""),y.push(c));return y.join("\n")},gt=e=>{let{children:t}=e;const[s,a]=(0,o.useState)(!0),[n,r]=(0,o.useMemo)((()=>{if(!t)return["",0];let e=Z(t).join("");return e=(e=>{let t=e.replace(/\n<br>/g,"\n").replace(/<br>\n/g,"\n").replace(/\r<br>/g,"\n").replace(/<br>\r/g,"\n").replace(/<br>/g,"\n").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt");return t=(e=>{let t=0,s=e.length;for(;t<s&&("\n"===e[t]||"\r"===e[t]);)t++;for(;s>t&&("\n"===e[s-1]||"\r"===e[s-1]);)s--;return e.substring(t,s)})(t),xt(t)})(e),[e,e.split("\n").length]}),[t]);let i={};return s&&r>7?(i.overflow="hidden",i.height="135px"):(i.overflow="auto",i.height="auto"),(0,v.jsxs)("div",{style:{marginTop:"5px"},children:[(0,v.jsx)("pre",{className:"code-pre",style:i,dangerouslySetInnerHTML:{__html:n}}),r>7&&(0,v.jsx)("div",{className:"expand-button-div",children:(0,v.jsx)("span",{className:"expand-button-span",onClick:()=>{a((e=>!e))},children:s?"\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c: ".concat(r," \u0441\u0442\u0440\u043e\u043a"):"\u0421\u043a\u0440\u044b\u0442\u044c"})})]})},ft=e=>{let{topicId:t,number:s,children:a,style:n}=e;const r=(0,o.useRef)(null),i=re(ke),[c]=(0,l.lr)(),d=C(c.get("id"),-1),u=ne((e=>+e.options.items.tooltipDelay));let h="";h=a?Z(a).join(""):String(s);const[p,m]=(0,o.useState)(h);(0,o.useEffect)((()=>{let e=!0;if(!h.startsWith("http"))return void m(h);return(async()=>{const{title:s}=await R(t);e&&m(s)})(),()=>{e=!1}}),[h,t]);const x=e=>{e.persist(),r.current=setTimeout((()=>j(e)),u)},g=()=>{r.current&&clearTimeout(r.current)},f=e=>{e.stopPropagation(),r.current&&clearTimeout(r.current),j(e)},j=e=>{const a={x:e.pageX,y:e.pageY-50},n={topicId:+t,number:+s};i.show({keys:n,coords:a})};if(t!==d&&isNaN(+p)){const e=_(s);let a="";return e>1&&(a="&page=".concat(e)),(0,v.jsxs)("span",{children:[(0,v.jsx)("a",{href:"#/topic.php?id=".concat(t).concat(a,"#").concat(s),style:(0,y.Z)({},n),children:p})," ","(",(0,v.jsx)("span",{onMouseOver:x,onMouseOut:g,onClick:f,className:"link",role:"button",children:s}),")"]})}return(0,v.jsx)("span",{onMouseOver:x,onMouseOut:g,onClick:f,className:"link",style:(0,y.Z)({},n),role:"button",children:p})};var vt=s(5987),jt=s(5915),yt=s.n(jt);const bt=e=>{let{href:t,children:s}=e;return(0,v.jsx)("a",{href:t,className:"registered-user",children:s})},Nt=e=>{let{href:t}=e,[s,a]=(0,o.useState)(t),[n,r]=(0,o.useState)("");(0,o.useEffect)((()=>{const e=new AbortController;return(async()=>{const s=(e=>{let t=e;-1===e.search(/http/)&&(t="http://"+t);try{var s=new URL(t)}catch(a){return null}return-1!==s.hostname.search(/youtube/)?s.searchParams.get("v"):-1!==s.hostname.search(/youtu\.be/)?s.pathname.substring(1):null})(t);if(s)try{const n=await(async(e,t)=>{const s=localStorage.getItem("youtubeApiKey")||"AIzaSyCztN2QW4Fxw_1YuAHBTOZdYLbzigPz25g";let a="https://www.googleapis.com/youtube/v3/videos?key=".concat(s,"&fields=items(snippet(title))&part=snippet&id=").concat(e);const n=await fetch(a,{signal:t}),r=await n.json();if(0===r.items.length)return{hrefName:"",title:"",notFound:!0};const i=r.items[0].snippet.title;let o=i;return i.length>55&&(o=o.substring(0,50)+"..."),{hrefName:o,title:i,notFound:!1}})(s,e.signal);n.notFound?a(t+" (\u0432\u0438\u0434\u0435\u043e \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e)"):(a(n.hrefName),r(n.title))}catch(n){console.error("youtube",s,n.message)}})(),()=>e.abort()}),[t]);return(0,v.jsx)("a",{href:t,title:n,children:"".concat("youtube",": ").concat(s)})},wt=["href","children","parentText"],It=e=>{let{href:t,children:s,parentText:a}=e,n=(0,vt.Z)(e,wt);const r=ne((e=>"true"===e.options.items.showYoutubeVideoTitle)),i=ne((e=>"true"===e.options.items.replaceCatalogMista)),o=ne((e=>"true"===e.options.items.fixBrokenLinks));try{var l=new(yt())(t,!0)}catch(u){return console.error(u.message,t),(0,v.jsx)("a",{href:t,children:t})}let c=t;if(c.startsWith("/")&&(l.set("protocol","https"),l.set("hostname","forum.mista.ru"),c=l.href),-1!==l.hostname.search(/forum\.mista.ru/)){if("/topic.php"===l.pathname)return(0,v.jsx)(ft,{topicId:l.query.id,number:l.hash.replace("#","")||"0",children:Z(s)});if("/users.php"===l.pathname)return(0,v.jsx)(bt,{href:l.href,children:s})}return"a-sitnikov.github.io"===l.hostname&&"/react.mista/"===l.pathname&&0===Object.keys(l.query).length&&"/react.mista/topic.php"===(l=new(yt())(t.replace(/#\//,""),!0)).pathname?(0,v.jsx)(ft,{topicId:l.query.id,number:l.hash.replace("#","")||"0",children:Z(s)}):!r||-1===(d=l.hostname).search(/youtube/)&&-1===d.search(/youtu\.be/)?i&&(e=>-1!==e.search(/catalog\.mista/))(l.hostname)?(l.set("hostname","infostart.ru"),(0,v.jsxs)("a",{target:null===n||void 0===n?void 0:n.target,className:null===n||void 0===n?void 0:n.class,rel:null===n||void 0===n?void 0:n.rel,href:l.href,children:[l.href," "]})):(o&&a&&(c=((e,t)=>{let s=e.replace(/\[/g,"\\[").replace(/\]/g,"\\]").replace(/\./g,"\\.").replace(/\./g,".").replace(/\*/g,"\\*").replace(/\+/g,"\\+").replace(/\(/g,"\\(").replace(/\)/g,"\\)").replace(/\?/g,"\\?").replace(/\//g,"\\/");try{let a=new RegExp(s+"<\\/a>(\\)|[\u0430-\u044f\u0451\u0410-\u042f\u04010-9#\\-\\+\\_\\%\\?=]*)"),n=t.match(a);if(n&&n.length>1)return")"===n[1]&&-1===e.search("\\(")?e:e+=n[1]}catch(u){console.error(u)}return e})(c,a)),(0,v.jsx)("a",{target:null===n||void 0===n?void 0:n.target,className:null===n||void 0===n?void 0:n.class,rel:null===n||void 0===n?void 0:n.rel,href:c,children:s})):(0,v.jsx)(Nt,{href:t});var d};s(432);const kt=e=>{let{idx:t,topicId:s,topicDate:a,messageNumber:n}=e;const r=k()(a).format("YYYY/MM/DD"),i="https://forum.mista.ru/topics/files/".concat(r,"/").concat(s,"/").concat(n),o="".concat(i,"/").concat(t,"_preview.png"),l="".concat(i,"/").concat(t,".png");return(0,v.jsx)(ht.HI,{src:l,children:(0,v.jsx)("img",{src:o,alt:"",style:{maxWidth:"100%",cursor:"pointer"}})})},Ct=(0,o.memo)(kt),St=mt().Parser(),Tt=mt().ProcessNodeDefinitions(),_t=()=>!0,Zt={shouldProcessNode:e=>"link"===(null===e||void 0===e?void 0:e.name),processNode:(e,t,s)=>{const a=e.attribs["data-topicid"],n=e.attribs["data-number"];return(0,v.jsx)(ft,{topicId:a,number:n},s)}},Mt={shouldProcessNode:e=>"code"===(null===e||void 0===e?void 0:e.name)||"pre"===(null===e||void 0===e?void 0:e.name),processNode:(e,t,s)=>(0,v.jsx)(gt,{children:t},s)},Lt=e=>({shouldProcessNode:e=>"a"===(null===e||void 0===e?void 0:e.name),processNode:function(t,s,a){const n=t.attribs.href;return(0,v.jsx)(It,{href:n,parentText:e,children:s},a)}}),Pt=(e,t,s)=>({shouldProcessNode:e=>"int_img"===(null===e||void 0===e?void 0:e.name),processNode:function(a,n,r){const i=a.attribs.idx;return(0,v.jsx)(Ct,{topicId:e,topicDate:t,messageNumber:s,idx:i},r)}}),Ot=e=>{let{html:t,topicId:s,topicDate:a,messageNumber:n}=e;const r=((e,t,s,a)=>{if(!e)return e;let n=(e=>e.replace(/\[1[C\u0421]\]/gi,"<code>").replace(/<1[C\u0421]>/gi,"<code>").replace(/\[\/1[C\u0421]\]/gi,"</code>").replace(/<\/1[C\u0421]>/gi,"</code>"))(e);return n=((e,t)=>e.replace(/(\()(\d+)(\))(?![^<>]*<\/)/gi,(function(e){const s=arguments.length<=2?void 0:arguments[2];return"(<link data-topicid='".concat(t,"' data-number='").concat(s,"'></link>)")})))(n,t),n=((e,t,s,a)=>e.replace(/\[IMG_(\d*)\]/gi,(function(e){return"<int_img idx='".concat(arguments.length<=1?void 0:arguments[1],"'></int_img>")})))(n),n})(t,s),i=[Zt,Mt,Lt(r),Pt(s,a,n),{shouldProcessNode:()=>!0,processNode:Tt.processDefaultNode}],o=St.parseWithInstructions(r,_t,i);return(0,v.jsx)(v.Fragment,{children:o})},Dt=(0,o.memo)(Ot),Ft=e=>{let{topicId:t,topicDate:s,n:a,html:n,vote:r,style:i}=e;const{data:l}=Le({topicId:t},{enabled:!1,select:e=>null===e||void 0===e?void 0:e.info}),c=ne((e=>e.options.voteColors));let d=null;r&&l.voting&&t===l.id&&(d=l.voting[r-1].text);const[u,h]=(0,o.useState)(d);(0,o.useEffect)((()=>{r&&!d&&(async()=>{try{const e=await R(t);h(e.voting[r-1].text)}catch(e){console.error(e.message)}})()}),[r,d,t]);const p=0===a&&(null===l||void 0===l?void 0:l.isVoting)&&(null===l||void 0===l?void 0:l.voting),m=0!==r&&null!==u;return(0,v.jsxs)("div",{className:"message",style:i,children:[p&&(0,v.jsx)(dt,{items:l.voting,topicId:t,colors:c}),(0,v.jsx)("div",{children:(0,v.jsx)(ht.TV,{children:(0,v.jsx)(Dt,{html:n,topicId:t,topicDate:s,messageNumber:a})})}),m&&(0,v.jsx)(ut,{text:u,n:r,colors:c})]})},Et=e=>{let{data:t}=e;const[s,a]=(0,o.useState)("none");return(0,o.useEffect)((()=>{a("none")}),[t.n]),window.innerWidth<=768?null:(0,v.jsx)("img",{src:"".concat(Y,"/css/user_icons/").concat(t.userId,"_16x16.png"),alt:"user ico",onLoad:()=>{a("inline")},onError:()=>{a("none")},style:{display:s,marginBottom:"4px",marginRight:"1px"}})},Rt=e=>{let{data:t,isAuthor:s,isYou:a,isTooltip:n}=e;const r=re(Ze);let i=(0,o.useMemo)((()=>{if(t)return 0===t.n?k()(t.time).format("DD.MM.YY - HH:mm"):(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("span",{className:"message-number",children:t.n})," - "+k()(t.time).format("DD.MM.YY - HH:mm")]})}),[t]);const l=nt()("registered-user",{"is-author":s,"is-you":a});return(0,v.jsxs)("div",{className:"user-info",children:[(0,v.jsx)(Et,{data:t}),(0,v.jsx)("a",{className:l,href:"".concat(Y,"/users.php?id=").concat(t.userId),children:t.user}),n?(0,v.jsx)("div",{className:"ah",style:{display:"inline-block",marginLeft:"5px"},children:i}):(0,v.jsxs)("div",{className:"message-time",children:[(0,v.jsx)("span",{className:"ah",children:i}),(0,v.jsx)("button",{className:"button ah",onClick:()=>{r.changeText("(".concat(t.n,")"));let e=document.getElementById("message_text");e&&window.scrollTo(0,e.offsetTop)},children:i})]})]})},zt=e=>{let{topicId:t,n:s,author:a,loggedUserId:n,onDataLoaded:r}=e;const[i,l]=(0,o.useState)(null),[c,d]=(0,o.useState)(null);return(0,o.useEffect)((()=>{(async()=>{try{const e=await V(t,s);e?(l(e),d(null),r&&r()):(l(null),d("\u041d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435 ".concat(s)))}catch(e){l(null),d(e.message)}})()}),[t,s,r]),i||c?(0,v.jsxs)(v.Fragment,{children:[i&&(0,v.jsxs)("div",{className:"preview-content",children:[(0,v.jsx)("div",{className:"topic-preview-userinfo",children:(0,v.jsx)(Rt,{data:i,isAuthor:i.user===a,isYou:i.userId===n,isTooltip:!0})}),(0,v.jsx)(Ft,{topicId:t,topicDate:i.time,n:s,html:i.text,vote:i.vote,style:{overflowY:"auto",overflowWrap:"break-word"}})]}),c&&(0,v.jsx)("span",{children:c})]}):null},Ut=e=>{let{topicId:t,initialMsgNumber:s,author:a,close:n}=e;const r=ne((e=>e.login.userId)),[i,l]=(0,o.useState)(0),[c,d]=(0,o.useState)("none"),[u,h]=(0,o.useState)({msgNumber:s,key:0}),p=(0,ot.QS)({onSwiping:e=>{Math.abs(e.deltaX)<35?l(0):l(e.deltaX)},onSwiped:e=>{Math.abs(e.deltaX)>150&&("Left"===e.dir?h({msgNumber:u.msgNumber+1,key:u.key+1}):"Right"===e.dir&&u.msgNumber>0&&h({msgNumber:u.msgNumber-1,key:u.key+1})),l(0)},delta:15}),m=(0,o.useCallback)((()=>{d("block")}),[]);let x=[u.msgNumber];i<0?x.push(u.msgNumber+1):i>0&&u.msgNumber>0&&x.push(u.msgNumber-1);const g={transform:"translate3d(".concat(i,"px, 0px, 0px)"),flexDirection:i>0?"row-reverse":"row"};return(0,v.jsx)("div",{className:"preview-container",style:{display:c},children:(0,v.jsxs)("div",{className:"topic-preview",children:[(0,v.jsx)(lt,{topicId:t,onFirst:()=>{h({msgNumber:0,key:u.key})},onLast:async()=>{const e=await R(t);h({msgNumber:e.count,key:u.key})},onNext:()=>{h({msgNumber:u.msgNumber+1,key:u.key})},onPrev:()=>{u.msgNumber>0&&h({msgNumber:u.msgNumber-1,key:u.key})},close:n}),(0,v.jsxs)("div",(0,y.Z)((0,y.Z)({className:"preview-carousel"},p),{},{style:g,children:[(0,v.jsx)("div",{className:"preview-carousel-item",style:{order:0},children:(0,v.jsx)(zt,{topicId:t,n:x[0],loggedUserId:r,author:a,onDataLoaded:m})},u.key),x.length>1&&(0,v.jsx)("div",{className:"preview-carousel-item",style:{order:1},children:(0,v.jsx)(zt,{topicId:t,n:x[1],loggedUserId:r,author:a})},u.key+1)]}))]})})},Vt=e=>{let{item:t,isFetching:s}=e;const[a,n]=(0,o.useState)();(0,o.useEffect)((()=>{s&&n(void 0)}),[s]);return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsxs)("div",{className:"topics-list-row",children:[(0,v.jsx)(Qe,{item:t}),(0,v.jsx)("div",{className:"cell-section",children:t.section}),(0,v.jsx)(Ge,{item:t,onClick:()=>{void 0===a||a!==t.count?n(t.count):n(void 0)}}),(0,v.jsx)(st,{expanded:void 0!==a,onClick:()=>{n(void 0===a?0:void 0)}}),(0,v.jsx)(it,{data:t}),(0,v.jsx)($e,{item:t}),(0,v.jsx)(tt,{item:t}),(0,v.jsx)(et,{item:t})]}),void 0!==a&&(0,v.jsx)(Ut,{topicId:t.id,initialMsgNumber:a,author:t.author,close:()=>n(void 0)})]})};var At=s(8116);const Wt=e=>{let{maxPage:t,last20:s}=e;const[a]=(0,l.lr)(),n=T(a.get("page"));let r=[];const i=new URLSearchParams(a);for(let o=1;o<=t;o++)1===o?i.delete("page"):i.set("page",String(o)),r.push((0,v.jsx)(At.Z.Item,{active:n===o,as:l.rU,to:"?"+i.toString(),children:o},o));return!0===s&&(i.set("page","last20"),r.push((0,v.jsx)(At.Z.Item,{active:"last20"===n,as:l.rU,to:"?"+i.toString(),children:"\xbb"},"last20"))),(0,v.jsx)(At.Z,{style:{margin:"0px"},children:r})};var Yt=s(323),Bt=s(6144);const Ht=e=>{let{placeholder:t,showVoting:s,isVoting:a,isFetching:n,text:r,formRef:i,onChange:l,onShowVotingChange:c}=e;const d=(0,o.useRef)(),h=(0,o.useCallback)((e=>{c&&c(e.currentTarget.checked)}),[c]),p=(0,o.useCallback)((e=>{l&&l(e.currentTarget.value)}),[l]);return(0,v.jsxs)("div",{children:[(0,v.jsx)(m.Z,{as:"textarea","aria-label":"\u0421\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435",placeholder:t,cols:70,rows:3,value:r,onChange:p,onKeyUp:e=>{i&&i.current&&"Enter"===e.key&&e.ctrlKey&&i.current.dispatchEvent(new Event("submit",{cancelable:!0,bubbles:!0}))},ref:d,className:"text-editor input","data-lpignore":!0}),(0,v.jsxs)("div",{className:"flex-row",children:[(0,v.jsxs)(Bt.Z,{children:[(0,v.jsx)(Ye.Z,{size:"sm",variant:"light",onClick:e=>{e.preventDefault();const t=d.current,s=t.selectionStart,a=t.selectionEnd,n=t.value,r=n.length,i="[1C]\n"+n.substring(s,a)+"\n[/1C]";let o=n.substring(0,s)+i+n.substring(a,r);l&&l(o)},style:{marginRight:"5px"},className:"button",children:"\u041a\u043e\u0434 1\u0421"}),(0,v.jsx)(Ye.Z,{size:"sm",variant:"light",disabled:n,type:"submit",className:"button",children:n?"\u041e\u0442\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u0442\u0441\u044f":"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c"})]}),s&&(0,v.jsx)(u.Z.Check,{id:"show_voting",type:"checkbox",checked:a,onChange:h,label:"\u0413\u043e\u043b\u043e\u0441\u043e\u0432\u0430\u043d\u0438\u0435",style:{margin:"auto 0px auto auto"}})]})]})},qt=e=>{var t;let{onSubmitSuccess:s}=e;const{data:a}=te(),n=ne((e=>e.newTopic)),[r,i]=(0,o.useState)(null),[l,c]=(0,o.useState)(Array(10).fill("")),d=(0,o.useRef)(null),h=ae(),m=re(ve),x=(0,f.$0)(((e,t)=>{i(t),m.changeSection(t)})),g=e=>t=>{let s=l.slice();s[e]=t.target.value,c(s)},j=(0,f.$0)((e=>{if(e.preventDefault(),!r)return void m.setError("\u041d\u0435 \u0432\u044b\u0431\u0440\u0430\u043d\u0430 \u0441\u0435\u043a\u0446\u0438\u044f");let t=n.subject;if(!t)return void m.setError("\u041d\u0435 \u0443\u043a\u0430\u0437\u0430\u043d\u0430 \u0442\u0435\u043c\u0430");if(!n.text)return void m.setError("\u041d\u0435 \u0443\u043a\u0430\u0437\u0430\u043d\u043e \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435");let s={subject:t,text:n.text,section:r.id,forum:r.forum,isVoting:n.isVoting,votingItems:[],onSuccess:w};if(n.isVoting){s.votingItems=[];for(let e=1;e<=10;e++){let t=l[e-1];t&&s.votingItems.push(t)}}h((e=>(t,s)=>{if((e=>{let{newTopic:t}=e;return!!t&&"loading"!==t.status})(s()))return t(xe(e))})(s))})),y=(0,o.useCallback)((e=>{m.changeSubject(e.target.value)}),[m]),b=(0,o.useCallback)((e=>{m.changeText(e)}),[m]),N=(0,o.useCallback)((e=>{m.showVoting(e)}),[m]),w=()=>{m.clear(),s&&s()};let I=[];for(let o in a.tree)I.push((0,v.jsx)("option",{value:o.toLowerCase(),children:o},o));let k=[];if(n.isVoting){k.push((0,v.jsx)("div",{children:"\u0412\u0430\u0440\u0438\u0430\u043d\u0442\u044b:"},"p"));for(let e=1;e<=10;e++)k.push((0,v.jsxs)(p.Z,{size:"sm",style:{marginBottom:"3px",width:"100%"},children:[(0,v.jsx)(p.Z.Text,{style:{width:"40px"},className:"input",children:"".concat(e,".")}),(0,v.jsx)(u.Z.Control,{type:"text","aria-label":"\u0412\u0430\u0440\u0438\u0430\u043d\u0442 ".concat(e),maxLength:50,className:"input",value:l[e-1],onChange:g(e-1)})]},e))}return(0,v.jsxs)("form",{className:"new-topic-container",onSubmit:j,ref:d,children:[(0,v.jsxs)("div",{id:"newtopic_form",className:"new-topic-text",children:[(0,v.jsx)("div",{children:(0,v.jsx)("b",{children:"\u041d\u043e\u0432\u0430\u044f \u0442\u0435\u043c\u0430:"})}),n.error&&(0,v.jsx)(He,{text:n.error}),(0,v.jsxs)("div",{className:"flex-row",style:{marginBottom:"3px"},children:[(0,v.jsx)(u.Z.Select,{disabled:!0,size:"sm",value:n.forum,style:{flex:"0 1 90px"},className:"input",children:I}),(0,v.jsx)(Ke,{id:"target_section",defaultValue:"\u0421\u0435\u043a\u0446\u0438\u044f",selected:null===(t=n.section)||void 0===t?void 0:t.code,size:"sm",style:{flex:"1 1 auto"},onChange:x})]}),(0,v.jsx)(u.Z.Control,{type:"text","aria-label":"\u0422\u0435\u043c\u0430",placeholder:"\u0422\u0435\u043c\u0430",size:"sm",value:n.subject,onChange:y,style:{marginBottom:"3px"},className:"input",maxLength:90}),(0,v.jsx)(Ht,{placeholder:"\u0421\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435",showVoting:!0,isVoting:n.isVoting,text:n.text,isFetching:"loading"===n.status,onChange:b,onShowVotingChange:N,formRef:d})]}),(0,v.jsx)(Yt.Z,{className:"new-topic-voting",children:k})]})},Kt=()=>{const[e]=(0,l.lr)(),{isFetching:t,data:s,error:a,refetch:n}=ie({searchParams:e});return(0,o.useEffect)((()=>{document.title="React.Mista"}),[]),(0,o.useEffect)((()=>{window.scrollTo(0,0)}),[e]),(0,v.jsxs)("div",{children:[(0,v.jsx)(Je,{}),a&&(0,v.jsx)(He,{text:a.message}),(0,v.jsxs)("div",{className:"topic-list-table",children:[(0,v.jsx)(Xe,{onUpdateClick:n,isLoading:t}),s.map((e=>(0,v.jsx)(Vt,{item:e,isFetching:t},e.id))),(0,v.jsx)("div",{className:"table-footer",children:(0,v.jsx)(Wt,{maxPage:10})})]}),(0,v.jsx)("div",{id:"F",className:"newtopic",style:{marginBottom:"10px",marginTop:"5px",position:"relative"},children:(0,v.jsx)(qt,{onSubmitSuccess:n})})]})},Jt={"1c":"1\u0421:\u041f\u0440\u0435\u0434\u043f\u0440\u0438\u044f\u0442\u0438\u0435",life:"\u041e \u0436\u0438\u0437\u043d\u0438",it:"\u0418\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u043e\u043d\u043d\u044b\u0435 \u0442\u0435\u0445\u043d\u043e\u043b\u043e\u0433\u0438\u0438",job:"\u0420\u0430\u0431\u043e\u0442\u0430"},Xt=e=>{let{topicId:t}=e;const{data:s}=Le({topicId:t},{enabled:!1,select:e=>null===e||void 0===e?void 0:e.info.forum});return(0,v.jsxs)("div",{className:"flex-row",children:[(0,v.jsx)("div",{className:"header-left",children:(0,v.jsx)(qe,{})}),(0,v.jsx)("div",{className:"header-right",children:(0,v.jsx)("span",{id:"forum_string",className:"bold120",children:(0,v.jsx)(l.rU,{to:"/index.php?forum=".concat(s),style:{textDecoration:"none"},children:Jt[s]})})})]})},$t=e=>{let{topicId:t}=e;const{data:s}=Le({topicId:t},{select:e=>null===e||void 0===e?void 0:e.info.title});let a="https://www.yandex.ru/search/?text="+encodeURIComponent(s);return(0,v.jsxs)("div",{className:"topic-row",children:[(0,v.jsx)("div",{className:"cell-userinfo",children:(0,v.jsxs)("div",{className:"topic-tools",children:[(0,v.jsx)("a",{title:"API.info",href:"".concat(Y,"/").concat(H,"?id=").concat(t),className:"agh",style:{display:"block",lineHeight:"1em"},children:"i"}),(0,v.jsx)("a",{title:"API.messages",href:"".concat(Y,"/").concat(q,"?id=").concat(t,"&from=0&to=20"),className:"agh",style:{display:"block",lineHeight:"1em"},children:"m"})]})}),(0,v.jsx)("div",{className:"cell-message",children:(0,v.jsxs)("div",{className:"flex-row",children:[(0,v.jsxs)("div",{style:{flex:1,textAlign:"center"},children:[(0,v.jsx)("a",{href:"https://forum.mista.ru/topic/".concat(t),children:(0,v.jsx)("h1",{className:"topic-title",dangerouslySetInnerHTML:{__html:s}})}),(0,v.jsx)("div",{className:"moder-action"})]}),(0,v.jsx)("div",{style:{flex:"0 0 20px",position:"relative"},children:(0,v.jsx)("div",{className:"div-va-middle",children:(0,v.jsx)("a",{rel:"noopener noreferrer",href:a,title:"\u0418\u0441\u043a\u0430\u0442\u044c \u0432 \u042f\u043d\u0434\u0435\u043a\u0441\u0435",target:"_blank",className:"yandex",children:"\u042f"})})})]})})]})},Gt=e=>{var t;let{item:s,topicId:a}=e;const n=ne((e=>e.login)),{data:r}=Le({topicId:a},{enabled:!1}),i=(null===r||void 0===r||null===(t=r.item0)||void 0===t?void 0:t.user)||"";return s?(0,v.jsxs)("div",{className:"topic-row",id:String(s.n),children:[(0,v.jsx)("div",{className:"cell-userinfo",children:(0,v.jsx)(Rt,{data:s,isAuthor:s.user===i,isYou:s.user===n.userName})}),(0,v.jsx)("div",{className:"cell-message",children:(0,v.jsx)(Ft,{html:s.text,topicId:a,topicDate:s.time,n:s.n,vote:s.vote})})]}):null},Qt=e=>{let{topicId:t,isLastPage:s}=e;const{isFetching:a,refetch:n}=Pe({topicId:t},{enabled:!1});return(0,v.jsxs)("div",{className:"flex-row",id:"F",children:[(0,v.jsx)("div",{className:"ta-left va-top",style:{width:"50%"},children:(0,v.jsx)(Ye.Z,{onClick:()=>{},disabled:!1,size:"sm",className:"button",variant:"light",children:"\u0417\u0430\u043a\u043b\u0430\u0434\u043a\u0430"})}),(0,v.jsx)("div",{className:"ta-right va-middle",style:{marginLeft:"auto"},children:s&&(0,v.jsx)(Ye.Z,{onClick:()=>n(),disabled:a,size:"sm",className:"button",variant:"light",children:a?"\u041e\u0431\u043d\u043e\u0432\u043b\u044f\u0435\u0442\u0441\u044f":"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0432\u0435\u0442\u043a\u0443"})})]})},es=e=>{let{topicId:t,onSubmitSuccess:s}=e;const[a,n]=(0,o.useState)(),r=ae(),i=re(Ze),{data:{info:l}}=Le({topicId:t}),c=ne((e=>e.newMessage)),d=()=>{i.changeText(""),n(void 0),s&&s()},h=e=>{e.preventDefault(),n(void 0)},p=e=>{n(e)},m=(0,o.useCallback)((e=>{r(ve.changeText(e))}),[r]);let x;if(null!==l&&void 0!==l&&l.isVoting&&null!==l&&void 0!==l&&l.voting){let e=[];for(let t=1;t<=l.voting.length;t++){const s=l.voting[t-1];s.text&&e.push((0,v.jsx)(u.Z.Check,{type:"radio",name:"voting",checked:a===t,onChange:()=>p(t),label:"".concat(t,". ").concat(s.text)},t))}x=(0,v.jsxs)(Yt.Z,{children:[(0,v.jsx)("legend",{children:(0,v.jsxs)("small",{children:["\u0412\u0430\u0448 \u0432\u044b\u0431\u043e\u0440:",(0,v.jsx)("span",{id:"voting_clear",style:{marginLeft:"5px",cursor:"pointer"},onClick:h,children:"\u043e\u0447\u0438\u0441\u0442\u0438\u0442\u044c"})]})}),e,"\u041e\u0431\u043e\u0441\u043d\u0443\u0439\u0442\u0435 \u0441\u0432\u043e\u0439 \u0432\u044b\u0431\u043e\u0440!"]})}return(0,v.jsxs)("form",{style:{marginTop:"5px"},onSubmit:e=>{e.preventDefault(),e.stopPropagation();let t={text:c.text,topicId:String(null===l||void 0===l?void 0:l.id),onSuccess:d,voting_select:void 0};a&&(t.voting_select=a),r(Te(t))},children:[(0,v.jsx)("div",{className:"bold",children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435 \u0432 \u0442\u0435\u043c\u0443:"}),(0,v.jsxs)("div",{className:"new-message-container",children:[(0,v.jsx)("div",{className:"new-message-text",children:(0,v.jsx)(Ht,{isFetching:"loading"===c.status,text:c.text,placeholder:"\u0421\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435",onChange:m})}),(0,v.jsx)("div",{className:"new-message-voting",children:x})]})]})},ts=()=>{const e=ae(),{hash:t}=(0,h.TH)(),[s]=(0,l.lr)(),a=C(s.get("id"),-1),{data:n,error:r,isPending:i}=Le({topicId:a}),{info:c,item0:d,list:u=[]}=null!==n&&void 0!==n?n:{},p=ne((e=>e.login)),m=T(s.get("page")),x=_(null===c||void 0===c?void 0:c.count),g="last20"===m||m===x,{enableUpdater:f,refreshInterval:j}=(e=>{let{isLastPage:t}=e;const[s,a]=ne((e=>[e.options.items.autoRefreshTopic,1e3*C(e.options.items.autoRefreshTopicInterval,60)])),[n,r]=(0,o.useState)(!1);return(0,o.useEffect)((()=>{"true"===s&&t&&setTimeout((()=>r(!0)),a)}),[s,a,t]),{enableUpdater:n,refreshInterval:a}})({isLastPage:g}),{refetch:y}=Pe({topicId:a},{refetchInterval:j,enabled:f});return(0,o.useEffect)((()=>{var e;null!==c&&void 0!==c&&c.title&&(document.title=(e=c.title,(new DOMParser).parseFromString(e,"text/html").firstChild.innerText))}),[null===c||void 0===c?void 0:c.title]),(0,o.useEffect)((()=>{if(i)return;if(!t)return;const e=document.getElementById(t.slice(1));e&&window.scrollTo(0,e.offsetTop)}),[i,t]),(0,v.jsxs)("div",{style:{marginBottom:"5px"},children:[(0,v.jsx)(Xt,{topicId:a}),r&&(0,v.jsx)(He,{text:r.message}),(0,v.jsxs)("div",{className:"topic-table",children:[(0,v.jsx)($t,{topicId:a}),(0,v.jsx)(Gt,{item:d,topicId:a}),u.map(((e,t)=>(0,v.jsx)(Gt,{item:e,topicId:a},e.n))),(x>1||"last20"===m)&&(0,v.jsx)("div",{className:"table-footer",children:(0,v.jsx)(Wt,{maxPage:x,last20:!0})})]}),(0,v.jsx)(Qt,{topicId:a,isLastPage:g}),p.logged&&(0,v.jsx)(es,{topicId:a,onSubmitSuccess:()=>{y(),e(Ze.changeText(""))}})]})},ss=e=>{let{name:t,label:s,value:a,values:n,oneLine:r,onChange:i}=e;const o=e=>{i(e,t,e.target.value)};return(0,v.jsxs)("span",{children:[(0,v.jsxs)("span",{style:{marginRight:"5px"},children:[" ",s," "]}),r&&(0,v.jsx)("br",{}),n.map(((e,t)=>(0,v.jsx)(u.Z.Check,{type:"radio",id:e.name,label:e.descr,name:s,checked:e.name===a,value:e.name,inline:r,onChange:o},t)))]})},as=e=>{let{name:t,value:s,label:a,postfix:n,onChange:r}=e;return(0,v.jsxs)("label",{htmlFor:t,style:{marginRight:"5px"},children:[(0,v.jsx)("span",{style:{marginRight:"5px"},children:a}),(0,v.jsx)("input",{type:"string",name:t,value:s,onChange:e=>{r(e,t,e.target.value)},className:"input"}),void 0!==n?(0,v.jsx)("span",{style:{marginLeft:"5px"},children:n}):null]})},ns=[{tabName:"\u041e\u0431\u0449\u0438\u0435",rows:[["theme"],["topicsPerPage"],["autoRefreshTopicsList","autoRefreshTopicsListInterval"],["autoRefreshTopic","autoRefreshTopicInterval"]]},{tabName:"\u0422\u0443\u043b\u0442\u0438\u043f\u044b",rows:[["showTooltips","tooltipDelay"],["showTooltipOnPostLink"]]},{tabName:"\u0421\u0441\u044b\u043b\u043a\u0438",rows:[["showYoutubeVideoTitle"],["replaceCatalogMista"],["fixBrokenLinks"]]}],rs={theme:{type:"radio",label:"\u0426\u0432\u0435\u0442\u043e\u0432\u0430\u044f \u043f\u0430\u043b\u0438\u0442\u0440\u0430:",oneLine:!0,values:[{name:"yellow",descr:"\u0417\u043e\u043b\u043e\u0442\u0430\u044f"},{name:"lightgray",descr:"\u0421\u0435\u0440\u0430\u044f"},{name:"dark",descr:"\u0422\u0435\u043c\u043d\u0430\u044f"}]},topicsPerPage:{type:"number",label:"\u0422\u0435\u043c \u043d\u0430 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0435 (max 99):",min:1,max:99},autoRefreshTopicsList:{type:"checkbox",label:"\u0410\u0432\u0442\u043e\u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u0441\u043f\u0438\u0441\u043a\u0430 \u0442\u0435\u043c"},autoRefreshTopicsListInterval:{type:"number",label:"",min:60,max:1e6,postfix:"\u0441\u0435\u043a"},autoRefreshTopic:{type:"checkbox",label:"\u0410\u0432\u0442\u043e\u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u0442\u0435\u043c\u044b"},autoRefreshTopicInterval:{type:"number",label:"",min:60,max:1e6,postfix:"\u0441\u0435\u043a"},showTooltips:{type:"checkbox",label:"\u041f\u043e\u043a\u0430\u0437\u044b\u0432\u0430\u0442\u044c \u0442\u0443\u043b\u0442\u0438\u043f\u044b, \u0437\u0430\u0434\u0435\u0440\u0436\u043a\u0430",disabled:!0},tooltipDelay:{type:"number",max:1e6,label:"",postfix:"\u043c\u0441",disabled:!0},showTooltipOnPostLink:{type:"checkbox",label:"\u041f\u043e\u043a\u0430\u0437\u044b\u0432\u0430\u0442\u044c \u0442\u0443\u043b\u0442\u0438\u043f \u0441\u0441\u044b\u043a\u0438 \u043d\u0430 \u0434\u0440\u0443\u0433\u0443\u044e \u0432\u0435\u0442\u043a\u0443",disabled:!0},showYoutubeVideoTitle:{type:"checkbox",label:"\u041f\u043e\u043a\u0430\u0437\u044b\u0432\u0430\u0442\u044c \u043d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u044f \u0440\u043e\u043b\u0438\u043a\u043e\u0432 youtube"},replaceCatalogMista:{type:"checkbox",label:"\u041e\u0431\u0440\u0430\u0442\u043d\u043e \u0437\u0430\u043c\u0435\u043d\u044f\u0442\u044c catalog.mista.ru \u043d\u0430 infostart.ru"},fixBrokenLinks:{type:"checkbox",label:"\u0427\u0438\u043d\u0438\u0442\u044c \u043f\u043e\u043b\u043e\u043c\u0430\u043d\u043d\u044b\u0435 \u0441\u0441\u044b\u043b\u043a\u0438 (\u0441 \u0440\u0443\u0441\u0441\u043a\u0438\u043c\u0438 \u0441\u0438\u043c\u0432\u043e\u043b\u0430\u043c\u0438)"}},is=e=>{let{name:t,children:s}=e;return(0,v.jsxs)("div",{children:[(0,v.jsx)("div",{className:"tab-header",children:t}),(0,v.jsx)("div",{className:"tab-content",children:s})]})},os=()=>{const e=ae(),t=(0,h.s0)(),s=ne((e=>e.options)),[a,n]=(0,o.useState)({items:s.items}),r=()=>{t("/#")},i=(e,t,s)=>{let r=Object.assign({},a.items);r[t]=s,n((0,y.Z)((0,y.Z)({},a),{},{items:r}))};let l=[];for(let o of ns){let e=[];for(let t in o.rows){const s=o.rows[t];let n=[];for(let e of s){const t=rs[e];if(!t)continue;const s=a.items[e];"radio"===t.type?n.push((0,v.jsx)(ss,{name:e,label:t.label,values:t.values,value:s,oneLine:t.oneLine,onChange:i},e)):"number"===t.type?(t.label&&n.push((0,v.jsx)("label",{htmlFor:e,style:{fontWeight:"inherit"},children:t.label},e+"_label")),n.push((0,v.jsxs)("div",{className:"options-number",children:[(0,v.jsx)(m.Z,{type:"number",min:t.min,max:t.max,value:s,disabled:t.disabled,onChange:t=>i(0,e,t.target.value),className:"input",size:"sm"}),t.postfix&&(0,v.jsx)("span",{style:{marginLeft:"5px",flex:"0 0 auto"},children:t.postfix},e+"_postfix")]},e))):"string"===t.type?n.push((0,v.jsx)(as,{name:e,label:t.label,postfix:t.postfix,value:s,onChange:i},e)):"checkbox"===t.type&&n.push((0,v.jsx)(u.Z.Check,{id:e,type:"checkbox",label:t.label,name:e,checked:"true"===String(s),disabled:t.disabled,onChange:t=>i(0,e,String(t.target.checked)),style:{flex:"0 0 auto",margin:"0px",maxWidth:"100%"}},e))}e.push((0,v.jsx)("div",{className:"options-row",children:n},t))}l.push((0,v.jsx)(is,{name:o.tabName,children:e},o.tabName))}return(0,v.jsxs)("div",{className:"options-form",children:[(0,v.jsx)("div",{className:"options-header",style:{cursor:"default"},children:(0,v.jsx)("b",{children:"\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438"})}),l,(0,v.jsxs)("div",{className:"button-row",children:[(0,v.jsx)(Ye.Z,{id:"applyOptions",size:"sm",variant:"light",style:{margin:"5px"},className:"button",onClick:()=>{e(Ne.save(a.items)),r()},children:"OK"}),(0,v.jsx)(Ye.Z,{id:"cancelOptions",size:"sm",variant:"light",style:{margin:"5px",float:"left"},className:"button",onClick:r,children:"\u041e\u0442\u043c\u0435\u043d\u0430"}),(0,v.jsx)(Ye.Z,{id:"defaultOptions",size:"sm",variant:"light",style:{margin:"5px",float:"right"},className:"button",onClick:()=>{n((0,y.Z)((0,y.Z)({},a),{},{items:Object.assign({},ye.items)}))},children:"\u0421\u0431\u0440\u043e\u0441\u0438\u0442\u044c \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438"})]})]})},ls=()=>(0,v.jsx)(Fe.Z,{children:(0,v.jsxs)(h.Z5,{children:[(0,v.jsx)(h.AW,{path:"/",element:(0,v.jsx)(Kt,{})}),(0,v.jsx)(h.AW,{path:"/index.php",element:(0,v.jsx)(Kt,{})}),(0,v.jsx)(h.AW,{path:"/topic.php",element:(0,v.jsx)(ts,{})}),(0,v.jsx)(h.AW,{path:"/options.php",element:(0,v.jsx)(os,{})})]})}),cs=()=>(0,v.jsxs)("footer",{className:"flex-row navbar-footer",children:[(0,v.jsx)("a",{href:"".concat(Y,"/rules.php"),children:"\u041f\u0440\u0430\u0432\u0438\u043b\u0430"}),(0,v.jsx)("span",{className:"separator",children:"|"}),(0,v.jsx)("a",{href:"".concat(Y,"/about.php"),children:"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435"}),(0,v.jsx)("span",{className:"separator",children:"|"}),(0,v.jsxs)("b",{children:[(0,v.jsx)("a",{href:"".concat(Y,"/ad.php"),children:"\u0420\u0435\u043a\u043b\u0430\u043c\u0430 \u043d\u0430 \u0441\u0430\u0439\u0442\u0435"})," "]}),(0,v.jsx)("span",{className:"separator",children:"|"}),(0,v.jsx)("a",{href:"".concat(Y,"/find.php"),children:"\u041f\u043e\u0438\u0441\u043a"}),(0,v.jsx)("span",{className:"separator",children:"|"}),(0,v.jsx)("a",{rel:"nofollow",href:"".concat(Y,"/sections_list.php"),children:"\u0421\u0435\u043a\u0446\u0438\u0438"}),(0,v.jsx)("span",{className:"separator",children:"|"}),(0,v.jsx)("a",{rel:"nofollow",href:"".concat(Y,"/rating.php"),children:"\u0420\u0435\u0439\u0442\u0438\u043d\u0433"}),(0,v.jsx)("span",{className:"separator",children:"|"}),(0,v.jsx)("a",{href:"http://kb.mista.ru",children:"\u041a\u043d\u0438\u0433\u0430 \u0437\u043d\u0430\u043d\u0438\u0439"}),(0,v.jsx)("span",{className:"separator",children:"|"}),(0,v.jsx)("a",{href:"http://wiki.mista.ru",children:"\u0412\u0438\u043a\u0438-\u043c\u0438\u0441\u0442\u0430 (\u041a\u04172)"}),(0,v.jsx)("span",{className:"separator",children:"|"}),(0,v.jsx)("a",{rel:"nofollow",href:"http://m.mista.ru/",children:"\u041c\u043e\u0431\u0438\u043b\u044c\u043d\u0430\u044f"}),(0,v.jsx)("span",{className:"separator",children:"|"}),(0,v.jsx)("a",{href:"".concat(Y,"/archive.php"),children:"\u0410\u0440\u0445\u0438\u0432"}),(0,v.jsx)("span",{className:"separator",children:"|"}),(0,v.jsx)("a",{href:"".concat(Y,"/moders.php"),children:"\u041c\u043e\u0434\u0435\u0440\u0430\u0442\u043e\u0440\u044b"}),(0,v.jsx)("span",{className:"separator",children:"|"}),(0,v.jsx)("a",{href:"".concat(Y,"/users_gallery.php"),children:"\u0413\u0430\u043b\u0435\u0440\u0435\u044f"}),(0,v.jsx)("span",{className:"separator",children:"|"}),(0,v.jsx)("a",{href:"".concat(Y,"/ban_list.php"),children:"\u0411\u0430\u043d\u044b"}),(0,v.jsx)("span",{className:"separator",children:"|"}),(0,v.jsx)("span",{children:"18+"})]});var ds=s(9962),us=s.n(ds);const hs=e=>{let{children:t,closeWindow:s}=e;return(0,v.jsxs)("div",{className:"tooltip-header",children:[t,(0,v.jsxs)("div",{className:"tooltip-close",onClick:s,onTouchEnd:s,children:[(0,v.jsx)("i",{className:"fa fa-angle-right","aria-hidden":"true"}),(0,v.jsx)("i",{className:"fa fa-angle-left","aria-hidden":"true",style:{marginLeft:"-2px"}})]})]})},ps=e=>{let{children:t,onScroll:s}=e,a=0;return(0,v.jsx)("div",{className:"tooltip-text",onTouchStart:e=>{a=e.nativeEvent.changedTouches[0].clientX},onTouchEnd:e=>{if(!s)return;let t=e.nativeEvent.changedTouches[0].clientX;Math.abs(t-a)>100&&s(-t+a)},children:t})},ms=e=>{let{tooltip:t,zIndex:s,children:a}=e;const n=re(ke),{coords:r}=t;let i,l;window.innerWidth<=768?(i="y",l={top:r.y,left:5}):(i="both",l={top:r.y,left:Math.min(r.x,window.innerWidth-670)});let[c,d]=o.Children.toArray(a);return(0,v.jsx)(us(),{axis:i,handle:".tooltip-header",defaultClassNameDragging:"dragging",children:(0,v.jsxs)("div",{className:"tooltip-window",style:(0,y.Z)({},l),children:[(0,v.jsx)(hs,{closeWindow:()=>{n.close(t.keys)},children:c.props.children}),(0,v.jsx)(ps,{children:d.props.children})]})},s)},xs=e=>{let{tooltip:t}=e;const{keys:s}=t,{data:a,isPending:n,isError:r,error:i}=(e=>{let{topicId:t,number:s}=e;return(0,b.a)({queryKey:[ee.TopicMessageData,t,s],queryFn:async e=>{let{client:a}=e;const n=Oe(a,t);if(n){if(0===s)return n.item0;{const e=n.list.find((e=>e.n===s));if(e)return e}}const r=await V(t,s);if(void 0===r)throw new Error("\u0421\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435 ".concat(s," \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e"));return r}})})({topicId:s.topicId,number:s.number});return n?null:(0,v.jsxs)(ms,{tooltip:t,children:[(0,v.jsx)(hs,{children:r?(0,v.jsx)("b",{children:"\u041e\u0448\u0438\u0431\u043a\u0430"}):(0,v.jsx)(Rt,{data:a,isAuthor:!1,isYou:!1,isTooltip:!0})}),(0,v.jsx)(ps,{children:(0,v.jsx)(Ft,{n:null===a||void 0===a?void 0:a.n,vote:null===a||void 0===a?void 0:a.vote,html:r?i.message:a.text,topicId:s.topicId,topicDate:null===a||void 0===a?void 0:a.time,style:{maxHeight:"min(550px, 80vh)",overflowY:"auto"}})})]})},gs=()=>{const e=ne((e=>e.tooltips.items)),t=re(ke),s=(0,o.useRef)(null);return(0,f.t$)(s,(()=>{t.closeAll()})),(0,v.jsx)("div",{ref:s,children:e.map((e=>(0,v.jsx)(xs,{tooltip:e},e.hash)))})},fs=()=>{const e=ne((e=>e.options.items.theme));return(0,o.useLayoutEffect)((()=>{document.body.setAttribute("data-theme",e)}),[e]),(0,v.jsxs)(l.UT,{children:[(0,v.jsx)(De,{}),(0,v.jsx)(ls,{}),(0,v.jsx)(cs,{}),(0,v.jsx)(gs,{})]})};var vs=s(6994);const js=new r.S({defaultOptions:{queries:{refetchOnWindowFocus:!1}}}),ys=e=>{let{store:t}=e;return(0,v.jsx)(i.aH,{client:js,children:(0,v.jsx)(n.zt,{store:t,children:(0,v.jsx)(vs.r,{loading:null,persistor:Ve,children:(0,v.jsx)(fs,{})})})})},bs=document.getElementById("root");(0,a.s)(bs).render((0,v.jsx)(ys,{store:Ue}))}},t={};function s(a){var n=t[a];if(void 0!==n)return n.exports;var r=t[a]={exports:{}};return e[a].call(r.exports,r,r.exports,s),r.exports}s.m=e,(()=>{var e=[];s.O=(t,a,n,r)=>{if(!a){var i=1/0;for(d=0;d<e.length;d++){a=e[d][0],n=e[d][1],r=e[d][2];for(var o=!0,l=0;l<a.length;l++)(!1&r||i>=r)&&Object.keys(s.O).every((e=>s.O[e](a[l])))?a.splice(l--,1):(o=!1,r<i&&(i=r));if(o){e.splice(d--,1);var c=n();void 0!==c&&(t=c)}}return t}r=r||0;for(var d=e.length;d>0&&e[d-1][2]>r;d--)e[d]=e[d-1];e[d]=[a,n,r]}})(),s.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return s.d(t,{a:t}),t},(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;s.t=function(a,n){if(1&n&&(a=this(a)),8&n)return a;if("object"===typeof a&&a){if(4&n&&a.__esModule)return a;if(16&n&&"function"===typeof a.then)return a}var r=Object.create(null);s.r(r);var i={};e=e||[null,t({}),t([]),t(t)];for(var o=2&n&&a;"object"==typeof o&&!~e.indexOf(o);o=t(o))Object.getOwnPropertyNames(o).forEach((e=>i[e]=()=>a[e]));return i.default=()=>a,s.d(r,i),r}})(),s.d=(e,t)=>{for(var a in t)s.o(t,a)&&!s.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),s.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e={179:0};s.O.j=t=>0===e[t];var t=(t,a)=>{var n,r,i=a[0],o=a[1],l=a[2],c=0;if(i.some((t=>0!==e[t]))){for(n in o)s.o(o,n)&&(s.m[n]=o[n]);if(l)var d=l(s)}for(t&&t(a);c<i.length;c++)r=i[c],s.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return s.O(d)},a=self.webpackChunkreact_mista=self.webpackChunkreact_mista||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))})();var a=s.O(void 0,[216],(()=>s(5268)));a=s.O(a)})();
//# sourceMappingURL=main.a6ab681b.js.map