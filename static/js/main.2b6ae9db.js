(()=>{"use strict";var e={2575:(e,t,s)=>{var a=s(1250),n=s(6030),r=s(2902),i=s(3713),o=s(2791),l=s(1087),c=s(8682),d=s(6955),u=s(2940),h=s(7689),p=s(2076),m=s(4292),x=s(7022),g=s(9546),f=s(4792),v=s(184);const j=()=>{const[e,t]=(0,o.useState)("\u042f\u043d\u0434\u0435\u043a\u0441"),[s,a]=(0,o.useState)(""),n=(0,o.useCallback)((e=>{a(e.target.value)}),[]),r=(0,f.$0)((e=>{"Enter"===e.key&&i()})),i=(0,f.$0)((()=>{let t;switch(e){case"\u042f\u043d\u0434\u0435\u043a\u0441":t="https://www.yandex.ru/search/?text=".concat(s,"&site=forum.mista.ru");break;case"Google":t="https://www.google.ru/search?q=".concat(s,"+site:forum.mista.ru")}window.open(t),a("")}));return(0,v.jsxs)(p.Z,{size:"sm",children:[(0,v.jsxs)(g.Z,{id:"search-engine",title:"",size:"sm",variant:"light",onSelect:t,children:[(0,v.jsx)(x.Z.Item,{eventKey:"\u042f\u043d\u0434\u0435\u043a\u0441",children:"\u042f\u043d\u0434\u0435\u043a\u0441"}),(0,v.jsx)(x.Z.Item,{eventKey:"Google",children:"Google"})]}),(0,v.jsx)(m.Z,{type:"text",placeholder:"".concat(e,": \u043f\u043e\u0438\u0441\u043a"),className:"search-input input",onKeyDown:r,onChange:n,value:s}),(0,v.jsx)(p.Z.Text,{className:"search-button",onClick:i,children:(0,v.jsx)("i",{className:"fa fa-search input",style:{zIndex:1e3}})})]})};var y=s(3063),b=s(8463),N=s(6490),w=s.n(N),k=s(7892),I=s.n(k);const C=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!e)return t;if("number"===typeof e)return e;const s=parseInt(e,10);return isNaN(s)?t:s},S=(e,t)=>e.reduce(((e,s)=>{const a=t(s);return e[a]||(e[a]=[]),e[a].push(s),e}),{}),T=e=>-1===e?-1:Math.min(Math.ceil(e/100),10)||1,_=e=>e?e.map((e=>"string"===typeof e?e:"br"===e.type?"<br>":"Connect(LinkToPost)"===e.type.displayName||"Connect(t)"===e.type.displayName?e.props.number:(console.log(e),e))):[""];const Z=e=>{return 2147483648e3===e?"":(t=e,I()(t).isSame(new Date,"day")?I()(e).format("HH:mm"):I()(e).format("DD.MM.YY"));var t},L=(e,t)=>{if(!t)return"";let s=new URLSearchParams;for(let n in t){const e=t[n];void 0!==e&&s.append(n,e)}let a=s.toString();return a.length>0?e+a:""},M=async(e,t,s)=>{let a="".concat(W,"/").concat(e).concat(L("?",t));const n=await w()(a);let r,i=await n.json();if("string"===typeof i)try{r=JSON.parse(i)}catch(o){r=(e=>{try{return JSON.parse(e)}catch(o){}try{return e=e.replace(/\\</g,"<").replace(/\\>/g,">").replace(/\\&/g,"&").replace(/\\'/g,"'").replace(/\\"/g,"").replace(/ "/g,' \\"').replace(/""/g,'\\""').replace(/\t/g,"\\t").replace(/"(\.| |\?)/g,'\\"$1'),JSON.parse(e)}catch(o){return console.error(o.message),console.log(e),{}}})(i)}else r=i;return r},O=async(e,t,s)=>{let a="".concat(W,"/").concat(e).concat(L("?",t));s||(s={mode:"cors",credentials:"same-origin"});const n=await fetch(a,s);return await n.json()};async function P(){return function(e){const{session:t}=e;return{userId:Number(null===t||void 0===t?void 0:t.user_id),userName:null===t||void 0===t?void 0:t.user_name,userHash:null===t||void 0===t?void 0:t.user_hash,lastError:null===t||void 0===t?void 0:t.last_error}}(await M(J))}function D(e){return{id:e.id,forum:e.forum,code:e.shortn,name:e.fulln}}const R=async()=>{const e=(await M(X)).map(D);return{items:e,tree:S(e,(e=>e.forum))}};async function E(e){return function(e){let t=[];return e.voting&&(t=e.voting.map((e=>({text:e.select,count:e.result})))),{id:parseInt(e.id),title:e.text,forum:e.forum,sectionId:e.section,created:1e3*parseInt(e.created),authorId:e.user_id,author:e.user_name,updated:1e3*parseInt(e.updated),lastUser:e.updated_name,count:parseInt(e.answers_count),down:e.down,closed:e.closed,deleted:e.deleted,isVoting:e.is_voting,voting:t}}(await O(H,{id:e}))}function F(e){return{id:parseInt(e.id),n:parseInt(e.n),user:e.user,userId:parseInt(e.userId),text:e.text,time:1e3*parseInt(e.utime),vote:e.vote}}async function z(e){return(await O(B,e)).map(F)}async function V(e,t){const s=0===t?t+1:t;return(await O(B,{id:e,from:t,to:s})).map(F).find((e=>e.n===t))}function A(e){return{id:e.id,forum:e.forum,section:e.sect1,sectionCode:e.sect2,author:e.user0,lastUser:e.user,created:1e3*e.created,updated:1e3*e.utime,count:e.answ,text:e.text,closed:1===e.closed,down:1===e.down,pinned:2147483648===e.utime,isVoting:1===e.is_voting}}async function U(e){const t=function(e){const t=C(e.page,1),s=C(e.itemsPerPage,20)*t;return{topics:String(s),section_short_name:e.section,forum:e.forum,user_id:e.userId,mytopics:e.myTopics}}(e),s=C(null===e||void 0===e?void 0:e.itemsPerPage,20);return(await O(Y,t)).map(A).slice(-s)}const W=localStorage.getItem("domain")||"https://dev.mista.ru",Y=localStorage.getItem("urlTopicsList")||"api/topic.php",H=localStorage.getItem("urlTopicInfo")||"ajax_gettopic.php",B=localStorage.getItem("urlTopicMessages")||"api/message.php",K=localStorage.getItem("urlLogin")||"users.php?action=do_enter",q=localStorage.getItem("urlLogout")||"users.php?action=exit",J=localStorage.getItem("urlCookies")||"ajax_cookie.php",X=localStorage.getItem("urlSections")||"ajax_getsectionslist.php",$=localStorage.getItem("urlNewMessage")||"topic.php?id=:id&page=1",G=localStorage.getItem("urlNewTopic")||"index.php";localStorage.getItem("urlAddBookmark"),localStorage.getItem("urlSearch");var Q=s(7781);const ee=()=>(0,n.I0)(),te=n.v9,se=e=>{const t=ee();return(0,o.useMemo)((()=>(0,Q.DE)(e,t)),[e,t])};var ae=s(6382);const ne=(0,ae.hg)("login/check",(async()=>await P())),re=(0,ae.hg)("login/login",(async(e,t)=>{let{dispatch:s}=t;return await(async e=>{await fetch("".concat(W,"/").concat(K),{method:"POST",body:L("",{user_name:e.username,user_password:e.password}),mode:"no-cors",credentials:"include",headers:{Accept:"text/html,application/xhtml+xml,application/xml","Content-Type":"application/x-www-form-urlencoded"},redirect:"follow"})})(e),P()})),ie=(0,ae.hg)("login/logout",(async()=>await(async()=>{const e="".concat(W,"/").concat(q);await fetch(e,{mode:"no-cors",credentials:"include"})})())),oe=e=>{let{login:t}=e;return!t||"loading"!==t.status},le=(0,ae.oM)({name:"login",initialState:{status:"init",logged:!1},reducers:{},extraReducers:e=>{e.addCase(re.pending,(e=>{e.status="loading",delete e.error})).addCase(re.fulfilled,((e,t)=>{let{payload:s}=t;e.status="success",e.userId=s.userId,e.userName=s.userName,e.userHash=s.userHash,e.logged=!0,delete e.error})).addCase(re.rejected,((e,t)=>{let{error:s}=t;e.status="error",e.error=null===s||void 0===s?void 0:s.message})).addCase(ie.pending,(e=>{e.status="loading",delete e.error})).addCase(ie.fulfilled,(e=>{e.status="success",e.logged=!1,delete e.userId,delete e.userName,delete e.userHash,delete e.error})).addCase(ie.rejected,((e,t)=>{let{error:s}=t;e.status="error",e.error=null===s||void 0===s?void 0:s.message}))}}),{actions:ce,reducer:de}=le,ue=(0,ae.hg)("newTopic/post",(async e=>{let t={message_text:e.text,topic_text:e.subject,target_section:String(e.section),target_forum:e.forum.toLowerCase(),action:"new",rnd:Math.round(1e10*Math.random()),voting:e.isVoting?1:0};if(e.votingItems)for(let s=0;s<e.votingItems.length;s++)t["section".concat(s+1)]=e.votingItems[s];await(async e=>{await fetch("".concat(W,"/").concat(G),{method:"POST",body:L("",e),mode:"no-cors",credentials:"include",headers:{"Content-Type":"application/x-www-form-urlencoded"}})})(t)})),he=e=>{e.status="init",e.text="",e.subject="",e.forum="",e.isVoting=!1},pe=(0,ae.oM)({name:"newTopic",initialState:{status:"init",section:null,text:"",subject:"",forum:"1C",isVoting:!1},reducers:{clear:he,changeSubject:(e,t)=>{let{payload:s}=t;e.subject=s},changeText:(e,t)=>{let{payload:s}=t;e.text=s},changeSection:(e,t)=>{let{payload:s}=t;e.section=s,e.forum=null===s||void 0===s?void 0:s.forum.toLowerCase()},showVoting:(e,t)=>{let{payload:s}=t;e.isVoting=s},setError:(e,t)=>{let{payload:s}=t;e.error=s}},extraReducers:e=>{e.addCase(ue.pending,(e=>{e.status="loading",delete e.error})).addCase(ue.fulfilled,(e=>{he(e),delete e.error})).addCase(ue.rejected,((e,t)=>{let{error:s}=t;e.status="error",e.error=null===s||void 0===s?void 0:s.message}))}}),{actions:me,reducer:xe}=pe,ge={voteColors:["#FF1616","#1A861A","#0023FF","#FF6B18","#9B3A6E","#567655","#233345","#CC0000","#00CCCC","#0000CC"],items:{theme:"lightgray",topicsPerPage:"20",autoRefreshTopicsList:"false",autoRefreshTopicsListInterval:"60",autoRefreshTopic:"true",autoRefreshTopicInterval:"60",showTooltips:"true",tooltipDelay:"500",showTooltipOnPostLink:"true",showYoutubeVideoTitle:"true",replaceCatalogMista:"true",fixBrokenLinks:"true"}},fe=(0,ae.oM)({name:"options",initialState:ge,reducers:{save:(e,t)=>{let{payload:s}=t;for(let a in s){const t=String(s[a]);e.items[a]=t}}}}),{actions:ve,reducer:je}=fe,ye=(0,ae.oM)({name:"tooltips",initialState:{items:[]},reducers:{show:(e,t)=>{let{payload:s}=t;const a=JSON.stringify(s.keys),n=e.items.findIndex((e=>e.hash===a));let r=0;e.items.length&&(r=e.items[e.items.length-1].zIndex+1),-1===n?e.items.push({keys:s.keys,coords:s.coords,hash:a,zIndex:r}):e.items[e.items.length-1].zIndex=r},close:(e,t)=>{let{payload:s}=t;const a=JSON.stringify(s);e.items=e.items.filter((e=>e.hash!==a))},closeAll:e=>{e.items=[]}}}),{actions:be,reducer:Ne}=ye,we={id:0,title:"",count:-1},ke={status:"init",items:[],info:we},Ie=async e=>{let t,{topicId:s,page:a,item0:n}=e;try{t=await E(s)}catch(c){console.error(c),t={id:s,title:"",count:-1}}let[r,i]=((e,t)=>{if("last20"===t)return-1===e?[0,1010]:[Math.max(0,e-19),e];const s=C(t,1)-1;return[100*s,100*s+99]})(t.count,a);0===r&&n&&(r=1);let o=await z({id:s,from:r,to:i}),l=n;return l=0===r?o.shift():await V(s,0),0===t.count&&o.length>0&&(t.count=o[o.length-1].n),"last20"===a&&o.length>20&&(o=o.slice(-20)),{info:t,item0:l,list:o}},Ce=(0,ae.hg)("topics/fetch",(async(e,t)=>{let s,{topicId:a,page:n,item0:r}=e,{rejectWithValue:i}=t;try{s=await E(a)}catch(o){console.error(o),s={id:a,title:"",count:-1}}try{let e,t=r;if("last20"===n)if(s.count>21){t||(t=await V(a,0));let n=s.count-20;e=await z({id:a,from:n,to:1010})}else{let s=await z({id:a,from:0,to:1010});t=s[0],e=s.slice(1)}else{n=+n;let s=0,r=100*n-1;if(n>1)s=100*(n-1),t||(t=await V(a,0)),e=await z({id:a,from:s,to:r});else{s=t?1:0;let n=await z({id:a,from:s,to:r});t?e=n:(t=n[0],e=n.slice(1))}}return 0===s.count&&e.length>0&&(s.count=e[e.length-1].n),"last20"===n&&e.length>20&&(e=e.slice(-20)),{info:s,item0:t,list:e}}catch(l){console.error("Failed to fetch topic:",l),i(l)}})),Se=(0,ae.hg)("topic/getNewMessages",(async e=>{let{id:t,count:s}=e;return await z({id:t,from:s+1,to:1050})})),Te=e=>{let{topic:t}=e;return!t||"loading"!==t.status},_e=()=>(e,t)=>{const s=t(),{id:a,count:n}=s.topic.info;if(Te(s))return e(Se({id:a,count:n}))},Ze=(0,ae.oM)({name:"topic",initialState:ke,reducers:{clear:e=>{e.info=ke.info,e.item0=ke.item0,e.items=ke.items,e.status=ke.status,delete e.error}},extraReducers:e=>{e.addCase(Ce.pending,(e=>{e.status="loading",delete e.error})).addCase(Ce.fulfilled,((e,t)=>{let{payload:s}=t;e.status="success",e.items=s.list,e.item0=s.item0,e.info=s.info,delete e.error})).addCase(Ce.rejected,((e,t)=>{let{error:s}=t;e.status="error",e.error=null===s||void 0===s?void 0:s.message})).addCase(Se.pending,(e=>{e.status="loading",delete e.error})).addCase(Se.fulfilled,((e,t)=>{let{payload:s}=t;e.status="success",s.length>0&&(e.items=e.items.concat(s),e.info.count=e.items[e.items.length-1].n),delete e.error})).addCase(Se.rejected,((e,t)=>{let{error:s}=t;e.status="error",e.error=null===s||void 0===s?void 0:s.message}))}}),{actions:Le,reducer:Me}=Ze,Oe=(0,ae.hg)("newMessage/post",(async e=>{let t={message_text:e.text,action:"new",topic_id:e.topicId,rnd:Math.round(1e10*Math.random())};e.voting_select&&(t.voting_select=e.voting_select),await(async e=>{const t=$.replace(":id",e.topic_id),s={method:"POST",body:L("",e),mode:"no-cors",credentials:"include",headers:{Accept:"text/html,application/xhtml+xml,application/xml","Content-Type":"application/x-www-form-urlencoded"},redirect:"follow"};return await fetch("".concat(W,"/").concat(t),s)})(t)})),Pe=(0,ae.oM)({name:"newMessage",initialState:{status:"init",text:""},reducers:{changeText:(e,t)=>{let{payload:s}=t;e.text=s}},extraReducers:e=>{e.addCase(Oe.pending,(e=>{e.status="loading",delete e.error})).addCase(Oe.fulfilled,(e=>{e.text="",delete e.error})).addCase(Oe.rejected,((e,t)=>{let{error:s}=t;e.status="error",e.error=null===s||void 0===s?void 0:s.message}))}}),{actions:De,reducer:Re}=Pe,Ee=()=>(0,b.a)({queryKey:["sections"],queryFn:R,placeholderData:{items:[],tree:{}}}),Fe=e=>{let{searchParams:t}=e;const s=te((e=>e.options.items.topicsPerPage));return(0,b.a)({queryKey:["topics-list",...t],queryFn:()=>{const e=Object.fromEntries(t);return U((0,y.Z)({itemsPerPage:s},e))},placeholderData:e=>e})},ze=(e,t)=>{let{topicId:s}=e;const[a]=(0,l.lr)(),n=a.get("page"),r=(0,i.NL)();return(0,b.a)((0,y.Z)({queryKey:["topic-messages",s,n],queryFn:()=>{const e=r.getQueryData(["topic-messages",s]);return Ie({topicId:s,page:n,item0:null===e||void 0===e?void 0:e.item0})},placeholderData:e=>e},t))},Ve=()=>{const e=(0,h.TH)(),[t]=(0,l.lr)(),s=t.get("forum"),{refetch:a}=Fe({searchParams:t});return(0,v.jsxs)(c.Z,{bg:"dark",variant:"dark",expand:"md",fixed:"top",children:[(0,v.jsx)(c.Z.Brand,{as:l.rU,to:"/",onClick:s=>{"/"===e.pathname&&0===t.size&&(s.preventDefault(),a())},children:"React.Mista"}),(0,v.jsx)(c.Z.Toggle,{"aria-controls":"basic-navbar-nav"}),(0,v.jsxs)(c.Z.Collapse,{children:[(0,v.jsxs)(d.Z,{className:"me-auto",children:[[{name:"1C",link:"/index.php?forum=1C"},{name:"IT",link:"/index.php?forum=IT"},{name:"JOB",link:"/index.php?forum=JOB"},{name:"LIFE",link:"/index.php?forum=LIFE"},{name:"\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438",link:"/options.php"}].map(((e,t)=>(0,v.jsx)(d.Z.Item,{children:(0,v.jsx)(d.Z.Link,{to:e.link,active:e.name===s,as:l.rU,children:e.name})},"i"+t))),[{name:"Wiki",link:"https://wiki.mista.ru"},{name:"\u041a\u043d\u0438\u0433\u0430 \u0437\u043d\u0430\u043d\u0438\u0439",link:"https://kb.mista.ru"}].map(((e,t)=>(0,v.jsx)(d.Z.Item,{children:(0,v.jsx)(d.Z.Link,{href:e.link,children:e.name})},"e"+t)))]}),(0,v.jsx)(u.Z,{className:"d-flex",children:(0,v.jsx)(j,{})})]})]})};var Ae=s(7262),Ue=s(2540);const We={key:"options",storage:s(5752).Z},Ye=(0,Q.UY)({topic:Me,options:(0,Ue.OJ)(We,je),login:de,tooltips:Ne,newTopic:xe,newMessage:Re}),He=(0,ae.xC)({reducer:Ye,middleware:e=>e({serializableCheck:{ignoredActions:[Ue._P,Ue.I2,Ue.E7,Ue.ex,Ue.e,Ue.Nz]}}),devTools:!1}),Be=(0,Ue.p5)(He),Ke=o.forwardRef(((e,t)=>{let{children:s,onClick:a}=e;return(0,v.jsx)("span",{ref:t,style:{cursor:"pointer"},className:"link",onClick:e=>{e.preventDefault(),a(e)},children:s})})),qe=e=>{let{userId:t,userName:s}=e;const a=se(ce);return(0,v.jsx)("div",{style:{float:"left"},children:(0,v.jsxs)(x.Z,{id:"dropdown-custom-menu",onSelect:(e,t)=>{"exit"===e&&(e=>{e.preventDefault(),a.doLogout()})(t)},children:[(0,v.jsx)("span",{children:"\u041f\u0440\u0438\u0432\u0435\u0442, "}),(0,v.jsxs)(x.Z.Toggle,{as:Ke,children:[s," \u25bc"]}),(0,v.jsxs)(x.Z.Menu,{children:[(0,v.jsx)(x.Z.Item,{eventKey:"profile",href:"".concat(W,"/users.php?id=").concat(t),children:"\u041f\u0440\u043e\u0444\u0438\u043b\u044c"}),(0,v.jsx)(x.Z.Item,{eventKey:"myTopics",href:"#/index.php?user_id=".concat(t),children:"\u041c\u043e\u0438 \u0442\u0435\u043c\u044b"}),(0,v.jsx)(x.Z.Divider,{}),(0,v.jsx)(x.Z.Item,{eventKey:"options",href:"#/options.php",children:"\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438"}),(0,v.jsx)(x.Z.Divider,{}),(0,v.jsx)(x.Z.Item,{eventKey:"exit",children:"\u0412\u044b\u0445\u043e\u0434"})]})]})})};var Je=s(3360);const Xe=()=>{const e=ee(),[t,s]=(0,o.useState)(""),[a,n]=(0,o.useState)("");return(0,v.jsxs)("div",{children:[(0,v.jsxs)("form",{name:"enterform",className:"flex-row",style:{flexWrap:"wrap"},children:[(0,v.jsx)(m.Z,{id:"username",type:"text",placeholder:"\u0418\u043c\u044f",value:t,onChange:e=>s(e.target.value),size:"sm",className:"input",style:{marginRight:"5px",flex:"0 1 300px"}}),(0,v.jsx)(m.Z,{id:"password",type:"password",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",maxLength:20,autoComplete:"off",value:a,onChange:e=>n(e.target.value),size:"sm",className:"input",style:{marginRight:"5px",flex:"0 1 300px"}}),(0,v.jsx)(Je.Z,{size:"sm",variant:"light",className:"button",onClick:s=>{s.preventDefault(),e(((e,t)=>(s,a)=>{if(oe(a()))return s(re({username:e,password:t}))})(t,a))},children:"\u0412\u043e\u0439\u0442\u0438"})]}),(0,v.jsxs)("p",{style:{margin:"0px"},children:["\u0412\u043e\u0439\u0442\u0438 \u043c\u043e\u0436\u043d\u043e \u043d\u0430 \u0441\u0430\u0439\u0442\u0435"," ",(0,v.jsx)("a",{href:"https://forum.mista.ru/",children:"forum.mista.ru"})]}),(0,v.jsx)("a",{rel:"nofollow",href:"https://forum.mista.ru/user_registration.php",children:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"}),(0,v.jsx)("span",{style:{margin:"5px"},children:"|"}),(0,v.jsx)("a",{rel:"nofollow",href:"https://forum.mista.ru/remember_password.php",children:"\u0417\u0430\u0431\u044b\u043b\u0438 \u043f\u0430\u0440\u043e\u043b\u044c?"})]})},$e=e=>{let{text:t}=e;return t?(0,v.jsx)("div",{className:"error",dangerouslySetInnerHTML:{__html:t}}):null},Ge=()=>{const e=ee(),t=te((e=>e.login.logged)),s=te((e=>e.login.userId)),a=te((e=>e.login.userName)),n=te((e=>e.login.error));let r;return(0,o.useEffect)((()=>{e(((e,t)=>{if(oe(t()))return e(ne())}))}),[e]),r=!0===t?(0,v.jsx)(qe,{userId:s,userName:a}):!1===t?(0,v.jsx)(Xe,{}):null,(0,v.jsxs)(v.Fragment,{children:[r,n&&(0,v.jsx)($e,{text:n})]})},Qe=e=>{let{id:t,defaultValue:s,selected:a,style:n,size:r,onChange:i}=e;const{data:o}=Ee();return(0,v.jsxs)(u.Z.Select,{"aria-label":"\u0421\u0435\u043a\u0446\u0438\u044f",onChange:e=>{if(!i)return;const t=e.currentTarget.value,s=o.items.find((e=>e.code===t));i(e,s)},value:a,style:n,className:"input",size:r,id:t,children:[(0,v.jsx)("option",{value:"",children:s}),Object.keys(o.tree).map((e=>(0,v.jsx)("optgroup",{label:e,children:o.tree[e].map((e=>(0,v.jsx)("option",{value:e.code,children:e.name},e.id)))},e)))]})},et=()=>{var e;const[t,s]=(0,l.lr)();return(0,v.jsxs)("div",{className:"flex-row",children:[(0,v.jsx)("div",{className:"header-left",children:(0,v.jsx)(Ge,{})}),(0,v.jsx)("div",{className:"header-right",children:(0,v.jsx)(Qe,{id:"sect",defaultValue:"--\u0412\u0441\u0435 \u0441\u0435\u043a\u0446\u0438\u0438--",selected:null!==(e=t.get("section"))&&void 0!==e?e:"",onChange:(e,t)=>{s((e=>{const s=new URLSearchParams(e);return t?s.set("section",t.code):s.delete("section"),s}))},size:"sm"})})]})},tt=e=>{let{isLoading:t,onUpdateClick:s}=e;return(0,v.jsxs)("div",{className:"table-header",children:[(0,v.jsx)("div",{style:{letterSpacing:"-1px"},children:"\u0420\u0430\u0437\u0434\u0435\u043b"}),(0,v.jsx)("div",{}),(0,v.jsx)("div",{children:"\u0422\u0435\u043c\u0430"}),(0,v.jsx)("div",{children:"Re"}),(0,v.jsx)("div",{children:"\u0410\u0432\u0442\u043e\u0440"}),(0,v.jsx)("div",{children:(0,v.jsx)("span",{style:{cursor:"pointer"},title:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a",onClick:s,children:t?"\u041e\u0431\u043d\u043e\u0432\u043b\u044f\u0435\u0442\u0441\u044f":"\u041e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u043e"})})]})},st=e=>{let{item:t}=e;return(0,v.jsx)("div",{className:"cell-author",children:(0,v.jsxs)("div",{className:"cell-author--inner",children:[(0,v.jsx)("i",{"aria-hidden":"true",className:"fa fa-user-circle",style:{marginRight:"3px"}}),t.author]})})},at=e=>{let{item:t,onClick:s}=e;return(0,v.jsx)("div",{className:"cell-answ",onClick:s,children:(0,v.jsxs)("div",{className:"cell-answ--inner",children:[(0,v.jsx)("i",{className:"fa fa-comments-o","aria-hidden":"true",style:{marginRight:"3px"}}),(0,v.jsx)("span",{children:t.count})]})})},nt=e=>{let{item:t}=e;return(0,v.jsx)("div",{className:"cell-forum",children:(0,v.jsx)("div",{className:"cell-forum--inner",children:t.forum})})},rt=e=>{let{item:t}=e;return(0,v.jsx)("div",{className:"cell-last20",children:(0,v.jsx)(l.rU,{to:"/topic.php?id=".concat(t.id,"&page=last20#F"),style:{color:"inherit",display:"block",width:"100%",textAlign:"center"},children:(0,v.jsx)("i",{className:"fa fa-angle-right","aria-hidden":"true"})})})},it=e=>{let{item:t}=e;const[s,a]=(0,o.useState)(t.updated);return(0,o.useEffect)((()=>{if(!t.pinned)return;(async()=>{const e=await V(t.id,t.count);a(e.time)})()}),[t.pinned,t.id,t.count]),(0,o.useEffect)((()=>{a(t.updated)}),[t.updated]),(0,v.jsx)("div",{className:"cell-lastuser",children:(0,v.jsxs)("div",{className:"cell-author--inner",children:[(0,v.jsx)("span",{className:"cell-lastuser-time",children:Z(s)}),(0,v.jsx)("span",{className:"cell-lastuser-user",children:t.lastUser})]})})},ot=e=>{let{expanded:t,onClick:s}=e;return(0,v.jsx)("div",{className:"cell-preview-link",onClick:s,children:(0,v.jsx)("span",{children:t?(0,v.jsx)("i",{className:"fa fa-minus-square-o agh","aria-hidden":"true"}):(0,v.jsx)("i",{className:"fa fa-plus-square-o agh","aria-hidden":"true"})})})};var lt=s(1418),ct=s.n(lt);const dt=e=>{let{count:t,topicId:s}=e,a=[];if(t>100){let e=T(t);for(let t=1;t<=e;t++){let n,r="/topic.php?id=".concat(s,"&page=").concat(t);n=t>3&&t<e?"\u2022":String(t),a.push((0,v.jsx)(l.rU,{className:"agh",style:{margin:"3px"},to:r,children:n},t))}}if(t>20){let e="/topic.php?id=".concat(s,"&page=last20#F");a.push((0,v.jsx)(l.rU,{className:"agh",style:{margin:"3px"},to:e,children:"\xbb"},"last20"))}return(0,v.jsx)("span",{className:"topic-pages",children:a})},ut=e=>{let{data:t}=e;const s=te((e=>e.login.userName));let a,n="/topic.php?id=".concat(t.id),r=ct()("agb","mr5",{bold:t.count>=100,mytopics:t.author===s,pinned:t.pinned}),i="/index.php?section=".concat(t.sectionCode);t.section&&(a=(0,v.jsxs)("span",{className:"topic-section",children:[(0,v.jsx)("span",{className:"agh",style:{margin:"0px 5px"},children:"/"}),(0,v.jsx)(l.rU,{rel:"nofollow",className:"agh",to:i,children:t.section},"1")]}));let o=((e,t,s)=>"life"!==t||e.startsWith("OFF")?"job"!==s||e.startsWith("JOB")?"v7"!==s||e.startsWith("v7")?e:"v7: "+e:"JOB: "+e:"OFF: "+e)(t.text,t.forum,t.sectionCode);return(0,v.jsx)("div",{className:"cell-title",children:(0,v.jsxs)("div",{className:"cell-title--inner",children:[t.pinned&&(0,v.jsx)("i",{className:"fa fa-thumb-tack agh","aria-hidden":"true",style:{marginRight:"5px"}}),(0,v.jsx)(l.rU,{to:n,className:r,dangerouslySetInnerHTML:{__html:o},style:{overflowWrap:"anywhere"}}),t.isVoting&&(0,v.jsx)("span",{className:"agh separator",children:"[\xb1]"}),(0,v.jsx)(dt,{count:t.count,topicId:t.id}),t.closed&&(0,v.jsx)("span",{className:"agh",children:"\xd8"}),t.down&&(0,v.jsx)("span",{className:"agh",children:"\u2193"}),a]})})};var ht=s(3892);const pt=e=>{let{topicId:t,onFirst:s,onPrev:a,onNext:n,onLast:r,close:i}=e;return(0,v.jsxs)("div",{className:"topic-preview-rewind",children:[(0,v.jsx)("div",{className:"topic-preview-button flex-small",onClick:s,title:"\u041a \u043f\u0435\u0440\u0432\u043e\u043c\u0443",children:(0,v.jsx)("i",{className:"fa fa-angle-double-left","aria-hidden":"true"})}),(0,v.jsx)("div",{className:"topic-preview-button flex-large",onClick:a,title:"\u041a \u043f\u0440\u0435\u0434\u044b\u0434\u0443\u0449\u0435\u043c\u0443",children:(0,v.jsx)("i",{className:"fa fa-angle-left","aria-hidden":"true"})}),(0,v.jsx)("div",{className:"topic-preview-button flex-large",onClick:n,title:"\u041a \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0435\u043c\u0443",children:(0,v.jsx)("i",{className:"fa fa-angle-right","aria-hidden":"true"})}),(0,v.jsx)("div",{className:"topic-preview-button flex-small",onClick:r,title:"\u041a \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0435\u043c\u0443",children:(0,v.jsx)("i",{className:"fa fa-angle-double-right","aria-hidden":"true"})}),(0,v.jsxs)("div",{className:"topic-preview-button close-preview",onClick:i,children:[(0,v.jsx)("i",{className:"fa fa-angle-right","aria-hidden":"true"}),(0,v.jsx)("i",{className:"fa fa-angle-left","aria-hidden":"true",style:{marginLeft:"-2px"}})]}),(0,v.jsx)("div",{className:"topic-preview-button edit-preview",children:(0,v.jsx)(l.rU,{to:"/topic.php?id=".concat(t,"&page=last20#F"),children:(0,v.jsx)("i",{className:"fa fa-pencil","aria-hidden":"true",style:{color:"var(--font-color)"}})})})]})};var mt=s(1947),xt=s.n(mt);const gt=function(e){const t=new Set("if|\u0435\u0441\u043b\u0438|then|\u0442\u043e\u0433\u0434\u0430|elsif|\u0438\u043d\u0430\u0447\u0435\u0435\u0441\u043b\u0438|else|\u0438\u043d\u0430\u0447\u0435|endif|\u043a\u043e\u043d\u0435\u0446\u0435\u0441\u043b\u0438|do|\u0446\u0438\u043a\u043b|for|\u0434\u043b\u044f|to|\u043f\u043e|each|\u043a\u0430\u0436\u0434\u043e\u0433\u043e|in|\u0438\u0437|while|\u043f\u043e\u043a\u0430|enddo|\u043a\u043e\u043d\u0435\u0446\u0446\u0438\u043a\u043b\u0430|procedure|\u043f\u0440\u043e\u0446\u0435\u0434\u0443\u0440\u0430|endprocedure|\u043a\u043e\u043d\u0435\u0446\u043f\u0440\u043e\u0446\u0435\u0434\u0443\u0440\u044b|function|\u0444\u0443\u043d\u043a\u0446\u0438\u044f|endfunction|\u043a\u043e\u043d\u0435\u0446\u0444\u0443\u043d\u043a\u0446\u0438\u0438|var|\u043f\u0435\u0440\u0435\u043c|export|\u044d\u043a\u0441\u043f\u043e\u0440\u0442|goto|\u043f\u0435\u0440\u0435\u0439\u0442\u0438|and|\u0438|or|\u0438\u043b\u0438|not|\u043d\u0435|val|\u0437\u043d\u0430\u0447|break|\u043f\u0440\u0435\u0440\u0432\u0430\u0442\u044c|continue|\u043f\u0440\u043e\u0434\u043e\u043b\u0436\u0438\u0442\u044c|return|\u0432\u043e\u0437\u0432\u0440\u0430\u0442|try|\u043f\u043e\u043f\u044b\u0442\u043a\u0430|except|\u0438\u0441\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435|endtry|\u043a\u043e\u043d\u0435\u0446\u043f\u043e\u043f\u044b\u0442\u043a\u0438|raise|\u0432\u044b\u0437\u0432\u0430\u0442\u044c\u0438\u0441\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435|false|\u043b\u043e\u0436\u044c|true|\u0438\u0441\u0442\u0438\u043d\u0430|undefined|\u043d\u0435\u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u043e|null|new|\u043d\u043e\u0432\u044b\u0439|execute|\u0432\u044b\u043f\u043e\u043b\u043d\u0438\u0442\u044c|\u0430\u0441\u0438\u043d\u0445|async|\u0436\u0434\u0430\u0442\u044c|wait".split("|")),s=new Set("():;.,=+-*<>?[]%/".split("")),a="<span class=",n="</span>",r="bg>",i="num>",o="str>",l="key>";let c,d,u,h=!1,p="";function m(e){return""===e.trim()}function x(e,t,s){return e.substring(t-1,t-1+s)}function g(e,t){return e.substring(e.length-t)}function f(e){return t.has(e.toLowerCase().trim())}function v(e,t){" "===e||u===t?c+=e:(d&&(c+=n,d=!1),c=c+a+t+e,d=!0,u=t)}function j(e){let t=!1,a=!1,n=1,d=!0,j=1;for(j=1;j<=e.length;j++){let y=e.charAt(j-1);if(h)'"'===y?(v(x(e,n,j-n+1),o),h=!1,p="",d=!0):p+=y;else if(t)"'"===y?(v(x(e,n,j-n+1),o),t=!1,p="",d=!0):p+=y;else if(" "===y)m(p)?c+=" ":(a?(v(p+" ",o),a=!1):f(p.trim())?v(p+" ",l):isNaN(parseInt(p,10))?v(p+" ",r):v(p+" ",i),p=""),d=!0;else if(s.has(y)){if(m(p)||(a?(v(p,o),a=!1,d="."!==y):d&&f(p)?(v(p,l),d="."!==y):(isNaN(parseInt(p,10))?v(p,r):v(p,i),d="."!==y),p=""),"."===y&&u===i){v(y,i);continue}if("="===y&&"<"===x(e,j-1,1))u=void 0;else if("/"===y&&"/"===x(e,j+1,1))return void v(g(e,e.length-j+1),"com>");v(y,"sp>")}else if('"'===y||"|"===y)m(p)?(n=j,h=!0):(v(p+y,o),p=""),d=!0;else if("'"===y)m(p)?(n=j,t=!0):(v(p+y,o),p=""),d=!0;else{if("#"===y||"&"===y&&m(c)){v(g(e,e.length-j+1),"pr>"),j=e.length;break}"~"===y?(p+=y,a=!0):p+=y}}h||t?v(x(e,n,j-n+1),o):m(p)||(f(p)?v(p,l):isNaN(parseInt(p,10))?v(p,r):v(p,i))}h=!1,p="",d=!1,u=void 0,c="";let y=[];for(let b of e.split("\n"))m(b)?y.push(""):(c="",j(b),d&&!h?(c+="</span>",d=!1,u="",p=""):h||(u="",p=""),y.push(c));return y.join("\n")},ft=e=>{let{children:t}=e;const[s,a]=(0,o.useState)(!0);let n="";if(t){n=_(t).join(""),n=(e=>{let t=e.replace(/\n<br>/g,"\n").replace(/<br>\n/g,"\n").replace(/\r<br>/g,"\n").replace(/<br>\r/g,"\n").replace(/<br>/g,"\n").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt");for(;"\n"===t[0];)t=t.substring(1);for(;"\n"===t.substring(t.length-1);)t=t.substring(0,t.length-1);return gt(t)})(n)}let r,i=0;n&&(i=n.split("\n").length),r=s?"\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c: ".concat(i," \u0441\u0442\u0440\u043e\u043a"):"\u0421\u043a\u0440\u044b\u0442\u044c";let l=null;i>7&&(l=(0,v.jsx)("div",{className:"expand-button-div",children:(0,v.jsx)("span",{className:"expand-button-span",onClick:()=>{a(!s)},children:r})}));let c={};return s&&i>7?(c.overflow="hidden",c.height="135px"):(c.overflow="auto",c.height="auto"),(0,v.jsxs)("div",{style:{marginTop:"5px"},children:[(0,v.jsx)("pre",{className:"code-pre",style:c,dangerouslySetInnerHTML:{__html:n}}),l]})},vt=e=>{const t=(0,o.useRef)(null),s=se(be),a=te((e=>{var t;return null===(t=e.topic.info)||void 0===t?void 0:t.id})),n=te((e=>+e.options.items.tooltipDelay));let r="";r=e.children?_(e.children).join(""):String(e.number);const[i,l]=(0,o.useState)(r);(0,o.useEffect)((()=>{let t=!0;if(!r.startsWith("http"))return void l(r);return(async()=>{const{title:s}=await E(e.topicId);t&&l(s)})(),()=>{t=!1}}),[r,e.topicId]);const c=e=>{e.persist(),t.current=window.setTimeout((()=>h(e)),n)},d=()=>{t.current&&clearTimeout(t.current)},u=e=>{e.stopPropagation(),t.current&&clearTimeout(t.current),h(e)},h=t=>{const{topicId:a,number:n}=e,r={x:t.pageX,y:t.pageY-50},i={topicId:+a,number:+n};s.show({keys:i,coords:r})};if(e.topicId!==a&&isNaN(+i)){const t=T(e.number);let s="";return t>1&&(s="&page=".concat(t)),(0,v.jsxs)("span",{children:[(0,v.jsx)("a",{href:"#/topic.php?id=".concat(e.topicId).concat(s,"#").concat(e.number),style:(0,y.Z)({},e.style),children:i})," ","(",(0,v.jsx)("span",{onMouseOver:c,onMouseOut:d,onClick:u,className:"link",role:"button",children:e.number}),")"]})}return(0,v.jsx)("span",{onMouseOver:c,onMouseOut:d,onClick:u,className:"link",style:(0,y.Z)({},e.style),role:"button",children:i})};var jt=s(5987),yt=s(5915),bt=s.n(yt);const Nt=e=>{let{href:t,children:s}=e;return(0,v.jsx)("a",{href:t,className:"registered-user",children:s})},wt=e=>{let{href:t}=e,[s,a]=(0,o.useState)(t),[n,r]=(0,o.useState)("");(0,o.useEffect)((()=>{let e=!0;return(async()=>{const s=(e=>{let t=e;-1===e.search(/http/)&&(t="http://"+t);try{var s=new URL(t)}catch(a){return null}return-1!==s.hostname.search(/youtube/)?s.searchParams.get("v"):-1!==s.hostname.search(/youtu\.be/)?s.pathname.substring(1):null})(t);if(s)try{const n=await(async e=>{const t=localStorage.getItem("youtubeApiKey")||"AIzaSyCztN2QW4Fxw_1YuAHBTOZdYLbzigPz25g";let s="https://www.googleapis.com/youtube/v3/videos?key=".concat(t,"&fields=items(snippet(title))&part=snippet&id=").concat(e);const a=await fetch(s),n=await a.json();if(0===n.items.length)return{hrefName:"",title:"",notFound:!0};const r=n.items[0].snippet.title;let i=r;return r.length>55&&(i=i.substring(0,50)+"..."),{hrefName:i,title:r,notFound:!1}})(s);e&&(n.notFound?a(t+" (\u0432\u0438\u0434\u0435\u043e \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e)"):(a(n.hrefName),r(n.title)))}catch(n){console.error("youtube",s,n.message)}})(),()=>{e=!1}}),[t]);return(0,v.jsx)("a",{href:t,title:n,children:"".concat("youtube",": ").concat(s)})},kt=["href","children","parentText"],It=e=>{let{href:t,children:s,parentText:a}=e,n=(0,jt.Z)(e,kt);const r=te((e=>"true"===e.options.items.showYoutubeVideoTitle)),i=te((e=>"true"===e.options.items.replaceCatalogMista)),o=te((e=>"true"===e.options.items.fixBrokenLinks));try{var l=new(bt())(t,!0)}catch(u){return console.error(u.message,t),(0,v.jsx)("a",{href:t,children:t})}let c=t;if(c.startsWith("/")&&(l.set("protocol","https"),l.set("hostname","forum.mista.ru"),c=l.href),-1!==l.hostname.search(/forum\.mista.ru/)){if("/topic.php"===l.pathname)return(0,v.jsx)(vt,{topicId:l.query.id,number:l.hash.replace("#","")||"0",children:_(s)});if("/users.php"===l.pathname)return(0,v.jsx)(Nt,{href:l.href,children:s})}return"a-sitnikov.github.io"===l.hostname&&"/react.mista/"===l.pathname&&0===Object.keys(l.query).length&&"/react.mista/topic.php"===(l=new(bt())(t.replace(/#\//,""),!0)).pathname?(0,v.jsx)(vt,{topicId:l.query.id,number:l.hash.replace("#","")||"0",children:_(s)}):!r||-1===(d=l.hostname).search(/youtube/)&&-1===d.search(/youtu\.be/)?i&&(e=>-1!==e.search(/catalog\.mista/))(l.hostname)?(l.set("hostname","infostart.ru"),(0,v.jsxs)("a",{target:null===n||void 0===n?void 0:n.target,className:null===n||void 0===n?void 0:n.class,rel:null===n||void 0===n?void 0:n.rel,href:l.href,children:[l.href," "]})):(o&&a&&(c=((e,t)=>{let s=e.replace(/\[/g,"\\[").replace(/\]/g,"\\]").replace(/\./g,"\\.").replace(/\./g,".").replace(/\*/g,"\\*").replace(/\+/g,"\\+").replace(/\(/g,"\\(").replace(/\)/g,"\\)").replace(/\?/g,"\\?").replace(/\//g,"\\/");try{let a=new RegExp(s+"<\\/a>(\\)|[\u0430-\u044f\u0451\u0410-\u042f\u04010-9#\\-\\+\\_\\%\\?=]*)"),n=t.match(a);if(n&&n.length>1)return")"===n[1]&&-1===e.search("\\(")?e:e+=n[1]}catch(u){console.error(u)}return e})(c,a)),(0,v.jsx)("a",{target:null===n||void 0===n?void 0:n.target,className:null===n||void 0===n?void 0:n.class,rel:null===n||void 0===n?void 0:n.rel,href:c,children:s})):(0,v.jsx)(wt,{href:t});var d},Ct=e=>{let{topicId:t,data:s,total:a,n:n,colors:r}=e;const i="".concat(W,"/css/voting").concat(n,".png");let o=0;a&&(o=Math.round(100*s.count/a));return(0,v.jsxs)("li",{className:"voting-item",children:[(0,v.jsx)("div",{className:"voting-title",children:(0,v.jsx)("a",{rel:"nofollow",style:{textDecoration:"none"},href:"#/topic.php?id=".concat(t,"&sel=").concat(n),children:(0,v.jsx)("b",{children:(0,v.jsx)("span",{style:{color:r[n-1]},children:"".concat(n,". ").concat(s.text)})})})}),(0,v.jsx)("div",{className:"voting-percentage",children:(0,v.jsx)("b",{children:(0,v.jsx)("span",{style:{color:r[n-1]},children:"".concat(o,"% (").concat(s.count,")")})})}),(0,v.jsx)("div",{className:"voting-bar",children:(0,v.jsx)("div",{style:{width:"".concat(o,"%")},children:(0,v.jsx)("a",{href:i,children:(0,v.jsx)("img",{src:i,style:{maxWidth:"500px",width:"100%",height:"15px"},alt:"\u0432\u0430\u0440\u0438\u0430\u043d\u0442 ".concat(n)})})})})]})},St=e=>{let{items:t,topicId:s,colors:a}=e,n=Math.max(...t.map((e=>e.count)));return(0,v.jsx)("ul",{style:{paddingLeft:0},children:t.filter((e=>e.text)).map(((e,t)=>(0,v.jsx)(Ct,{data:e,total:n,n:t+1,topicId:s,colors:a},t)))})},Tt=(0,o.memo)((e=>{let{colors:t,n:s,text:a}=e;return(0,v.jsx)("div",{style:{marginTop:"5px"},children:(0,v.jsx)("b",{children:(0,v.jsx)("span",{style:{color:t[s-1]},children:"".concat(s,". ").concat(a)})})})}));var _t=s(5930);s(432);const Zt=e=>{let{idx:t,topicId:s,topicDate:a,messageNumber:n}=e;const r=I()(a).format("YYYY/MM/DD"),i="https://forum.mista.ru/topics/files/".concat(r,"/").concat(s,"/").concat(n),o="".concat(i,"/").concat(t,"_preview.png"),l="".concat(i,"/").concat(t,".png");return(0,v.jsx)(_t.HI,{src:l,children:(0,v.jsx)("img",{src:o,alt:"",style:{maxWidth:"100%",cursor:"pointer"}})})},Lt=(0,o.memo)(Zt),Mt=xt().Parser(),Ot=xt().ProcessNodeDefinitions(),Pt=()=>!0,Dt={shouldProcessNode:e=>"link"===(null===e||void 0===e?void 0:e.name),processNode:(e,t,s)=>{const a=e.attribs["data-topicid"],n=e.attribs["data-number"];return(0,v.jsx)(vt,{topicId:a,number:n},s)}},Rt={shouldProcessNode:e=>"code"===(null===e||void 0===e?void 0:e.name)||"pre"===(null===e||void 0===e?void 0:e.name),processNode:(e,t,s)=>(0,v.jsx)(ft,{children:t},s)},Et=e=>({shouldProcessNode:e=>"a"===(null===e||void 0===e?void 0:e.name),processNode:function(t,s,a){const n=t.attribs.href;return(0,v.jsx)(It,{href:n,parentText:e,children:s},a)}}),Ft=(e,t,s)=>({shouldProcessNode:e=>"int_img"===(null===e||void 0===e?void 0:e.name),processNode:function(a,n,r){const i=a.attribs.idx;return(0,v.jsx)(Lt,{topicId:e,topicDate:t,messageNumber:s,idx:i},r)}}),zt=(0,o.memo)((e=>{let{html:t,topicId:s,topicDate:a,messageNumber:n}=e;const r=((e,t,s,a)=>{if(!e)return e;let n=(e=>e.replace(/\[1[C\u0421]\]/gi,"<code>").replace(/<1[C\u0421]>/gi,"<code>").replace(/\[\/1[C\u0421]\]/gi,"</code>").replace(/<\/1[C\u0421]>/gi,"</code>"))(e);return n=((e,t)=>e.replace(/(\()(\d+)(\))(?![^<>]*<\/)/gi,(function(e){const s=arguments.length<=2?void 0:arguments[2];return"(<link data-topicid='".concat(t,"' data-number='").concat(s,"'></link>)")})))(n,t),n=((e,t,s,a)=>e.replace(/\[IMG_(\d*)\]/gi,(function(e){return"<int_img idx='".concat(arguments.length<=1?void 0:arguments[1],"'></int_img>")})))(n),n})(t,s),i=[Dt,Rt,Et(r),Ft(s,a,n),{shouldProcessNode:()=>!0,processNode:Ot.processDefaultNode}],o=Mt.parseWithInstructions(r,Pt,i);return(0,v.jsx)(v.Fragment,{children:o})})),Vt=e=>{let{topicId:t,topicDate:s,n:a,html:n,vote:r,style:i}=e;const l=te((e=>e.topic.info)),c=te((e=>e.options.voteColors));let d=null;r&&l.voting&&t===l.id&&(d=l.voting[r-1].text);const[u,h]=(0,o.useState)(d);(0,o.useEffect)((()=>{r&&!d&&(async()=>{try{const e=await E(t);h(e.voting[r-1].text)}catch(e){console.error(e.message)}})()}),[r,d,t]);const p=0!==r&&null!==u;let m;return 0===a&&l.isVoting&&l.voting&&(m=(0,v.jsx)(St,{items:l.voting,topicId:t,colors:c})),(0,v.jsxs)("div",{className:"message",style:i,children:[m,(0,v.jsx)("div",{children:(0,v.jsx)(_t.TV,{children:(0,v.jsx)(zt,{html:n,topicId:t,topicDate:s,messageNumber:a})})}),p&&(0,v.jsx)(Tt,{text:u,n:r,colors:c})]})},At=e=>{const t=se(De),[s,a]=(0,o.useState)("none"),n=()=>{const{data:s}=e;t.changeText("(".concat(s.n,")"));let a=document.getElementById("message_text");a&&window.scrollTo(0,a.offsetTop)},{data:r,isAuthor:i,isYou:l,isTooltip:c}=e;(0,o.useEffect)((()=>{a("none")}),[r.n]);const d="".concat(W,"/users.php?id=").concat(r.userId);let u;u=r?0===r.n?I()(r.time).format("DD.MM.YY - HH:mm"):(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("span",{className:"message-number",children:r.n})," - "+I()(r.time).format("DD.MM.YY - HH:mm")]}):"";const h=ct()("registered-user",{"is-author":i,"is-you":l});let p,m;return window.innerWidth>768&&(p=(0,v.jsx)("img",{src:"".concat(W,"/css/user_icons/").concat(r.userId,"_16x16.png"),alt:"user ico",onLoad:()=>{a("inline")},onError:()=>{a("none")},style:{display:s,marginBottom:"4px",marginRight:"1px"}})),m=c?(0,v.jsx)("div",{className:"ah",style:{display:"inline-block",marginLeft:"5px"},children:u}):(0,v.jsxs)("div",{className:"message-time",children:[(0,v.jsx)("span",{className:"ah",children:u}),(0,v.jsx)("button",{className:"button ah",onClick:n,children:u})]}),(0,v.jsxs)("div",{className:"user-info",children:[p,(0,v.jsx)("a",{className:h,href:d,children:r.user}),m]})},Ut=e=>{let{topicId:t,n:s,author:a,loggedUserId:n,onDataLoaded:r}=e;const[i,l]=(0,o.useState)(null),[c,d]=(0,o.useState)(null);return(0,o.useEffect)((()=>{(async()=>{try{const e=await V(t,s);e?(l(e),d(null),r&&r()):(l(null),d("\u041d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435 ".concat(s)))}catch(e){l(null),d(e.message)}})()}),[t,s,r]),i||c?(0,v.jsxs)(v.Fragment,{children:[i&&(0,v.jsxs)("div",{className:"preview-content",children:[(0,v.jsx)("div",{className:"topic-preview-userinfo",children:(0,v.jsx)(At,{data:i,isAuthor:i.user===a,isYou:i.userId===n,isTooltip:!0})}),(0,v.jsx)(Vt,{topicId:t,topicDate:i.time,n:s,html:i.text,vote:i.vote,style:{overflowY:"auto",overflowWrap:"break-word"}})]}),c&&(0,v.jsx)("span",{children:c})]}):null},Wt=e=>{let{topicId:t,initialMsgNumber:s,author:a,close:n}=e;const r=te((e=>e.login.userId)),[i,l]=(0,o.useState)(0),[c,d]=(0,o.useState)("none"),[u,h]=(0,o.useState)({msgNumber:s,key:0}),p=(0,ht.QS)({onSwiping:e=>{Math.abs(e.deltaX)<35?l(0):l(e.deltaX)},onSwiped:e=>{Math.abs(e.deltaX)>150&&("Left"===e.dir?h({msgNumber:u.msgNumber+1,key:u.key+1}):"Right"===e.dir&&u.msgNumber>0&&h({msgNumber:u.msgNumber-1,key:u.key+1})),l(0)},delta:15}),m=(0,o.useCallback)((()=>{d("block")}),[]);let x=[u.msgNumber];i<0?x.push(u.msgNumber+1):i>0&&u.msgNumber>0&&x.push(u.msgNumber-1);const g={transform:"translate3d(".concat(i,"px, 0px, 0px)"),flexDirection:i>0?"row-reverse":"row"};return(0,v.jsx)("div",{className:"preview-container",style:{display:c},children:(0,v.jsxs)("div",{className:"topic-preview",children:[(0,v.jsx)(pt,{topicId:t,onFirst:()=>{h({msgNumber:0,key:u.key})},onLast:async()=>{const e=await E(t);h({msgNumber:e.count,key:u.key})},onNext:()=>{h({msgNumber:u.msgNumber+1,key:u.key})},onPrev:()=>{u.msgNumber>0&&h({msgNumber:u.msgNumber-1,key:u.key})},close:n}),(0,v.jsxs)("div",(0,y.Z)((0,y.Z)({className:"preview-carousel"},p),{},{style:g,children:[(0,v.jsx)("div",{className:"preview-carousel-item",style:{order:0},children:(0,v.jsx)(Ut,{topicId:t,n:x[0],loggedUserId:r,author:a,onDataLoaded:m})},u.key),x.length>1&&(0,v.jsx)("div",{className:"preview-carousel-item",style:{order:1},children:(0,v.jsx)(Ut,{topicId:t,n:x[1],loggedUserId:r,author:a})},u.key+1)]}))]})})},Yt=e=>{let{item:t}=e;const[s,a]=(0,o.useState)();return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsxs)("div",{className:"topics-list-row",children:[(0,v.jsx)(nt,{item:t}),(0,v.jsx)("div",{className:"cell-section",children:t.section}),(0,v.jsx)(at,{item:t,onClick:()=>{void 0===s||s!==t.count?a(t.count):a(void 0)}}),(0,v.jsx)(ot,{expanded:void 0!==s,onClick:()=>{a(void 0===s?0:void 0)}}),(0,v.jsx)(ut,{data:t}),(0,v.jsx)(st,{item:t}),(0,v.jsx)(it,{item:t}),(0,v.jsx)(rt,{item:t})]}),void 0!==s&&(0,v.jsx)(Wt,{topicId:t.id,initialMsgNumber:s,author:t.author,close:()=>a(void 0)})]})};var Ht=s(8116);const Bt=e=>{let{maxPage:t,last20:s}=e;const a=(0,h.TH)();let n=a.pathname;"/"===n&&(n="/index.php");const r=new URLSearchParams(a.search);let i;const o=r.get("page");i=o?"last20"===o?"last20":parseInt(o,10)||1:1;let l=[];for(let c=1;c<=t;c++){r.set("page",String(c));let e="#"+n+"?"+r.toString();l.push((0,v.jsx)(Ht.Z.Item,{active:i===c,href:e,children:c},c))}if(!0===s){r.set("page","last20");let e="#"+n+"?"+r.toString();l.push((0,v.jsx)(Ht.Z.Item,{active:"last20"===i,href:e,children:"\xbb"},"last20"))}return(0,v.jsx)(Ht.Z,{style:{margin:"0px"},children:l})};var Kt=s(323),qt=s(6144);const Jt=e=>{let{placeholder:t,showVoting:s,isVoting:a,isFetching:n,text:r,formRef:i,onChange:l,onShowVotingChange:c}=e;const d=(0,o.useRef)(),h=(0,o.useCallback)((e=>{c&&c(e.currentTarget.checked)}),[c]),p=(0,o.useCallback)((e=>{l&&l(e.currentTarget.value)}),[l]);return(0,v.jsxs)("div",{children:[(0,v.jsx)(m.Z,{as:"textarea","aria-label":"\u0421\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435",placeholder:t,cols:70,rows:3,value:r,onChange:p,onKeyUp:e=>{i&&i.current&&"Enter"===e.key&&e.ctrlKey&&i.current.dispatchEvent(new Event("submit",{cancelable:!0,bubbles:!0}))},ref:d,className:"text-editor input","data-lpignore":!0}),(0,v.jsxs)("div",{className:"flex-row",children:[(0,v.jsxs)(qt.Z,{children:[(0,v.jsx)(Je.Z,{size:"sm",variant:"light",onClick:e=>{e.preventDefault();const t=d.current,s=t.selectionStart,a=t.selectionEnd,n=t.value,r=n.length,i="[1C]\n"+n.substring(s,a)+"\n[/1C]";let o=n.substring(0,s)+i+n.substring(a,r);l&&l(o)},style:{marginRight:"5px"},className:"button",children:"\u041a\u043e\u0434 1\u0421"}),(0,v.jsx)(Je.Z,{size:"sm",variant:"light",disabled:n,type:"submit",className:"button",children:n?"\u041e\u0442\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u0442\u0441\u044f":"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c"})]}),s&&(0,v.jsx)(u.Z.Check,{id:"show_voting",type:"checkbox",checked:a,onChange:h,label:"\u0413\u043e\u043b\u043e\u0441\u043e\u0432\u0430\u043d\u0438\u0435",style:{margin:"auto 0px auto auto"}})]})]})},Xt=e=>{var t;let{onSubmitSuccess:s}=e;const{data:a}=Ee(),n=te((e=>e.newTopic)),[r,i]=(0,o.useState)(null),[l,c]=(0,o.useState)(Array(10).fill("")),d=(0,o.useRef)(null),h=ee(),m=se(me),x=(0,f.$0)(((e,t)=>{i(t),m.changeSection(t)})),g=e=>t=>{let s=l.slice();s[e]=t.target.value,c(s)},j=(0,f.$0)((e=>{if(e.preventDefault(),!r)return void m.setError("\u041d\u0435 \u0432\u044b\u0431\u0440\u0430\u043d\u0430 \u0441\u0435\u043a\u0446\u0438\u044f");let t=n.subject;if(!t)return void m.setError("\u041d\u0435 \u0443\u043a\u0430\u0437\u0430\u043d\u0430 \u0442\u0435\u043c\u0430");if(!n.text)return void m.setError("\u041d\u0435 \u0443\u043a\u0430\u0437\u0430\u043d\u043e \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435");let s={subject:t,text:n.text,section:r.id,forum:r.forum,isVoting:n.isVoting,votingItems:[],onSuccess:w};if(n.isVoting){s.votingItems=[];for(let e=1;e<=10;e++){let t=l[e-1];t&&s.votingItems.push(t)}}h((e=>(t,s)=>{if((e=>{let{newTopic:t}=e;return!!t&&"loading"!==t.status})(s()))return t(ue(e))})(s))})),y=(0,o.useCallback)((e=>{m.changeSubject(e.target.value)}),[m]),b=(0,o.useCallback)((e=>{m.changeText(e)}),[m]),N=(0,o.useCallback)((e=>{m.showVoting(e)}),[m]),w=()=>{m.clear(),s&&s()};let k=[];for(let o in a.tree)k.push((0,v.jsx)("option",{value:o.toLowerCase(),children:o},o));let I=[];if(n.isVoting){I.push((0,v.jsx)("div",{children:"\u0412\u0430\u0440\u0438\u0430\u043d\u0442\u044b:"},"p"));for(let e=1;e<=10;e++)I.push((0,v.jsxs)(p.Z,{size:"sm",style:{marginBottom:"3px",width:"100%"},children:[(0,v.jsx)(p.Z.Text,{style:{width:"40px"},className:"input",children:"".concat(e,".")}),(0,v.jsx)(u.Z.Control,{type:"text","aria-label":"\u0412\u0430\u0440\u0438\u0430\u043d\u0442 ".concat(e),maxLength:50,className:"input",value:l[e-1],onChange:g(e-1)})]},e))}return(0,v.jsxs)("form",{className:"new-topic-container",onSubmit:j,ref:d,children:[(0,v.jsxs)("div",{id:"newtopic_form",className:"new-topic-text",children:[(0,v.jsx)("div",{children:(0,v.jsx)("b",{children:"\u041d\u043e\u0432\u0430\u044f \u0442\u0435\u043c\u0430:"})}),n.error&&(0,v.jsx)($e,{text:n.error}),(0,v.jsxs)("div",{className:"flex-row",style:{marginBottom:"3px"},children:[(0,v.jsx)(u.Z.Select,{disabled:!0,size:"sm",value:n.forum,style:{flex:"0 1 90px"},className:"input",children:k}),(0,v.jsx)(Qe,{id:"target_section",defaultValue:"\u0421\u0435\u043a\u0446\u0438\u044f",selected:null===(t=n.section)||void 0===t?void 0:t.code,size:"sm",style:{flex:"1 1 auto"},onChange:x})]}),(0,v.jsx)(u.Z.Control,{type:"text","aria-label":"\u0422\u0435\u043c\u0430",placeholder:"\u0422\u0435\u043c\u0430",size:"sm",value:n.subject,onChange:y,style:{marginBottom:"3px"},className:"input",maxLength:90}),(0,v.jsx)(Jt,{placeholder:"\u0421\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435",showVoting:!0,isVoting:n.isVoting,text:n.text,isFetching:"loading"===n.status,onChange:b,onShowVotingChange:N,formRef:d})]}),(0,v.jsx)(Kt.Z,{className:"new-topic-voting",children:I})]})},$t=()=>{const[e]=(0,l.lr)(),{isFetching:t,data:s,error:a,refetch:n}=Fe({searchParams:e});return(0,o.useEffect)((()=>{document.title="React.Mista"}),[]),(0,o.useEffect)((()=>{window.scrollTo(0,0)}),[e]),(0,v.jsxs)("div",{children:[(0,v.jsx)(et,{}),a&&(0,v.jsx)($e,{text:a.message}),(0,v.jsxs)("div",{className:"topic-list-table",children:[(0,v.jsx)(tt,{onUpdateClick:n,isLoading:t}),(null!==s&&void 0!==s?s:[]).map((e=>(0,v.jsx)(Yt,{item:e},e.id))),(0,v.jsx)("div",{className:"table-footer",children:(0,v.jsx)(Bt,{maxPage:10})})]}),(0,v.jsx)("div",{id:"F",className:"newtopic",style:{marginBottom:"10px",marginTop:"5px",position:"relative"},children:(0,v.jsx)(Xt,{onSubmitSuccess:n})})]})},Gt={"1c":"1\u0421:\u041f\u0440\u0435\u0434\u043f\u0440\u0438\u044f\u0442\u0438\u0435",life:"\u041e \u0436\u0438\u0437\u043d\u0438",it:"\u0418\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u043e\u043d\u043d\u044b\u0435 \u0442\u0435\u0445\u043d\u043e\u043b\u043e\u0433\u0438\u0438",job:"\u0420\u0430\u0431\u043e\u0442\u0430"},Qt=()=>{const e=te((e=>e.topic.info));return(0,v.jsxs)("div",{className:"flex-row",children:[(0,v.jsx)("div",{className:"header-left",children:(0,v.jsx)(Ge,{})}),(0,v.jsx)("div",{className:"header-right",children:(0,v.jsx)("span",{id:"forum_string",className:"bold120",children:(0,v.jsx)(l.rU,{to:"/index.php?forum=".concat(e.forum),style:{textDecoration:"none"},children:Gt[e.forum]})})})]})},es=e=>{let{topicId:t}=e;const{data:s}=ze({topicId:t},{select:e=>null===e||void 0===e?void 0:e.info.title});let a="https://www.yandex.ru/search/?text="+encodeURIComponent(s);return(0,v.jsxs)("div",{className:"topic-row",children:[(0,v.jsx)("div",{className:"cell-userinfo",children:(0,v.jsxs)("div",{className:"topic-tools",children:[(0,v.jsx)("a",{title:"API.info",href:"".concat(W,"/").concat(H,"?id=").concat(t),className:"agh",style:{display:"block",lineHeight:"1em"},children:"i"}),(0,v.jsx)("a",{title:"API.messages",href:"".concat(W,"/").concat(B,"?id=").concat(t,"&from=0&to=20"),className:"agh",style:{display:"block",lineHeight:"1em"},children:"m"})]})}),(0,v.jsx)("div",{className:"cell-message",children:(0,v.jsxs)("div",{className:"flex-row",children:[(0,v.jsxs)("div",{style:{flex:1,textAlign:"center"},children:[(0,v.jsx)("a",{href:"https://forum.mista.ru/topic/".concat(t),children:(0,v.jsx)("h1",{className:"topic-title",dangerouslySetInnerHTML:{__html:s}})}),(0,v.jsx)("div",{className:"moder-action"})]}),(0,v.jsx)("div",{style:{flex:"0 0 20px",position:"relative"},children:(0,v.jsx)("div",{className:"div-va-middle",children:(0,v.jsx)("a",{rel:"noopener noreferrer",href:a,title:"\u0418\u0441\u043a\u0430\u0442\u044c \u0432 \u042f\u043d\u0434\u0435\u043a\u0441\u0435",target:"_blank",className:"yandex",children:"\u042f"})})})]})})]})},ts=e=>{let{data:t,topicId:s}=e;const a=te((e=>e.login)),n=te((e=>{var t;return(null===(t=e.topic.item0)||void 0===t?void 0:t.user)||""}));return t?(0,v.jsxs)("div",{className:"topic-row",id:String(t.n),children:[(0,v.jsx)("div",{className:"cell-userinfo",children:(0,v.jsx)(At,{data:t,isAuthor:t.user===n,isYou:t.user===a.userName})}),(0,v.jsx)("div",{className:"cell-message",children:(0,v.jsx)(Vt,{html:t.text,topicId:s,topicDate:t.time,n:t.n,vote:t.vote})})]}):null},ss=e=>{let{page:t}=e;const s=ee(),a=te((e=>e.topic.info||we)),n=te((e=>e.topic.status)),r=T(a.count);let i=!1;return"last20"!==t&&t!==r||(i=!0),(0,v.jsxs)("div",{className:"flex-row",id:"F",children:[(0,v.jsx)("div",{className:"ta-left va-top",style:{width:"50%"},children:(0,v.jsx)(Je.Z,{onClick:()=>{},disabled:!1,size:"sm",className:"button",variant:"light",children:"\u0417\u0430\u043a\u043b\u0430\u0434\u043a\u0430"})}),(0,v.jsx)("div",{className:"ta-right va-middle",style:{marginLeft:"auto"},children:i&&(0,v.jsx)(Je.Z,{onClick:()=>{s(_e())},disabled:"loading"===n,size:"sm",className:"button",variant:"light",children:"loading"===n?"\u041e\u0431\u043d\u043e\u0432\u043b\u044f\u0435\u0442\u0441\u044f":"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0432\u0435\u0442\u043a\u0443"})})]})},as=e=>{let{onSubmitSuccess:t}=e;const[s,a]=(0,o.useState)(),n=ee(),r=se(De),i=te((e=>e.topic.info)),l=te((e=>e.newMessage)),c=()=>{r.changeText(""),a(void 0),t&&t()},d=e=>{e.preventDefault(),a(void 0)},h=e=>{a(e)},p=(0,o.useCallback)((e=>{n(me.changeText(e))}),[n]);let m;if(null!==i&&void 0!==i&&i.isVoting&&null!==i&&void 0!==i&&i.voting){let e=[];for(let t=1;t<=i.voting.length;t++){const a=i.voting[t-1];a.text&&e.push((0,v.jsx)(u.Z.Check,{type:"radio",name:"voting",checked:s===t,onChange:()=>h(t),label:"".concat(t,". ").concat(a.text)},t))}m=(0,v.jsxs)(Kt.Z,{children:[(0,v.jsx)("legend",{children:(0,v.jsxs)("small",{children:["\u0412\u0430\u0448 \u0432\u044b\u0431\u043e\u0440:",(0,v.jsx)("span",{id:"voting_clear",style:{marginLeft:"5px",cursor:"pointer"},onClick:d,children:"\u043e\u0447\u0438\u0441\u0442\u0438\u0442\u044c"})]})}),e,"\u041e\u0431\u043e\u0441\u043d\u0443\u0439\u0442\u0435 \u0441\u0432\u043e\u0439 \u0432\u044b\u0431\u043e\u0440!"]})}return(0,v.jsxs)("form",{style:{marginTop:"5px"},onSubmit:e=>{e.preventDefault(),e.stopPropagation();let t={text:l.text,topicId:String(null===i||void 0===i?void 0:i.id),onSuccess:c,voting_select:void 0};s&&(t.voting_select=s),n(Oe(t))},children:[(0,v.jsx)("div",{className:"bold",children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435 \u0432 \u0442\u0435\u043c\u0443:"}),(0,v.jsxs)("div",{className:"new-message-container",children:[(0,v.jsx)("div",{className:"new-message-text",children:(0,v.jsx)(Jt,{isFetching:"loading"===l.status,text:l.text,placeholder:"\u0421\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435",onChange:p})}),(0,v.jsx)("div",{className:"new-message-voting",children:m})]})]})};var ns;const rs=()=>{const e=ee(),t=se(Le),s=(0,h.TH)(),[a]=(0,l.lr)(),n=+a.get("id"),{data:r,error:i}=ze({topicId:n}),{info:c,item0:d,list:u=[]}=null!==r&&void 0!==r?r:{},p=te((e=>e.login)),m=(x=a.get("page"))?"last20"===x?"last20":isNaN(+x)?1:+x:1;var x;const g=T(null===c||void 0===c?void 0:c.count),f="last20"===m||m===g,j=(0,o.useCallback)((()=>{f&&e(_e())}),[e,f]);return(0,o.useEffect)((()=>{var e;null!==c&&void 0!==c&&c.title&&(document.title=(e=c.title,(new DOMParser).parseFromString(e,"text/html").firstChild.innerText))}),[null===c||void 0===c?void 0:c.title]),(0,o.useEffect)((()=>{const e=window.setInterval(j,6e4);return()=>{t.clear(),ns=void 0,e&&clearInterval(e)}}),[t,j]),(0,o.useEffect)((()=>{if(!ns&&s.hash&&u.length>0){const e=document.getElementById(s.hash.slice(1));e&&setTimeout((()=>window.scrollTo(0,e.offsetTop)),1),ns=!0}})),(0,v.jsxs)("div",{style:{marginBottom:"5px"},children:[(0,v.jsx)(Qt,{}),i&&(0,v.jsx)($e,{text:i.message}),(0,v.jsxs)("div",{className:"topic-table",children:[(0,v.jsx)(es,{topicId:n}),(0,v.jsx)(ts,{data:d,topicId:n},"0"),u.map(((e,t)=>(0,v.jsx)(ts,{data:e,topicId:n},e.n))),(g>1||"last20"===m)&&(0,v.jsx)("div",{className:"table-footer",children:(0,v.jsx)(Bt,{maxPage:g,last20:!0})})]}),(0,v.jsx)(ss,{page:m}),p.logged&&(0,v.jsx)(as,{onSubmitSuccess:()=>{j(),e(De.changeText(""))}})]})},is=e=>{let{name:t,label:s,value:a,values:n,oneLine:r,onChange:i}=e;const o=e=>{i(e,t,e.target.value)};return(0,v.jsxs)("span",{children:[(0,v.jsxs)("span",{style:{marginRight:"5px"},children:[" ",s," "]}),r&&(0,v.jsx)("br",{}),n.map(((e,t)=>(0,v.jsx)(u.Z.Check,{type:"radio",id:e.name,label:e.descr,name:s,checked:e.name===a,value:e.name,inline:r,onChange:o},t)))]})},os=e=>{const{name:t,value:s,label:a,postfix:n}=e;return(0,v.jsxs)("label",{htmlFor:t,style:{marginRight:"5px"},children:[(0,v.jsx)("span",{style:{marginRight:"5px"},children:a}),(0,v.jsx)("input",{type:"string",name:t,value:s,onChange:t=>{const{name:s}=e;e.onChange(t,s,t.target.value)},className:"input"}),void 0!==n?(0,v.jsx)("span",{style:{marginLeft:"5px"},children:n}):null]})},ls=[{tabName:"\u041e\u0431\u0449\u0438\u0435",rows:[["theme"],["topicsPerPage"],["autoRefreshTopicsList","autoRefreshTopicsListInterval"],["autoRefreshTopic","autoRefreshTopicInterval"]]},{tabName:"\u0422\u0443\u043b\u0442\u0438\u043f\u044b",rows:[["showTooltips","tooltipDelay"],["showTooltipOnPostLink"]]},{tabName:"\u0421\u0441\u044b\u043b\u043a\u0438",rows:[["showYoutubeVideoTitle"],["replaceCatalogMista"],["fixBrokenLinks"]]}],cs={theme:{type:"radio",label:"\u0426\u0432\u0435\u0442\u043e\u0432\u0430\u044f \u043f\u0430\u043b\u0438\u0442\u0440\u0430:",oneLine:!0,values:[{name:"yellow",descr:"\u0417\u043e\u043b\u043e\u0442\u0430\u044f"},{name:"lightgray",descr:"\u0421\u0435\u0440\u0430\u044f"},{name:"dark",descr:"\u0422\u0435\u043c\u043d\u0430\u044f"}]},topicsPerPage:{type:"number",label:"\u0422\u0435\u043c \u043d\u0430 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0435 (max 99):",min:1,max:99},autoRefreshTopicsList:{type:"checkbox",label:"\u0410\u0432\u0442\u043e\u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u0441\u043f\u0438\u0441\u043a\u0430 \u0442\u0435\u043c"},autoRefreshTopicsListInterval:{type:"number",label:"",min:60,max:1e6,postfix:"\u0441\u0435\u043a"},autoRefreshTopic:{type:"checkbox",label:"\u0410\u0432\u0442\u043e\u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u0442\u0435\u043c\u044b"},autoRefreshTopicInterval:{type:"number",label:"",min:60,max:1e6,postfix:"\u0441\u0435\u043a"},showTooltips:{type:"checkbox",label:"\u041f\u043e\u043a\u0430\u0437\u044b\u0432\u0430\u0442\u044c \u0442\u0443\u043b\u0442\u0438\u043f\u044b, \u0437\u0430\u0434\u0435\u0440\u0436\u043a\u0430",disabled:!0},tooltipDelay:{type:"number",max:1e6,label:"",postfix:"\u043c\u0441",disabled:!0},showTooltipOnPostLink:{type:"checkbox",label:"\u041f\u043e\u043a\u0430\u0437\u044b\u0432\u0430\u0442\u044c \u0442\u0443\u043b\u0442\u0438\u043f \u0441\u0441\u044b\u043a\u0438 \u043d\u0430 \u0434\u0440\u0443\u0433\u0443\u044e \u0432\u0435\u0442\u043a\u0443",disabled:!0},showYoutubeVideoTitle:{type:"checkbox",label:"\u041f\u043e\u043a\u0430\u0437\u044b\u0432\u0430\u0442\u044c \u043d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u044f \u0440\u043e\u043b\u0438\u043a\u043e\u0432 youtube"},replaceCatalogMista:{type:"checkbox",label:"\u041e\u0431\u0440\u0430\u0442\u043d\u043e \u0437\u0430\u043c\u0435\u043d\u044f\u0442\u044c catalog.mista.ru \u043d\u0430 infostart.ru"},fixBrokenLinks:{type:"checkbox",label:"\u0427\u0438\u043d\u0438\u0442\u044c \u043f\u043e\u043b\u043e\u043c\u0430\u043d\u043d\u044b\u0435 \u0441\u0441\u044b\u043b\u043a\u0438 (\u0441 \u0440\u0443\u0441\u0441\u043a\u0438\u043c\u0438 \u0441\u0438\u043c\u0432\u043e\u043b\u0430\u043c\u0438)"}},ds=e=>{let{name:t,children:s}=e;return(0,v.jsxs)("div",{children:[(0,v.jsx)("div",{className:"tab-header",children:t}),(0,v.jsx)("div",{className:"tab-content",children:s})]})},us=()=>{const e=ee(),t=(0,h.s0)(),s=te((e=>e.options)),[a,n]=(0,o.useState)({items:s.items}),r=()=>{t("/#")},i=(e,t,s)=>{let r=Object.assign({},a.items);r[t]=s,n((0,y.Z)((0,y.Z)({},a),{},{items:r}))};let l=[];for(let o of ls){let e=[];for(let t in o.rows){const s=o.rows[t];let n=[];for(let e of s){const t=cs[e];if(!t)continue;const s=a.items[e];"radio"===t.type?n.push((0,v.jsx)(is,{name:e,label:t.label,values:t.values,value:s,oneLine:t.oneLine,onChange:i},e)):"number"===t.type?(t.label&&n.push((0,v.jsx)("label",{htmlFor:e,style:{fontWeight:"inherit"},children:t.label},e+"_label")),n.push((0,v.jsxs)("div",{className:"options-number",children:[(0,v.jsx)(m.Z,{type:"number",min:t.min,max:t.max,value:s,disabled:t.disabled,onChange:t=>i(0,e,t.target.value),className:"input",size:"sm"}),t.postfix&&(0,v.jsx)("span",{style:{marginLeft:"5px",flex:"0 0 auto"},children:t.postfix},e+"_postfix")]},e))):"string"===t.type?n.push((0,v.jsx)(os,{name:e,label:t.label,postfix:t.postfix,value:s,onChange:i},e)):"checkbox"===t.type&&n.push((0,v.jsx)(u.Z.Check,{id:e,type:"checkbox",label:t.label,name:e,checked:"true"===String(s),disabled:t.disabled,onChange:t=>i(0,e,String(t.target.checked)),style:{flex:"0 0 auto",margin:"0px",maxWidth:"100%"}},e))}e.push((0,v.jsx)("div",{className:"options-row",children:n},t))}l.push((0,v.jsx)(ds,{name:o.tabName,children:e},o.tabName))}return(0,v.jsxs)("div",{className:"options-form",children:[(0,v.jsx)("div",{className:"options-header",style:{cursor:"default"},children:(0,v.jsx)("b",{children:"\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438"})}),l,(0,v.jsxs)("div",{className:"button-row",children:[(0,v.jsx)(Je.Z,{id:"applyOptions",size:"sm",variant:"light",style:{margin:"5px"},className:"button",onClick:()=>{e(ve.save(a.items)),r()},children:"OK"}),(0,v.jsx)(Je.Z,{id:"cancelOptions",size:"sm",variant:"light",style:{margin:"5px",float:"left"},className:"button",onClick:r,children:"\u041e\u0442\u043c\u0435\u043d\u0430"}),(0,v.jsx)(Je.Z,{id:"defaultOptions",size:"sm",variant:"light",style:{margin:"5px",float:"right"},className:"button",onClick:()=>{n((0,y.Z)((0,y.Z)({},a),{},{items:Object.assign({},ge.items)}))},children:"\u0421\u0431\u0440\u043e\u0441\u0438\u0442\u044c \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438"})]})]})},hs=()=>(0,v.jsx)(Ae.Z,{children:(0,v.jsxs)(h.Z5,{children:[(0,v.jsx)(h.AW,{path:"/",element:(0,v.jsx)($t,{})}),(0,v.jsx)(h.AW,{path:"/index.php",element:(0,v.jsx)($t,{})}),(0,v.jsx)(h.AW,{path:"/topic.php",element:(0,v.jsx)(rs,{})}),(0,v.jsx)(h.AW,{path:"/options.php",element:(0,v.jsx)(us,{})})]})}),ps=()=>(0,v.jsxs)("footer",{className:"flex-row navbar-footer",children:[(0,v.jsx)("a",{href:"".concat(W,"/rules.php"),children:"\u041f\u0440\u0430\u0432\u0438\u043b\u0430"}),(0,v.jsx)("span",{className:"separator",children:"|"}),(0,v.jsx)("a",{href:"".concat(W,"/about.php"),children:"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435"}),(0,v.jsx)("span",{className:"separator",children:"|"}),(0,v.jsxs)("b",{children:[(0,v.jsx)("a",{href:"".concat(W,"/ad.php"),children:"\u0420\u0435\u043a\u043b\u0430\u043c\u0430 \u043d\u0430 \u0441\u0430\u0439\u0442\u0435"})," "]}),(0,v.jsx)("span",{className:"separator",children:"|"}),(0,v.jsx)("a",{href:"".concat(W,"/find.php"),children:"\u041f\u043e\u0438\u0441\u043a"}),(0,v.jsx)("span",{className:"separator",children:"|"}),(0,v.jsx)("a",{rel:"nofollow",href:"".concat(W,"/sections_list.php"),children:"\u0421\u0435\u043a\u0446\u0438\u0438"}),(0,v.jsx)("span",{className:"separator",children:"|"}),(0,v.jsx)("a",{rel:"nofollow",href:"".concat(W,"/rating.php"),children:"\u0420\u0435\u0439\u0442\u0438\u043d\u0433"}),(0,v.jsx)("span",{className:"separator",children:"|"}),(0,v.jsx)("a",{href:"http://kb.mista.ru",children:"\u041a\u043d\u0438\u0433\u0430 \u0437\u043d\u0430\u043d\u0438\u0439"}),(0,v.jsx)("span",{className:"separator",children:"|"}),(0,v.jsx)("a",{href:"http://wiki.mista.ru",children:"\u0412\u0438\u043a\u0438-\u043c\u0438\u0441\u0442\u0430 (\u041a\u04172)"}),(0,v.jsx)("span",{className:"separator",children:"|"}),(0,v.jsx)("a",{rel:"nofollow",href:"http://m.mista.ru/",children:"\u041c\u043e\u0431\u0438\u043b\u044c\u043d\u0430\u044f"}),(0,v.jsx)("span",{className:"separator",children:"|"}),(0,v.jsx)("a",{href:"".concat(W,"/archive.php"),children:"\u0410\u0440\u0445\u0438\u0432"}),(0,v.jsx)("span",{className:"separator",children:"|"}),(0,v.jsx)("a",{href:"".concat(W,"/moders.php"),children:"\u041c\u043e\u0434\u0435\u0440\u0430\u0442\u043e\u0440\u044b"}),(0,v.jsx)("span",{className:"separator",children:"|"}),(0,v.jsx)("a",{href:"".concat(W,"/users_gallery.php"),children:"\u0413\u0430\u043b\u0435\u0440\u0435\u044f"}),(0,v.jsx)("span",{className:"separator",children:"|"}),(0,v.jsx)("a",{href:"".concat(W,"/ban_list.php"),children:"\u0411\u0430\u043d\u044b"}),(0,v.jsx)("span",{className:"separator",children:"|"}),(0,v.jsx)("span",{children:"18+"})]});var ms=s(9962),xs=s.n(ms);const gs=e=>{let{children:t,closeWindow:s}=e;return(0,v.jsxs)("div",{className:"tooltip-header",children:[t,(0,v.jsxs)("div",{className:"tooltip-close",onClick:s,onTouchEnd:s,children:[(0,v.jsx)("i",{className:"fa fa-angle-right","aria-hidden":"true"}),(0,v.jsx)("i",{className:"fa fa-angle-left","aria-hidden":"true",style:{marginLeft:"-2px"}})]})]})},fs=e=>{let{children:t,onScroll:s}=e,a=0;return(0,v.jsx)("div",{className:"tooltip-text",onTouchStart:e=>{a=e.nativeEvent.changedTouches[0].clientX},onTouchEnd:e=>{if(!s)return;let t=e.nativeEvent.changedTouches[0].clientX;Math.abs(t-a)>100&&s(-t+a)},children:t})},vs=e=>{let{tooltip:t,zIndex:s,children:a}=e;const n=se(be),{coords:r}=t;let i,l;window.innerWidth<=768?(i="y",l={top:r.y,left:5}):(i="both",l={top:r.y,left:Math.min(r.x,window.innerWidth-670)});let[c,d]=o.Children.toArray(a);return(0,v.jsx)(xs(),{axis:i,handle:".tooltip-header",defaultClassNameDragging:"dragging",children:(0,v.jsxs)("div",{className:"tooltip-window",style:(0,y.Z)({},l),children:[(0,v.jsx)(gs,{closeWindow:()=>{n.close(t.keys)},children:c.props.children}),(0,v.jsx)(fs,{children:d.props.children})]})},s)},js=e=>{var t,s,a;const{info:n,items:r,item0:i}=te((e=>e.topic)),{tooltip:l}=e,{keys:c}=l;let d,u="";c.topicId===n.id&&(d=0===c.number?i:r.find((e=>e.n===c.number)),d&&(u=d.text));const[h,p]=(0,o.useState)({data:d,text:u});if((0,o.useEffect)((()=>{(async()=>{if(h.data)return;let e,t="";try{e=await V(c.topicId,c.number),t=e?e.text:"\u0421\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e ".concat(c.number)}catch(s){t=s.message}p({data:e,text:t})})()}),[c.topicId,c.number,h.data]),!h.text)return null;let m;return m=h.data?(0,v.jsx)(At,{data:h.data,isAuthor:!1,isYou:!1,isTooltip:!0}):(0,v.jsx)("b",{children:"\u0417\u0430\u0433\u043e\u043b\u043e\u0432\u043e\u043a"}),(0,v.jsxs)(vs,{tooltip:e.tooltip,children:[(0,v.jsx)(gs,{children:m}),(0,v.jsx)(fs,{children:(0,v.jsx)(Vt,{n:null===(t=h.data)||void 0===t?void 0:t.n,vote:null===(s=h.data)||void 0===s?void 0:s.vote,html:h.text,topicId:c.topicId,topicDate:null===(a=h.data)||void 0===a?void 0:a.time,style:{maxHeight:"min(550px, 80vh)",overflowY:"auto"}})})]})},ys=()=>{const e=te((e=>e.tooltips.items)),t=se(be),s=(0,o.useRef)(null);return(0,f.t$)(s,(()=>{t.closeAll()})),(0,v.jsx)("div",{ref:s,children:e.map((e=>(0,v.jsx)(js,{tooltip:e},e.hash)))})},bs=()=>{const e=te((e=>e.options.items.theme));return(0,o.useLayoutEffect)((()=>{document.body.setAttribute("data-theme",e)}),[e]),(0,v.jsxs)(l.UT,{children:[(0,v.jsx)(Ve,{}),(0,v.jsx)(hs,{}),(0,v.jsx)(ps,{}),(0,v.jsx)(ys,{})]})};var Ns=s(6994);const ws=new r.S,ks=e=>{let{store:t}=e;return(0,v.jsx)(i.aH,{client:ws,children:(0,v.jsx)(n.zt,{store:t,children:(0,v.jsx)(Ns.r,{loading:null,persistor:Be,children:(0,v.jsx)(bs,{})})})})},Is=document.getElementById("root");(0,a.s)(Is).render((0,v.jsx)(ks,{store:He}))}},t={};function s(a){var n=t[a];if(void 0!==n)return n.exports;var r=t[a]={exports:{}};return e[a].call(r.exports,r,r.exports,s),r.exports}s.m=e,(()=>{var e=[];s.O=(t,a,n,r)=>{if(!a){var i=1/0;for(d=0;d<e.length;d++){a=e[d][0],n=e[d][1],r=e[d][2];for(var o=!0,l=0;l<a.length;l++)(!1&r||i>=r)&&Object.keys(s.O).every((e=>s.O[e](a[l])))?a.splice(l--,1):(o=!1,r<i&&(i=r));if(o){e.splice(d--,1);var c=n();void 0!==c&&(t=c)}}return t}r=r||0;for(var d=e.length;d>0&&e[d-1][2]>r;d--)e[d]=e[d-1];e[d]=[a,n,r]}})(),s.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return s.d(t,{a:t}),t},(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;s.t=function(a,n){if(1&n&&(a=this(a)),8&n)return a;if("object"===typeof a&&a){if(4&n&&a.__esModule)return a;if(16&n&&"function"===typeof a.then)return a}var r=Object.create(null);s.r(r);var i={};e=e||[null,t({}),t([]),t(t)];for(var o=2&n&&a;"object"==typeof o&&!~e.indexOf(o);o=t(o))Object.getOwnPropertyNames(o).forEach((e=>i[e]=()=>a[e]));return i.default=()=>a,s.d(r,i),r}})(),s.d=(e,t)=>{for(var a in t)s.o(t,a)&&!s.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),s.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e={179:0};s.O.j=t=>0===e[t];var t=(t,a)=>{var n,r,i=a[0],o=a[1],l=a[2],c=0;if(i.some((t=>0!==e[t]))){for(n in o)s.o(o,n)&&(s.m[n]=o[n]);if(l)var d=l(s)}for(t&&t(a);c<i.length;c++)r=i[c],s.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return s.O(d)},a=self.webpackChunkreact_mista=self.webpackChunkreact_mista||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))})();var a=s.O(void 0,[216],(()=>s(2575)));a=s.O(a)})();
//# sourceMappingURL=main.2b6ae9db.js.map